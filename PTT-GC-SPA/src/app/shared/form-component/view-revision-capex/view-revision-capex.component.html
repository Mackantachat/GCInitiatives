<div class="row">
    <div class="col-md-12">
        <div class="card text card-initiative">
            <div class="card-body">
                <div class="initiative-form" *ngIf="id">
                    <app-initiative-info [id]="id"></app-initiative-info>
                </div>
                <!-- <form *ngIf="Initiative_tmp" [formGroup]="capexInformationForm"> -->
                <div [formGroup]="capexInformationForm">
                    <div class="row mt-5">
                        <div class="col-md-12">
                            <div class="row">
                                <h4 class="col-md-10">Initiative Details</h4>
                                <div class="col-md-2" *ngIf="IsShowRevisionButton">
                                    <button data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"
                                        class="btn btn-primary ">
                                        Revision
                                    </button>
                                    <div class="dropdown-menu mt-3" aria-labelledby="addmore">
                                        <ul class="p-0" *ngFor="let controls of capexInformationList; let i=index">
                                            <li class="dropdown-item list" value="controls"
                                                (click)="Revision(controls)">
                                                Revision No.{{i}}
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <hr />
                        </div>
                        <!-- <div class="col-md-6" [ngClass]="ps.chps('CapexInformation','startingDate')">
                <label for="StartingDate">
                  Starting Date <span class="text-danger">*</span> :
                </label>
                <div class="input-group">
                  <input formControlName="startingDate" (bsValueChange)="setStartingDate($event)" type="text"
                    class="form-control" [bsConfig]="bsConfigStart" bsDatepicker #dpStart="bsDatepicker"
                    [ngClass]="{ 'is-invalid': invalidStartingDate }" [readonly]="IsAddmore" [isDisabled]="IsAddmore" />
                  <div class="input-group-append">
                    <i class="far fa-calendar right-icon mt-2" (click)="dpStart.toggle()"
                      [attr.aria-expanded]="dpStart.isOpen"></i>
                  </div>
                  <div class="invalid-feedback" *ngIf="invalidStartingDate">
                    Starting Date is required !
                  </div>
                </div>
              </div> -->
                        <!-- Change chps to checkNotControl or checkControl -->
                        <div class="col-md-6"
                            [ngClass]="ps.checkControl(capexInformationForm,'CapexInformation','requestIniNoDate')">
                            <label for="RequestIniNoDate">
                                Request Project No. Date (Budget Start Date)
                                <span class="text-danger">*</span> :
                            </label>

                            <div class="input-group">
                                <input formControlName="requestIniNoDate" (bsValueChange)="setRequestDate($event)"
                                    type="text" class="form-control" [bsConfig]="bsConBetween" bsDatepicker
                                    #dpBudget="bsDatepicker" [ngClass]="{ 'is-invalid': invalidRequestIniNoDate }"
                                    [triggers]="viewMode ? '' : 'click:click'" />
                                <div *ngIf="!viewMode" class="input-group-append">
                                    <i class="far fa-calendar right-icon mt-2" (click)="dpBudget.toggle()"
                                        [attr.aria-expanded]="dpBudget.isOpen"></i>
                                </div>
                                <div class="invalid-feedback" *ngIf="invalidRequestIniNoDate">
                                    Request Project No. Date (Budget Start Date) is required !
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6"
                            [ngClass]="ps.checkControl(capexInformationForm,'CapexInformation','projecctComRun')">
                            <label for="ProjecctComRun">
                                Finish Date <span class="text-danger">*</span> :
                            </label>
                            <div class="input-group">
                                <input formControlName="projecctComRun" (bsValueChange)="setFinishDate($event)"
                                    type="text" class="form-control" [bsConfig]="bsConfigFinish" bsDatepicker
                                    #dpFinish="bsDatepicker" [ngClass]="{ 'is-invalid': invalidFinishingDate }"
                                    [triggers]="viewMode ? '' : 'click:click'" />
                                <div *ngIf="!viewMode" class="input-group-append">
                                    <i class="far fa-calendar right-icon mt-2" (click)="dpFinish.toggle()"
                                        [attr.aria-expanded]="dpFinish.isOpen"></i>
                                </div>
                                <div class="invalid-feedback" *ngIf="invalidFinishingDate">
                                    Finish Date is required !
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row mt-3">
                        <div class="col-md-6">
                            <label for="finishDate">
                                Project Execution Period <span class="text-danger">*</span> :
                            </label>
                            <div class="row">
                                <div class="col-md-3">
                                    <input type="text" class="form-control" value="projectExePeriodYear"
                                        formControlName="projectExePeriodYear" readonly />
                                </div>
                                <div class="col-md-3 p-2">
                                    <span>Year</span>
                                </div>
                                <div class="col-md-3">
                                    <input type="text" class="form-control" value="projectExePeriodMonth"
                                        formControlName="projectExePeriodMonth" readonly />
                                </div>
                                <div class="col-md-3 p-2">
                                    <span>Month</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- *ngIf="stage_Max === 'IL3' && is_RequestCapex && is_Max; else isNotIL3andNotRequestCapex" -->
                    <ng-container>
                        <div class="row mt-3">
                            <div class="col-md-6"
                                [ngClass]="ps.checkControl(capexInformationForm,'CapexInformation','costCenterOfVP')">
                                <label for="costCenterOfVP">
                                    Cost Center of VP (Asset Owner)
                                    <span class="text-danger">*</span> :
                                </label>
                                <ng-select formControlName="costCenterOfVP" [items]="owners" bindValue="ownerName"
                                    bindLabel="ownerName" placeholder="Choose Owner" (search)="SearchOwnerName($event)"
                                    (clear)="ClearOwnerName()" (change)="GetOwnersVP($event)"
                                    [ngClass]="{ 'is-invalid': invalidOrganization }">
                                </ng-select>
                            </div>
                            <div class="col-md-6"
                                [ngClass]="ps.checkControl(capexInformationForm,'CapexInformation','codeCostCenterOfVP')">
                                <label for="codeCostCenterOfVP">
                                    Code Of Cost Center of VP (Asset Owner)
                                    <span class="text-danger">*</span> :
                                </label>
                                <input formControlName="codeCostCenterOfVP" type="text" name="codeCostCenterOfVP"
                                    class="form-control" placeholder=""
                                    [ngClass]="{ 'is-invalid': invalidCodeCostCenterOfVP }" readonly />
                                <div class="invalid-feedback" *ngIf="invalidCodeCostCenterOfVP">
                                    Code Of Cost Center of VP is not found !
                                </div>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-md-6" *ngIf="is_Max">
                                <div [ngClass]="ps.checkControl(capexInformationForm,'CapexInformation','manager')">

                                    <label for="manager"> Division Manager of Owner (DM) <span
                                            class="text-danger">*</span>
                                    </label>
                                    <div [ngClass]="{'edit-general' : stage === 'IL5'}">
                                        <ng-select formControlName="manager" [items]="managerList" bindValue="ownerName"
                                            bindLabel="ownerName" placeholder="Choose Division Manager of Owner (DM)"
                                            required (search)="SearchManager($event)" (clear)="ClearGetManager()"
                                            (change)="changeManager($event)">
                                        </ng-select>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6" *ngIf="is_Max">
                                <div
                                    [ngClass]="ps.checkControl(capexInformationForm,'CapexInformation','projectManager')">
                                    <label for="projectManager"> Project Manager <span class="text-danger">*</span>
                                    </label>
                                    <ng-select formControlName="projectManager" [items]="projectManagerList"
                                        bindValue="ownerName" bindLabel="ownerName" placeholder="Choose Project Manager"
                                        required (search)="SearchProjectManager($event)" (clear)="ClearProjectManager()"
                                        (change)="changeProjectManager($event)">
                                    </ng-select>
                                </div>
                            </div>
                        </div>
                    </ng-container>
                    <ng-template #isNotIL3andNotRequestCapex>
                        <div class="row mt-3">
                            <div class="col-md-6"
                                [ngClass]="ps.checkControl(capexInformationForm,'CapexInformation','costCenterOfVP')">
                                <label for="costCenterOfVP">
                                    Cost Center of VP (Asset Owner) :
                                </label>
                                <input formControlName="costCenterOfVP" type="text" readonly class="form-control" />
                            </div>
                            <div class="col-md-6"
                                [ngClass]="ps.checkControl(capexInformationForm,'CapexInformation','codeCostCenterOfVP')">
                                <label for="codeCostCenterOfVP">
                                    Code Of Cost Center of VP (Asset Owner) :
                                </label>
                                <input formControlName="codeCostCenterOfVP" type="text" class="form-control" readonly />
                            </div>
                        </div>
                    </ng-template>

                    <div class="row mt-3" *ngIf="!IsAddmore && !IsReturn">
                        <div class="col-md-6"
                            [ngClass]="ps.checkControl(capexInformationForm,'CapexInformation','projectCost')">
                            <label for="projectCost">
                                Project Cost (MTHB) <span class="text-danger">*</span> :
                            </label>
                            <input formControlName="projectCost" #projectCost_tmp
                                (blur)="setProjectCost(projectCost_tmp.value)" type="text" name="projectCost"
                                class="form-control" step="0.01" placeholder="0.00" mask="separator.2"
                                thousandSeparator="," [ngClass]="{ 'is-invalid': invalidCostEstCapex }"
                                [readonly]="IsAddmore" />
                            <div class="invalid-feedback" *ngIf="invalidCostEstCapex">
                                Project Cost (MTHB) is required !
                            </div>
                        </div>
                    </div>

                    <div class="row mt-3"
                        [ngClass]="ps.checkControl(capexInformationForm,'CapexInformation','reasonOfChanging')">
                        <div class="col-md-12" *ngIf="(RemarkShow == true) || (IsAddmore || IsReturn)">
                            <label for="reasonOfChanging">
                                Reason of changing Project Cost
                                <span class="text-danger">*</span>
                                :
                            </label>
                            <textarea class="form-control" id="reasonOfChanging" rows="2" name="reasonOfChanging"
                                formControlName="reasonOfChanging"
                                [ngClass]="{ 'is-invalid': invalidReasonOfchanging }"></textarea>
                            <div class="text-feedback" *ngIf="invalidReasonOfchanging">
                                Reason of changing Project Cost is required !
                            </div>
                        </div>
                    </div>

                    <div class="row mt-3" *ngIf="!IsReturn">
                        <div class="col-md-2">
                            <label for="budgetPeriod">
                                Budget Period <span class="text-danger">*</span> :
                            </label>
                        </div>
                        <div class="col-md-10"
                            [ngClass]="ps.checkControl(capexInformationForm,'CapexInformation','budgetPeriod')">
                            <div class="custom-control custom-radio custom-control-inline"
                                [ngClass]="{'disabled-check-main' :  true } ">
                                <input id="annual" value="Annual" class="custom-control-input" type="radio"
                                    name="budgetPeriod" formControlName="budgetPeriod"
                                    (change)="OnChangeRequestOPEX($event.target.value)"
                                    [ngClass]="{ 'is-invalid': invalidBudget }" />
                                <label class="custom-control-label" for="annual">
                                    Annual ({{ year_next }})
                                </label>
                            </div>
                        </div>
                        <div class="col-md-2"></div>
                        <div class="col-md-10 mt-1"
                            [ngClass]="ps.checkControl(capexInformationForm,'CapexInformation','budgetPeriod')">
                            <div class="custom-control custom-radio custom-control-inline">
                                <input id="midYear" value="Mid Year" class="custom-control-input" type="radio"
                                    name="budgetPeriod" formControlName="budgetPeriod"
                                    (change)="OnChangeRequestOPEX($event.target.value)"
                                    [ngClass]="{ 'is-invalid': invalidBudget }" />
                                <label class="custom-control-label" for="midYear">
                                    Mid Year ({{ year_now }})
                                </label>
                            </div>
                        </div>
                        <div class="col-md-2"></div>
                        <div class="col-md-10 mt-1"
                            [ngClass]="ps.checkControl(capexInformationForm,'CapexInformation','budgetPeriod')">
                            <div class="custom-control custom-radio custom-control-inline">
                                <input id="between" value="Current year" class="custom-control-input" type="radio"
                                    name="budgetPeriod" formControlName="budgetPeriod"
                                    (change)="OnChangeRequestOPEX($event.target.value)"
                                    [ngClass]="{ 'is-invalid': invalidBudget }" [attr.disabled]="IsCreatePool" />
                                <label class="custom-control-label" for="between">
                                    Current year
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="row mt-3 sub-Between" *ngIf="showContingency">
                        <div [ngClass]="ps.checkControl(capexInformationForm,'CapexInformation','betweenYear')">
                            <div class="col-md-12">
                                <div class="custom-control custom-radio custom-control-inline">
                                    <input id="contingency" value="Contingency" class="custom-control-input"
                                        type="radio" name="betweenYear" formControlName="betweenYear"
                                        (change)="OnChangeBetweenYear($event.target.value)"
                                        [ngClass]="{ 'is-invalid': invalidBudget }" />
                                    <label class="custom-control-label" for="contingency">
                                        Contingency ({{ year_now }})
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-12 mt-2">
                                <div class="custom-control custom-radio custom-control-inline">
                                    <input id="transfer" value="Transfer" class="custom-control-input" type="radio"
                                        name="betweenYear" formControlName="betweenYear"
                                        (change)="OnChangeBetweenYear($event.target.value)"
                                        [ngClass]="{ 'is-invalid': invalidBudget }" />
                                    <label class="custom-control-label" for="transfer">
                                        Transfer ({{ year_now }})
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-12 mt-2" *ngIf="inshow">
                                <div
                                    [ngClass]="ps.checkControl(capexInformationForm,'CapexInformation','transferForm')">
                                    <label for="transferForm">
                                        Transfer Form <span class="text-danger">*</span> :
                                    </label>
                                    <div class="input-group" id="Form" style="width: 50%;">
                                        <select formControlName="transferForm" name="transferForm" value="transferForm"
                                            class="form-control" (change)="transfer($event.target.value)">
                                            <option value="" selected disabled> Choose...</option>
                                            <option value="OPEX">OPEX</option>
                                            <option value="RMA">RMA</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12 mt-2">
                                <div class="custom-control custom-radio custom-control-inline">
                                    <input id="pool" value="Pool Budget" class="custom-control-input" type="radio"
                                        name="betweenYear" formControlName="betweenYear"
                                        (change)="OnChangeBetweenYear($event.target.value)" />
                                    <label class="custom-control-label" for="pool">
                                        Pool Budget ({{ year_now }})
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row mt-2 sub-Transfer" *ngIf="ferPool">
                        <div class="col-md-5 mt-2"
                            [ngClass]="ps.checkControl(capexInformationForm,'CapexInformation','poolBudgetForm')">
                            <label for="poolBudgetForm">
                                Pool Budget From <span class="text-danger">*</span> :
                            </label>
                            <!-- <div class="input-group" id="Form" style="width: 50%;"> -->
                            <select class="form-control" formControlName="poolBudgetForm" name="poolBudgetForm"
                                value="poolBudgetForm" (change)="GetAvailablePoolLIst($event.target.value)">
                                <option value="" selected readOnly> Choose...</option>
                                <option value="Digital CAPEX">Digital CAPEX</option>
                                <option value="IT CAPEX">IT CAPEX</option>
                                <option value="PIM">PIM</option>
                                <option value="MAX">MAX</option>
                                <option value="ER">ER</option>
                                <option value="MTPi">MTPi</option>
                            </select>
                            <!-- </div> -->
                        </div>
                        <div class="col-md-5 mt-2"></div>

                        <div class="col-md-2 mt-2"></div>
                        <div class="col-md-5 mt-2"
                            [ngClass]="ps.checkControl(capexInformationForm,'CapexInformation','poolYear')">
                            <label for="poolYear"> Pool Year </label>
                            <div class="input-group">
                                <!-- <input type="text" class="form-control" readonly="true" formControlName="poolYear" [(ngModel)]="PoolYear" /> -->
                                <input type="text" class="form-control" readonly="true" formControlName="poolYear" />
                            </div>
                        </div>
                        <div class="col-md-5 mt-2"
                            [ngClass]="ps.checkControl(capexInformationForm,'CapexInformation','poolID')">
                            <label for="poolID">
                                Pool ID<span class="text-danger">*</span> :
                            </label>
                            <!-- <ng-select formControlName="poolID" [items]="PoolID_list" bindValue="id"
                                      bindLabel="name" placeholder="Choose PoolID" [(ngModel)]="pool_id"
                                      (change)="getPoolAva($event)">
                                  </ng-select> -->
                            <ng-select formControlName="poolID" [items]="PoolID_list" bindValue="id" bindLabel="name"
                                placeholder="Choose PoolID" (change)="getPoolAva($event)">
                            </ng-select>
                        </div>
                        <div class="col-md-2 mt-2"></div>
                        <div class="col-md-5 mt-2"
                            [ngClass]="ps.checkControl(capexInformationForm,'CapexInformation','availableBudget')">
                            <label for="availableBudget">
                                Available Budget (MTHB)<span class="text-danger">*</span> :
                            </label>
                            <input formControlName="availableBudget" type="text" name="" class="form-control"
                                placeholder="" readonly="true" />
                        </div>
                    </div>

                    <!-- Start Table -->
                    <!---->
                    <ng-container *ngIf="RequestIniNoDate != null && ProjecctComRun != null">

                        <div class="row mt-5">
                            <div class="col-md-12">
                                <h4>Annual Investment Plan</h4>
                                <hr />
                            </div>
                        </div>

                        <!-- start addmore && return -->
                        <div class="row" *ngIf="IsAddmore || IsReturn">
                            <div class="col-md-6"
                                [ngClass]="ps.checkControl(capexInformationForm,'CapexInformation','existingCost')">
                                <label for="ExistingCost">
                                    Existing Budget (MTHB)<span class="text-danger">*</span> :
                                </label>
                                <input formControlName="existingCost" type="text" name="ExistingCost"
                                    class="form-control" placeholder="" step="0.01" placeholder="0.00"
                                    mask="separator.2" thousandSeparator="," readonly />
                            </div>
                            <div class="col-md-6"
                                [ngClass]="ps.checkControl(capexInformationForm,'CapexInformation','spendingActual')">
                                <label for="SpendingActual">
                                    Spending Actual (MTHB) <span class="text-danger">*</span> :
                                </label>
                                <input formControlName="spendingActual" type="text" name="SpendingActual"
                                    class="form-control" placeholder="" step="0.01" placeholder="0.00"
                                    mask="separator.2" thousandSeparator="," #SpendingActual
                                    (blur)="setSpendingActual(SpendingActual.value)" readonly />
                            </div>
                            <div class="col-md-6"
                                [ngClass]="ps.checkControl(capexInformationForm,'CapexInformation','BudgetAvailable')">
                                <label for="finishDate">
                                    Budget Available (MTHB) <span class="text-danger">*</span> :
                                </label>
                                <input formControlName="budgetAvailable" #BudgetAvailable type="text"
                                    name="BudgetAvailable" class="form-control" placeholder="" step="0.01"
                                    placeholder="0.00" mask="separator.2" thousandSeparator=","
                                    [ngClass]="{ 'is-invalid': invalidCostEstCapex }" readonly />

                                <div class="invalid-feedback" *ngIf="invalidCostEstCapex">
                                    Budget Available (MTHB) is required !
                                </div>
                            </div>
                            <div class="col-md-6" *ngIf="IsAddmore">
                                <div
                                    [ngClass]="ps.checkControl(capexInformationForm,'CapexInformation','additionalCost')">
                                    <label for="finishDate">
                                        Additional (MTHB) <span class="text-danger">*</span> :
                                    </label>
                                    <input formControlName="additionalCost" type="text" name="AdditionalCost"
                                        class="form-control" placeholder="" step="0.01" placeholder="0.00"
                                        mask="separator.2" thousandSeparator="," #AdditionalCost_tmp
                                        (blur)="setadditionalCost()" />
                                    <div class="invalid-feedback" *ngIf="invalidAdditionalCost">
                                        Additional (MTHB) is required !
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6" *ngIf="IsReturn">
                                <div [ngClass]="ps.checkControl(capexInformationForm,'CapexInformation','returnCost')">
                                    <label for="finishDate">
                                        Return (MTHB) <span class="text-danger">*</span> :
                                    </label>
                                    <input formControlName="returnCost" type="text" name="ReturnCost"
                                        class="form-control" placeholder="" step="0.01" placeholder="0.00"
                                        mask="separator.2" thousandSeparator="," #ReturnCost_temp
                                        (blur)="setreturnCost()" [(ngModel)]="returnCost"
                                        [ngClass]="{ 'is-invalid': invalidReturnCost }" />
                                    <div class="invalid-feedback" *ngIf="invalidReturnCost">
                                        Return (MTHB) is required !
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row mt-3 w-100" *ngIf="IsAddmore || IsReturn">
                            <div class="col-md-3"
                                [ngClass]="ps.checkControl(capexInformationForm,'CapexInformation','ProjectCost')">
                                <label for="ExistingCost">
                                    Project Cost (MTHB) <span class="text-danger">*</span> :
                                </label>
                                <input formControlName="projectCost" type="text" name="ProjectCost" class="form-control"
                                    placeholder="" step="0.01" placeholder="0.00" mask="separator.2"
                                    thousandSeparator="," readonly />
                            </div>
                            <div class="col-md-3"
                                [ngClass]="ps.checkControl(capexInformationForm,'CapexInformation','totalAvailable')">
                                <label for="ExistingCost">
                                    Total Available (MTHB) <span class="text-danger">*</span> :
                                </label>
                                <input formControlName="totalAvailable" type="text" name="TotalAvailable"
                                    class="form-control" placeholder="" step="0.01" placeholder="0.00"
                                    mask="separator.2" thousandSeparator="," readonly />
                            </div>

                        </div>
                        <!-- end addmore && return -->
                        <!-- <div *ngIf="AnnualForm && (!IsReturn || IsRequestPool)" [formGroup]="getAnnualForm('AnnualForm')"> -->
                        <div *ngIf="AnnualForm" [formGroup]="getAnnualForm('AnnualForm')">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="card text card-initiative">
                                        <div class="form-initiative">
                                            <div class="w-100">
                                                <div class="table-responsive">
                                                    <table class="table table-bordered">
                                                        <thead class="text-center bg-light">
                                                            <tr>
                                                                <th width="200px">Investment Plan</th>
                                                                <th width="100px">Overall</th>
                                                                <th width="100px"
                                                                    *ngFor="let column of YearTable_capex;let i = index">
                                                                    {{ column.columnname }}
                                                                </th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr formArrayName="annualForm_list"
                                                                *ngFor="let cd of annualForm_.controls;let i = index">
                                                                <td class="text-center" [formGroupName]="i">

                                                                    <!-- <select class="form-control" *ngIf="i == 0" formControlName="currencyTitle"
                                      (change)="changeRate($event.target.value, i)" disabled="flagFirst_row">
                                      <option *ngFor="let t of currencyList" [value]="t.currencyName">
                                        {{ t.currencyName }}
                                      </option>
                                    </select> -->
                                                                    <ng-container *ngIf="i == 0; else imoreZero">
                                                                        <input formControlName="currencyTitle"
                                                                            class="form-control" type="text" readonly />
                                                                    </ng-container>
                                                                    <ng-template #imoreZero>
                                                                        <select class="form-control"
                                                                            formControlName="currencyTitle"
                                                                            (change)="changeRate($event.target.value, i)">
                                                                            <option *ngFor="let t of currencyList"
                                                                                [value]="t.currencyMillionName"
                                                                                (change)="duplicates($event.target.value)">
                                                                                {{ t.currencyMillionName }}
                                                                            </option>
                                                                        </select>
                                                                        <!-- <label class="mt-3" for="finishDate" *ngIf="i != 0"> -->
                                                                        <label class="mt-3" for="finishDate">
                                                                            FX
                                                                        </label>

                                                                        <input formControlName="currencyFx"
                                                                            (change)="ChangingValue_fx(i)"
                                                                            class="form-control" type="text"
                                                                            mask="separator.2" step="0.01"
                                                                            thousandSeparator="," />

                                                                        <a *ngIf="!viewMode && !capexDisableField"
                                                                            class="btn btn-danger btn-sm mt-3"
                                                                            (click)="deleteSellingPoint(i)">
                                                                            <i class="fas fa-trash-alt"></i>
                                                                        </a>
                                                                    </ng-template>
                                                                </td>
                                                                <td [formGroupName]="i">
                                                                    <input class="form-control" type="text"
                                                                        formControlName="overall" mask="separator.2"
                                                                        step="0.01" thousandSeparator=","
                                                                        [readonly]="true" />
                                                                </td>
                                                                <td [formGroupName]="i"
                                                                    *ngFor="let column of YearTable_capex;let j = index">
                                                                    <ng-container *ngIf="viewMode; else normalMode">
                                                                        <input class="form-control"
                                                                            formControlName="y{{ j + 1 }}"
                                                                            [readonly]="true" mask="separator.2"
                                                                            step="0.01" thousandSeparator="," />
                                                                    </ng-container>
                                                                    <ng-template #normalMode>
                                                                        <input class="form-control"
                                                                            [ngClass]="{'border-danger': flag_fail == 'yes' && !column.isEdit}"
                                                                            (change)="ChangingValue($event.target.value)"
                                                                            formControlName="y{{ j + 1 }}"
                                                                            [readonly]="column.isEdit"
                                                                            mask="separator.2" step="0.01"
                                                                            thousandSeparator="," />
                                                                    </ng-template>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                        <tfoot>
                                                            <tr>
                                                                <td>
                                                                    <label for="finishDate">
                                                                        Total Million Baht
                                                                    </label>
                                                                </td>
                                                                <td>
                                                                    <input class="form-control" type="text"
                                                                        [readonly]="true" mask="separator.2"
                                                                        thousandSeparator=","
                                                                        formControlName="AnnualTotal_overall" />
                                                                </td>
                                                                <td
                                                                    *ngFor="let column of YearTable_capex;let j = index">
                                                                    <input class="form-control" type="text"
                                                                        [readonly]="true" mask="separator.2"
                                                                        thousandSeparator=","
                                                                        formControlName="AnnualTotal{{ j + 1 }}" />
                                                                </td>
                                                            </tr>
                                                        </tfoot>
                                                    </table>
                                                </div>
                                            </div>
                                            <!-- </div> -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- </div> -->

                        </div>

                        <!-- start Jonit Ventrue -->
                        <div *ngIf="GetEntryMode">
                            <div class="row mt-5">
                                <div class="col-md-12">
                                    <h4>Joint Venture</h4>
                                    <hr />
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-4">
                                    <label>%Share of investment</label>
                                    <input class="form-control">
                                </div>
                                <div class="col-md-2">
                                    <label>Debt</label>
                                    <input class="form-control">
                                </div>
                                <div class="col-md-2">
                                    <label>Equity</label>
                                    <input class="form-control">
                                </div>
                                <div class="col-md-4">
                                    <label>FX</label>
                                    <input class="form-control">
                                </div>
                            </div>

                            <form *ngIf="AnnualForm" [formGroup]="AnnualForm">
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="card text card-initiative">
                                            <div class="form-initiative">
                                                <div class="w-100">
                                                    <div class="table-responsive">
                                                        <table class="table table-bordered">
                                                            <thead class="text-center bg-light">
                                                                <tr>
                                                                    <th width="200px">Investment (Million Baht)</th>
                                                                    <th width="100px">Overall</th>
                                                                    <th width="100px"
                                                                        *ngFor="let column of YearTable_capex;let i = index">
                                                                        {{ column.columnname }}
                                                                    </th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr>
                                                                    <td>เงินทุน PTT Global Chemical(ล้านบาท)</td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                </tr>
                                                                <tr>
                                                                    <td>เงินทุน PTT Global Chemical(ล้านดอลล่าร์)</td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                </tr>
                                                            </tbody>
                                                            <tfoot>
                                                                <tr>
                                                                    <td>
                                                                        <label for="finishDate">
                                                                            Total Million Baht
                                                                        </label>
                                                                    </td>
                                                                    <td>
                                                                        <input class="form-control" type="text"
                                                                            [readonly]="true" mask="separator.2"
                                                                            thousandSeparator=","
                                                                            formControlName="AnnualTotal_overall" />
                                                                    </td>
                                                                    <td
                                                                        *ngFor="let column of YearTable_capex;let j = index">
                                                                        <input class="form-control" type="text"
                                                                            [readonly]="true" mask="separator.2"
                                                                            thousandSeparator=","
                                                                            formControlName="AnnualTotal{{ j + 1 }}" />
                                                                    </td>
                                                                </tr>
                                                            </tfoot>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </form>

                            <form *ngIf="AnnualForm" [formGroup]="AnnualForm">
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="card text card-initiative">
                                            <div class="form-initiative">
                                                <div class="w-100">
                                                    <div class="table-responsive">
                                                        <table class="table table-bordered">
                                                            <thead class="text-center bg-light">
                                                                <tr>
                                                                    <th width="200px">Loan (Million Baht)</th>
                                                                    <th width="100px">Overall</th>
                                                                    <th width="100px"
                                                                        *ngFor="let column of YearTable_capex;let i = index">
                                                                        {{ column.columnname }}
                                                                    </th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr>
                                                                    <td>เงินกู้ (ล้านบาท)</td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                </tr>
                                                                <tr>
                                                                    <td>เงินกู้ (ล้านดอลล่าร์)</td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                    <td><input class="form-control"></td>
                                                                </tr>
                                                            </tbody>
                                                            <tfoot>
                                                                <tr>
                                                                    <td>
                                                                        <label for="finishDate">
                                                                            Total Million Baht
                                                                        </label>
                                                                    </td>
                                                                    <td>
                                                                        <input class="form-control" type="text"
                                                                            [readonly]="true" mask="separator.2"
                                                                            thousandSeparator=","
                                                                            formControlName="AnnualTotal_overall" />
                                                                    </td>
                                                                    <td
                                                                        *ngFor="let column of YearTable_capex;let j = index">
                                                                        <input class="form-control" type="text"
                                                                            [readonly]="true" mask="separator.2"
                                                                            thousandSeparator=","
                                                                            formControlName="AnnualTotal{{ j + 1 }}" />
                                                                    </td>
                                                                </tr>
                                                            </tfoot>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>


                        <!-- end Jonit Ventrue -->


                        <!-- <ng-container *ngIf="!IsReturn || IsRequestPool"> -->
                        <ng-container *ngIf="AnnualForm">
                            <div *ngFor="let ym of year_m; let i = index">
                                <form *ngIf="i == 0" [formGroup]="monthForm0">
                                    <div class="row mt-5">
                                        <div class="col-md-11">
                                            <h4>Monthly Investment Plan ({{ ym }})</h4>
                                            <hr />
                                        </div>
                                        <div class="col-md-1">
                                            <button class="btn btn-info" data-toggle="collapse" data-target="#M1">
                                                +
                                            </button>
                                        </div>
                                    </div>

                                    <div class="container collapse show" id="M1">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="card text card-initiative">
                                                    <div class="form-initiative">
                                                        <div class="form-row align-items-center">
                                                            <div class="w-100">
                                                                <div class="table-responsive">
                                                                    <table class="table table-bordered">
                                                                        <thead class="text-center bg-light">
                                                                            <tr>
                                                                                <th width="200px">Investment Plan</th>
                                                                                <th width="180px">Overall</th>
                                                                                <th width="180px"
                                                                                    *ngFor="let m of monthList_1">
                                                                                    {{ m.columnname }}
                                                                                </th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody
                                                                            *ngFor="let cd of monthForm0_.controls;let j = index">
                                                                            <tr formArrayName="monthForm_list">
                                                                                <td [formGroupName]="j">
                                                                                    <select class="form-control"
                                                                                        formControlName="currencyTitle"
                                                                                        disabled="flagFirst_row">
                                                                                        <option
                                                                                            *ngFor="let t of currencyMountList"
                                                                                            [value]="t.currencyValue">
                                                                                            {{ t.currencyName }}
                                                                                        </option>
                                                                                    </select>
                                                                                    <label class="mt-3" for="finishDate"
                                                                                        *ngIf="j != 0">
                                                                                        FX {{ cd.get('flag_alert').value
                                                                                        }}
                                                                                    </label>
                                                                                    <input formControlName="currencyFx"
                                                                                        class="form-control" type="text"
                                                                                        *ngIf="j != 0"
                                                                                        readonly="true" />
                                                                                </td>
                                                                                <td [formGroupName]="j">
                                                                                    <input class="form-control"
                                                                                        type="text"
                                                                                        formControlName="overall"
                                                                                        mask="separator.2"
                                                                                        thousandSeparator=","
                                                                                        [readonly]="true" />
                                                                                </td>
                                                                                <td [formGroupName]="j"
                                                                                    *ngFor="let column of monthList_1;let jj = index">
                                                                                    <input
                                                                                        *ngIf="cd.get('flag_alert').value == true && !viewMode"
                                                                                        class="form-control ; border-danger"
                                                                                        formControlName="m{{ jj + 1 }}"
                                                                                        [readonly]="column.readOnly  || viewMode"
                                                                                        (change)="ChangingValue_month_table1(ym)"
                                                                                        (keypress)="keyPress($event)"
                                                                                        type="text" pattern="[0-9]*"
                                                                                        mask="separator"
                                                                                        thousandSeparator=","
                                                                                        value="" />
                                                                                    <input
                                                                                        *ngIf="cd.get('flag_alert').value == false"
                                                                                        class="form-control"
                                                                                        formControlName="m{{ jj + 1 }}"
                                                                                        [readonly]="column.readOnly || viewMode"
                                                                                        (change)="ChangingValue_month_table1(ym)"
                                                                                        (keypress)="keyPress($event)"
                                                                                        type="text" pattern="[0-9]*"
                                                                                        mask="separator"
                                                                                        thousandSeparator="," />
                                                                                </td>
                                                                            </tr>
                                                                        </tbody>
                                                                        <tfoot>
                                                                            <tr>
                                                                                <td>
                                                                                    <label for="finishDate">
                                                                                        Total Baht
                                                                                    </label>
                                                                                </td>
                                                                                <td>
                                                                                    <input class="form-control"
                                                                                        type="text" [readonly]="true"
                                                                                        formControlName="monthTotal_overall"
                                                                                        mask="separator.2"
                                                                                        thousandSeparator="," />
                                                                                </td>
                                                                                <td
                                                                                    *ngFor="let column of monthList_1;let j = index">
                                                                                    <input class="form-control"
                                                                                        type="text" [readonly]="true"
                                                                                        formControlName="monthTotal{{j + 1}}"
                                                                                        mask="separator.2"
                                                                                        thousandSeparator="," />
                                                                                </td>
                                                                            </tr>
                                                                        </tfoot>
                                                                    </table>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </form>

                                <form *ngIf="i == 1" [formGroup]="monthForm1">
                                    <div class="row mt-5">
                                        <div class="col-md-11">
                                            <h4>Monthly Investment Plan ({{ ym }})</h4>
                                            <hr />
                                        </div>
                                        <div class="col-md-1">
                                            <button class="btn btn-info" data-toggle="collapse" data-target="#M2">
                                                +
                                            </button>
                                        </div>
                                    </div>

                                    <div class="container collapse show" id="M2">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="card text card-initiative">
                                                    <div class="form-initiative">
                                                        <div class="form-row align-items-center">
                                                            <div class="w-100">
                                                                <div class="table-responsive">
                                                                    <table class="table table-bordered">
                                                                        <thead class="text-center bg-light">
                                                                            <tr>
                                                                                <th width="200px">Investment Plan</th>
                                                                                <th width="180px">Overall</th>

                                                                                <ng-container *ngIf="i != diffYear">
                                                                                    <th width="180px"
                                                                                        *ngFor="let m of monthList_x">
                                                                                        {{ m.columnname }}
                                                                                    </th>
                                                                                </ng-container>
                                                                                <ng-container *ngIf="i == diffYear">
                                                                                    <th width="180px"
                                                                                        *ngFor="let m of monthList_last">
                                                                                        {{ m.columnname }}
                                                                                    </th>
                                                                                </ng-container>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                            <tr formArrayName="monthForm_list"
                                                                                *ngFor="let cd of monthForm1_.controls;let j = index">
                                                                                <td [formGroupName]="j">
                                                                                    <select class="form-control"
                                                                                        formControlName="currencyTitle"
                                                                                        disabled="flagFirst_row">
                                                                                        <option
                                                                                            *ngFor="let t of typeTransaction_month"
                                                                                            [value]="t.code">
                                                                                            {{ t.chooes }}
                                                                                        </option>
                                                                                    </select>
                                                                                    <label class="mt-3" for="finishDate"
                                                                                        *ngIf="j != 0">
                                                                                        FX
                                                                                    </label>
                                                                                    <input formControlName="currencyFx"
                                                                                        class="form-control" type="text"
                                                                                        *ngIf="j != 0"
                                                                                        readonly="true" />
                                                                                </td>
                                                                                <td [formGroupName]="j">
                                                                                    <input class="form-control"
                                                                                        type="text"
                                                                                        formControlName="overall"
                                                                                        [readonly]="true"
                                                                                        mask="separator.2"
                                                                                        thousandSeparator="," />
                                                                                </td>
                                                                                <ng-container *ngIf="i != diffYear">
                                                                                    <td [formGroupName]="j"
                                                                                        *ngFor="let column of monthList_x;let jj = index ">
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value == true"
                                                                                            class="form-control ; border-danger"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table2(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="text" pattern="[0-9]*"
                                                                                            pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value == false"
                                                                                            class="form-control"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table2(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="text" pattern="[0-9]*"
                                                                                            pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                    </td>
                                                                                </ng-container>
                                                                                <ng-container *ngIf="i == diffYear">
                                                                                    <td [formGroupName]="j"
                                                                                        *ngFor="let column of monthList_last;let jj = index">
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value == true"
                                                                                            class="form-control ; border-danger"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table2(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="text" pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value == false"
                                                                                            class="form-control"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table2(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="text" pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                    </td>
                                                                                </ng-container>
                                                                            </tr>
                                                                        </tbody>
                                                                        <tfoot>
                                                                            <tr>
                                                                                <td>
                                                                                    <label for="finishDate">
                                                                                        Total Baht
                                                                                    </label>
                                                                                </td>
                                                                                <td>
                                                                                    <input class="form-control"
                                                                                        type="text" [readonly]="true"
                                                                                        formControlName="monthTotal_overall"
                                                                                        mask="separator.2"
                                                                                        thousandSeparator="," />
                                                                                </td>
                                                                                <td
                                                                                    *ngFor="let column of monthList_1;let j = index">
                                                                                    <input class="form-control"
                                                                                        type="text" [readonly]="true"
                                                                                        formControlName="monthTotal{{ j + 1}}"
                                                                                        mask="separator.2"
                                                                                        thousandSeparator="," />
                                                                                </td>
                                                                            </tr>
                                                                        </tfoot>
                                                                    </table>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </form>

                                <form *ngIf="i == 2" [formGroup]="monthForm2">
                                    <div class="row mt-5">
                                        <div class="col-md-11">
                                            <h4>Monthly Investment Plan ({{ ym }})</h4>
                                            <hr />
                                        </div>
                                        <div class="col-md-1">
                                            <button class="btn btn-info" data-toggle="collapse" data-target="#M3">
                                                +
                                            </button>
                                        </div>
                                    </div>

                                    <div class="container collapse show" id="M3">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="card text card-initiative">
                                                    <div class="form-initiative">
                                                        <div class="form-row align-items-center">
                                                            <div class="w-100">
                                                                <div class="table-responsive">
                                                                    <table class="table table-bordered">
                                                                        <thead class="text-center bg-light">
                                                                            <tr>
                                                                                <th width="200px">Investment Plan</th>
                                                                                <th width="180px">Overall</th>
                                                                                <th width="180px"
                                                                                    *ngFor="let m of monthList_x">
                                                                                    {{ m.columnname }}
                                                                                </th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                            <tr formArrayName="monthForm_list"
                                                                                *ngFor="let cd of monthForm2_.controls;let j = index">
                                                                                <td [formGroupName]="j">
                                                                                    <select class="form-control"
                                                                                        formControlName="currencyTitle"
                                                                                        disabled="flagFirst_row">
                                                                                        <option
                                                                                            *ngFor="let t of typeTransaction_month"
                                                                                            [value]="t.code">
                                                                                            {{ t.chooes }}
                                                                                        </option>
                                                                                    </select>
                                                                                    <label class="mt-3" for="finishDate"
                                                                                        *ngIf="j != 0">
                                                                                        FX
                                                                                    </label>
                                                                                    <input formControlName="currencyFx"
                                                                                        class="form-control" type="text"
                                                                                        *ngIf="j != 0"
                                                                                        readonly="true" />
                                                                                </td>
                                                                                <td [formGroupName]="j">
                                                                                    <input class="form-control"
                                                                                        type="text"
                                                                                        formControlName="overall"
                                                                                        mask="separator.2"
                                                                                        thousandSeparator=","
                                                                                        [readonly]="true" />
                                                                                </td>
                                                                                <ng-container *ngIf="i != diffYear">
                                                                                    <td [formGroupName]="j"
                                                                                        *ngFor="let column of monthList_x;let jj = index">
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value == true"
                                                                                            class="form-control ; border-danger"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table3(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="text" pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value == false"
                                                                                            class="form-control"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table3(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="text" pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                    </td>
                                                                                </ng-container>
                                                                                <ng-container *ngIf="i == diffYear">
                                                                                    <td [formGroupName]="j"
                                                                                        *ngFor="let column of monthList_last;let jj = index">
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value == true"
                                                                                            class="form-control ; border-danger"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table3(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="text" pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value == false"
                                                                                            class="form-control"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table3(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="text" pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                    </td>
                                                                                </ng-container>
                                                                            </tr>
                                                                        </tbody>
                                                                        <tfoot>
                                                                            <tr>
                                                                                <td>
                                                                                    <label for="finishDate">
                                                                                        Total Baht
                                                                                    </label>
                                                                                </td>
                                                                                <td>
                                                                                    <input class="form-control"
                                                                                        type="text" [readonly]="true"
                                                                                        formControlName="monthTotal_overall"
                                                                                        mask="separator.2"
                                                                                        thousandSeparator="," />
                                                                                </td>
                                                                                <td
                                                                                    *ngFor="let column of monthList_1;let j = index">
                                                                                    <input class="form-control"
                                                                                        type="text" [readonly]="true"
                                                                                        formControlName="monthTotal{{j + 1}}"
                                                                                        mask="separator.2"
                                                                                        thousandSeparator="," />
                                                                                </td>
                                                                            </tr>
                                                                        </tfoot>
                                                                    </table>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </form>

                                <form *ngIf="i == 3" [formGroup]="monthForm3">
                                    <div class="row mt-5">
                                        <div class="col-md-11">
                                            <h4>Monthly Investment Plan ({{ ym }})</h4>
                                            <hr />
                                        </div>
                                        <div class="col-md-1">
                                            <button class="btn btn-info" data-toggle="collapse" data-target="#M4">
                                                +
                                            </button>
                                        </div>
                                    </div>

                                    <div class="container collapse show" id="M4">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="card text card-initiative">
                                                    <div class="form-initiative">
                                                        <div class="form-row align-items-center">
                                                            <div class="w-100">
                                                                <div class="table-responsive">
                                                                    <table class="table table-bordered">
                                                                        <thead class="text-center bg-light">
                                                                            <tr>
                                                                                <th width="200px">Investment Plan</th>
                                                                                <th width="180px">Overall</th>
                                                                                <th width="180px"
                                                                                    *ngFor="let m of monthList_x">
                                                                                    {{ m.columnname }}
                                                                                </th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                            <tr formArrayName="monthForm_list"
                                                                                *ngFor="let cd of monthForm3_.controls;let j = index">
                                                                                <td [formGroupName]="j">
                                                                                    <select class="form-control"
                                                                                        formControlName="currencyTitle"
                                                                                        disabled="flagFirst_row">
                                                                                        <option
                                                                                            *ngFor="let t of typeTransaction_month"
                                                                                            [value]="t.code">
                                                                                            {{ t.chooes }}
                                                                                        </option>
                                                                                    </select>
                                                                                    <label class="mt-3" for="finishDate"
                                                                                        *ngIf="j != 0">
                                                                                        FX
                                                                                    </label>
                                                                                    <input formControlName="currencyFx"
                                                                                        class="form-control" type="text"
                                                                                        *ngIf="j != 0"
                                                                                        readonly="true" />
                                                                                </td>
                                                                                <td [formGroupName]="j">
                                                                                    <input class="form-control"
                                                                                        type="text"
                                                                                        formControlName="overall"
                                                                                        mask="separator.2"
                                                                                        thousandSeparator=","
                                                                                        [readonly]="true" />
                                                                                </td>
                                                                                <ng-container *ngIf="i != diffYear">
                                                                                    <td [formGroupName]="j"
                                                                                        *ngFor="let column of monthList_x;let jj = index">
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value == true"
                                                                                            class="form-control ; border-danger"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table4(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="text" pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value == false"
                                                                                            class="form-control"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table4(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="text" pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                    </td>
                                                                                </ng-container>
                                                                                <ng-container *ngIf="i == diffYear">
                                                                                    <td [formGroupName]="j"
                                                                                        *ngFor="let column of monthList_last;let jj = index">
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value == true"
                                                                                            class="form-control ; border-danger"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table4(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="text" pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value == false"
                                                                                            class="form-control"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table4(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="text" pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                    </td>
                                                                                </ng-container>
                                                                            </tr>
                                                                        </tbody>
                                                                        <tfoot>
                                                                            <tr>
                                                                                <td>
                                                                                    <label for="finishDate">
                                                                                        Total Baht
                                                                                    </label>
                                                                                </td>
                                                                                <td>
                                                                                    <input class="form-control"
                                                                                        type="text" [readonly]="true"
                                                                                        mask="separator.2"
                                                                                        thousandSeparator=","
                                                                                        formControlName="monthTotal_overall" />
                                                                                </td>
                                                                                <td
                                                                                    *ngFor="let column of monthList_1;let j = index">
                                                                                    <input class="form-control"
                                                                                        type="text" [readonly]="true"
                                                                                        mask="separator.2"
                                                                                        thousandSeparator=","
                                                                                        formControlName="monthTotal{{j + 1}}" />
                                                                                </td>
                                                                            </tr>
                                                                        </tfoot>
                                                                    </table>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </form>

                                <form *ngIf="i == 4" [formGroup]="monthForm4">
                                    <div class="row mt-5">
                                        <div class="col-md-11">
                                            <h4>Monthly Investment Plan ({{ ym }})</h4>
                                            <hr />
                                        </div>
                                        <div class="col-md-1">
                                            <button class="btn btn-info" data-toggle="collapse" data-target="#M5">
                                                +
                                            </button>
                                        </div>
                                    </div>

                                    <div class="container collapse show" id="M5">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="card text card-initiative">
                                                    <div class="form-initiative">
                                                        <div class="form-row align-items-center">
                                                            <div class="w-100">
                                                                <div class="table-responsive">
                                                                    <table class="table table-bordered">
                                                                        <thead class="text-center bg-light">
                                                                            <tr>
                                                                                <th width="200px">Investment Plan</th>
                                                                                <th width="180px">Overall</th>
                                                                                <th width="180px"
                                                                                    *ngFor="let m of monthList_x">
                                                                                    {{ m.columnname }}
                                                                                </th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                            <tr formArrayName="monthForm_list"
                                                                                *ngFor="let cd of monthForm4_.controls;let j = index">
                                                                                <td [formGroupName]="j">
                                                                                    <select class="form-control"
                                                                                        formControlName="currencyTitle"
                                                                                        disabled="flagFirst_row">
                                                                                        <option
                                                                                            *ngFor="let t of typeTransaction_month"
                                                                                            [value]="t.code">
                                                                                            {{ t.chooes }}
                                                                                        </option>
                                                                                    </select>
                                                                                    <label class="mt-3" for="finishDate"
                                                                                        *ngIf="j != 0">
                                                                                        FX
                                                                                    </label>
                                                                                    <input formControlName="currencyFx"
                                                                                        class="form-control" type="text"
                                                                                        *ngIf="j != 0"
                                                                                        readonly="true" />
                                                                                </td>
                                                                                <td [formGroupName]="j">
                                                                                    <input class="form-control"
                                                                                        type="text"
                                                                                        formControlName="overall"
                                                                                        mask="separator.2"
                                                                                        thousandSeparator=","
                                                                                        [readonly]="true" />
                                                                                </td>
                                                                                <ng-container *ngIf="i != diffYear">
                                                                                    <td [formGroupName]="j"
                                                                                        *ngFor="let column of monthList_x;let jj = index">
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value == true"
                                                                                            class="form-control ; border-danger"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table5(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="text" pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value == false"
                                                                                            class="form-control"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table5(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="text" pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                    </td>
                                                                                </ng-container>
                                                                                <ng-container *ngIf="i == diffYear">
                                                                                    <td [formGroupName]="j"
                                                                                        *ngFor="let column of monthList_last;let jj = index">
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value == true"
                                                                                            class="form-control ; border-danger"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table5(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="text" pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value == false"
                                                                                            class="form-control"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table5(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="text" pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                    </td>
                                                                                </ng-container>
                                                                            </tr>
                                                                        </tbody>
                                                                        <tfoot>
                                                                            <tr>
                                                                                <td>
                                                                                    <label for="finishDate">
                                                                                        Total Baht
                                                                                    </label>
                                                                                </td>
                                                                                <td>
                                                                                    <input class="form-control"
                                                                                        type="text" [readonly]="true"
                                                                                        mask="separator.2"
                                                                                        thousandSeparator=","
                                                                                        formControlName="monthTotal_overall" />
                                                                                </td>
                                                                                <td
                                                                                    *ngFor="let column of monthList_1;let j = index">
                                                                                    <input class="form-control"
                                                                                        type="text" [readonly]="true"
                                                                                        mask="separator.2"
                                                                                        thousandSeparator=","
                                                                                        formControlName="monthTotal{{j + 1}}" />
                                                                                </td>
                                                                            </tr>
                                                                        </tfoot>
                                                                    </table>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </form>

                                <form *ngIf="i == 5" [formGroup]="monthForm5">
                                    <div class="row mt-5">
                                        <div class="col-md-11">
                                            <h4>Monthly Investment Plan ({{ ym }})</h4>
                                            <hr />
                                        </div>
                                        <div class="col-md-1">
                                            <button class="btn btn-info" data-toggle="collapse" data-target="#M6">
                                                +
                                            </button>
                                        </div>
                                    </div>

                                    <div class="container collapse show" id="M6">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="card text card-initiative">
                                                    <div class="form-initiative">
                                                        <div class="form-row align-items-center">
                                                            <div class="w-100">
                                                                <div class="table-responsive">
                                                                    <table class="table table-bordered">
                                                                        <thead class="text-center bg-light">
                                                                            <tr>
                                                                                <th width="200px">Investment Plan</th>
                                                                                <th width="180px">Overall</th>
                                                                                <th width="180px"
                                                                                    *ngFor="let m of monthList_x">
                                                                                    {{ m.columnname }}
                                                                                </th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                            <tr formArrayName="monthForm_list"
                                                                                *ngFor="let cd of monthForm5_.controls;let j = index">
                                                                                <td [formGroupName]="j">
                                                                                    <select class="form-control"
                                                                                        formControlName="currencyTitle"
                                                                                        disabled="flagFirst_row">
                                                                                        <option
                                                                                            *ngFor="let t of typeTransaction_month"
                                                                                            [value]="t.code">
                                                                                            {{ t.chooes }}
                                                                                        </option>
                                                                                    </select>
                                                                                    <label class="mt-3" for="finishDate"
                                                                                        *ngIf="j != 0">
                                                                                        FX
                                                                                    </label>
                                                                                    <input formControlName="currencyFx"
                                                                                        class="form-control" type="text"
                                                                                        *ngIf="j != 0"
                                                                                        readonly="true" />
                                                                                </td>
                                                                                <td [formGroupName]="j">
                                                                                    <input class="form-control"
                                                                                        type="text"
                                                                                        formControlName="overall"
                                                                                        mask="separator.2"
                                                                                        thousandSeparator=","
                                                                                        [readonly]="true" />
                                                                                </td>
                                                                                <ng-container *ngIf="i != diffYear">
                                                                                    <td [formGroupName]="j"
                                                                                        *ngFor="let column of monthList_x;let jj = index">
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value == true"
                                                                                            class="form-control ; border-danger"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table6(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="text" pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value == false"
                                                                                            class="form-control"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table6(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="text" pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                    </td>
                                                                                </ng-container>
                                                                                <ng-container *ngIf="i == diffYear">
                                                                                    <td [formGroupName]="j"
                                                                                        *ngFor="let column of monthList_last;let jj = index">
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value == true"
                                                                                            class="form-control ; border-danger"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table6(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="text" pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value == false"
                                                                                            class="form-control"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table6(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="text" pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                    </td>
                                                                                </ng-container>
                                                                            </tr>
                                                                        </tbody>
                                                                        <tfoot>
                                                                            <tr>
                                                                                <td>
                                                                                    <label for="finishDate">
                                                                                        Total Baht
                                                                                    </label>
                                                                                </td>
                                                                                <td>
                                                                                    <input class="form-control"
                                                                                        type="text" [readonly]="true"
                                                                                        mask="separator.2"
                                                                                        thousandSeparator=","
                                                                                        formControlName="monthTotal_overall" />
                                                                                </td>
                                                                                <td
                                                                                    *ngFor="let column of monthList_1;let j = index">
                                                                                    <input class="form-control"
                                                                                        type="text" [readonly]="true"
                                                                                        mask="separator.2"
                                                                                        thousandSeparator=","
                                                                                        formControlName="monthTotal{{j + 1}}" />
                                                                                </td>
                                                                            </tr>
                                                                        </tfoot>
                                                                    </table>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </form>

                                <form *ngIf="i == 6" [formGroup]="monthForm6">
                                    <div class="row mt-5">
                                        <div class="col-md-11">
                                            <h4>Monthly Investment Plan ({{ ym }})</h4>
                                            <hr />
                                        </div>
                                        <div class="col-md-1">
                                            <button class="btn btn-info" data-toggle="collapse" data-target="#M7">
                                                +
                                            </button>
                                        </div>
                                    </div>

                                    <div class="container collapse show" id="M7">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="card text card-initiative">
                                                    <div class="form-initiative">
                                                        <div class="form-row align-items-center">
                                                            <div class="w-100">
                                                                <div class="table-responsive">
                                                                    <table class="table table-bordered">
                                                                        <thead class="text-center bg-light">
                                                                            <tr>
                                                                                <th width="200px">Investment Plan</th>
                                                                                <th width="180px">Overall</th>
                                                                                <th width="180px"
                                                                                    *ngFor="let m of monthList_x">
                                                                                    {{ m.columnname }}
                                                                                </th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                            <tr formArrayName="monthForm_list"
                                                                                *ngFor="let cd of monthForm6_.controls;let j = index">
                                                                                <td [formGroupName]="j">
                                                                                    <select class="form-control"
                                                                                        formControlName="currencyTitle"
                                                                                        disabled="flagFirst_row">
                                                                                        <option
                                                                                            *ngFor="let t of typeTransaction_month"
                                                                                            [value]="t.code">
                                                                                            {{ t.chooes }}
                                                                                        </option>
                                                                                    </select>
                                                                                    <label class="mt-3" for="finishDate"
                                                                                        *ngIf="j != 0">
                                                                                        FX
                                                                                    </label>
                                                                                    <input formControlName="currencyFx"
                                                                                        class="form-control" type="text"
                                                                                        *ngIf="j != 0"
                                                                                        readonly="true" />
                                                                                </td>
                                                                                <td [formGroupName]="j">
                                                                                    <input class="form-control"
                                                                                        type="text"
                                                                                        formControlName="overall"
                                                                                        mask="separator.2"
                                                                                        thousandSeparator=","
                                                                                        [readonly]="true" />
                                                                                </td>
                                                                                <ng-container *ngIf="i != diffYear">
                                                                                    <td [formGroupName]="j"
                                                                                        *ngFor="let column of monthList_x;let jj = index">
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value == true"
                                                                                            class="form-control ; border-danger"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table7(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="text" pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value == false"
                                                                                            class="form-control"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table7(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="text" pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                    </td>
                                                                                </ng-container>
                                                                                <ng-container *ngIf="i == diffYear">
                                                                                    <td [formGroupName]="j"
                                                                                        *ngFor="let column of monthList_last;let jj = index">
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value == true"
                                                                                            class="form-control ; border-danger"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table7(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="text" pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value == false"
                                                                                            class="form-control"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table7(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="text" pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                    </td>
                                                                                </ng-container>
                                                                            </tr>
                                                                        </tbody>
                                                                        <tfoot>
                                                                            <tr>
                                                                                <td>
                                                                                    <label for="finishDate">
                                                                                        Total Baht
                                                                                    </label>
                                                                                </td>
                                                                                <td>
                                                                                    <input class="form-control"
                                                                                        type="text" [readonly]="true"
                                                                                        mask="separator.2"
                                                                                        thousandSeparator=","
                                                                                        formControlName="monthTotal_overall" />
                                                                                </td>
                                                                                <td
                                                                                    *ngFor="let column of monthList_1;let j = index">
                                                                                    <input class="form-control"
                                                                                        type="text" [readonly]="true"
                                                                                        mask="separator.2"
                                                                                        thousandSeparator=","
                                                                                        formControlName="monthTotal{{j + 1}}" />
                                                                                </td>
                                                                            </tr>
                                                                        </tfoot>
                                                                    </table>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </form>

                                <form *ngIf="i == 7" [formGroup]="monthForm7">
                                    <div class="row mt-5">
                                        <div class="col-md-11">
                                            <h4>Monthly Investment Plan ({{ ym }})</h4>
                                            <hr />
                                        </div>
                                        <div class="col-md-1">
                                            <button class="btn btn-info" data-toggle="collapse" data-target="#M8">
                                                +
                                            </button>
                                        </div>
                                    </div>

                                    <div class="container collapse show" id="M8">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="card text card-initiative">
                                                    <div class="form-initiative">
                                                        <div class="form-row align-items-center">
                                                            <div class="w-100">
                                                                <div class="table-responsive">
                                                                    <table class="table table-bordered">
                                                                        <thead class="text-center bg-light">
                                                                            <tr>
                                                                                <th width="200px">Investment Plan</th>
                                                                                <th width="180px">Overall</th>
                                                                                <th width="180px"
                                                                                    *ngFor="let m of monthList_x">
                                                                                    {{ m.columnname }}
                                                                                </th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                            <tr formArrayName="monthForm_list"
                                                                                *ngFor="let cd of monthForm7_.controls;let j = index">
                                                                                <td [formGroupName]="j">
                                                                                    <select class="form-control"
                                                                                        formControlName="currencyTitle"
                                                                                        disabled="flagFirst_row">
                                                                                        <option
                                                                                            *ngFor="let t of typeTransaction_month"
                                                                                            [value]="t.code">
                                                                                            {{ t.chooes }}
                                                                                        </option>
                                                                                    </select>
                                                                                    <label class="mt-3" for="finishDate"
                                                                                        *ngIf="j != 0">
                                                                                        FX
                                                                                    </label>
                                                                                    <input formControlName="currencyFx"
                                                                                        class="form-control" type="text"
                                                                                        *ngIf="j != 0"
                                                                                        readonly="true" />
                                                                                </td>
                                                                                <td [formGroupName]="j">
                                                                                    <input class="form-control"
                                                                                        type="text"
                                                                                        formControlName="overall"
                                                                                        mask="separator.2"
                                                                                        thousandSeparator=","
                                                                                        [readonly]="true" />
                                                                                </td>
                                                                                <ng-container *ngIf="i != diffYear">
                                                                                    <td [formGroupName]="j"
                                                                                        *ngFor="let column of monthList_x;let jj = index">
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value == true"
                                                                                            class="form-control ; border-danger"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table8(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="text" pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value == false"
                                                                                            class="form-control"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table8(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="text" pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                    </td>
                                                                                </ng-container>
                                                                                <ng-container *ngIf="i == diffYear">
                                                                                    <td [formGroupName]="j"
                                                                                        *ngFor="let column of monthList_last;let jj = index">
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value == true"
                                                                                            class="form-control ; border-danger"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table8(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="text" pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value ==false"
                                                                                            class="form-control"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table8(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="text" pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                    </td>
                                                                                </ng-container>
                                                                            </tr>
                                                                        </tbody>
                                                                        <tfoot>
                                                                            <tr>
                                                                                <td>
                                                                                    <label for="finishDate">
                                                                                        Total Baht
                                                                                    </label>
                                                                                </td>
                                                                                <td>
                                                                                    <input class="form-control"
                                                                                        type="text" [readonly]="true"
                                                                                        mask="separator.2"
                                                                                        thousandSeparator=","
                                                                                        formControlName="monthTotal_overall" />
                                                                                </td>
                                                                                <td
                                                                                    *ngFor="let column of monthList_1;let j = index">
                                                                                    <input class="form-control"
                                                                                        type="text" [readonly]="true"
                                                                                        mask="separator.2"
                                                                                        thousandSeparator=","
                                                                                        formControlName="monthTotal{{j + 1}}" />
                                                                                </td>
                                                                            </tr>
                                                                        </tfoot>
                                                                    </table>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </form>

                                <form *ngIf="i == 8" [formGroup]="monthForm8">
                                    <div class="row mt-5">
                                        <div class="col-md-11">
                                            <h4>Monthly Investment Plan ({{ ym }})</h4>
                                            <hr />
                                        </div>
                                        <div class="col-md-1">
                                            <button class="btn btn-info" data-toggle="collapse" data-target="#M9">
                                                +
                                            </button>
                                        </div>
                                    </div>

                                    <div class="container collapse show" id="M9">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="card text card-initiative">
                                                    <div class="form-initiative">
                                                        <div class="form-row align-items-center">
                                                            <div class="w-100">
                                                                <div class="table-responsive">
                                                                    <table class="table table-bordered">
                                                                        <thead class="text-center bg-light">
                                                                            <tr>
                                                                                <th width="200px">Investment Plan</th>
                                                                                <th width="180px">Overall</th>
                                                                                <th width="180px"
                                                                                    *ngFor="let m of monthList_x">
                                                                                    {{ m.columnname }}
                                                                                </th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                            <tr formArrayName="monthForm_list"
                                                                                *ngFor="let cd of monthForm8_.controls;let j = index">
                                                                                <td [formGroupName]="j">
                                                                                    <select class="form-control"
                                                                                        formControlName="currencyTitle"
                                                                                        disabled="flagFirst_row">
                                                                                        <option
                                                                                            *ngFor="let t of typeTransaction_month"
                                                                                            [value]="t.code">
                                                                                            {{ t.chooes }}
                                                                                        </option>
                                                                                    </select>
                                                                                    <label class="mt-3" for="finishDate"
                                                                                        *ngIf="j != 0">
                                                                                        FX
                                                                                    </label>
                                                                                    <input formControlName="currencyFx"
                                                                                        class="form-control" type="text"
                                                                                        *ngIf="j != 0"
                                                                                        readonly="true" />
                                                                                </td>
                                                                                <td [formGroupName]="j">
                                                                                    <input class="form-control"
                                                                                        type="text"
                                                                                        formControlName="overall"
                                                                                        mask="separator.2"
                                                                                        thousandSeparator=","
                                                                                        [readonly]="true" />
                                                                                </td>
                                                                                <ng-container *ngIf="i != diffYear">
                                                                                    <td [formGroupName]="j"
                                                                                        *ngFor="let column of monthList_x;let jj = index">
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value ==true"
                                                                                            class="form-control ; border-danger"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table9(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="text" pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value == false"
                                                                                            class="form-control"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table9(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="text" pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                    </td>
                                                                                </ng-container>
                                                                                <ng-container *ngIf="i == diffYear">
                                                                                    <td [formGroupName]="j"
                                                                                        *ngFor="let column of monthList_last;let jj = index">
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value ==true"
                                                                                            class="form-control ; border-danger"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table9(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="text" pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value ==false"
                                                                                            class="form-control"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table9(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="text" pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                    </td>
                                                                                </ng-container>
                                                                            </tr>
                                                                        </tbody>
                                                                        <tfoot>
                                                                            <tr>
                                                                                <td>
                                                                                    <label for="finishDate">
                                                                                        Total Baht
                                                                                    </label>
                                                                                </td>
                                                                                <td
                                                                                    *ngFor="let column of monthList_1;let j = index">
                                                                                    <input class="form-control"
                                                                                        type="text" [readonly]="true"
                                                                                        mask="separator.2"
                                                                                        thousandSeparator=","
                                                                                        formControlName="monthTotal{{j + 1}}" />
                                                                                </td>
                                                                                <td>
                                                                                    <input class="form-control"
                                                                                        type="text" [readonly]="true"
                                                                                        mask="separator.2"
                                                                                        thousandSeparator=","
                                                                                        formControlName="monthTotal_overall" />
                                                                                </td>
                                                                            </tr>
                                                                        </tfoot>
                                                                    </table>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </form>

                                <form *ngIf="i == 9" [formGroup]="monthForm9">
                                    <div class="row mt-5">
                                        <div class="col-md-11">
                                            <h4>Monthly Investment Plan ({{ ym }})</h4>
                                            <hr />
                                        </div>
                                        <div class="col-md-1">
                                            <button class="btn btn-info" data-toggle="collapse" data-target="#M10">
                                                +
                                            </button>
                                        </div>
                                    </div>

                                    <div class="container collapse show" id="M10">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="card text card-initiative">
                                                    <div class="form-initiative">
                                                        <div class="form-row align-items-center">
                                                            <div class="w-100">
                                                                <div class="table-responsive">
                                                                    <table class="table table-bordered">
                                                                        <thead class="text-center bg-light">
                                                                            <tr>
                                                                                <th width="200px">Investment Plan</th>
                                                                                <th width="180px">Overall</th>
                                                                                <th width="180px"
                                                                                    *ngFor="let m of monthList_x">
                                                                                    {{ m.columnname }}
                                                                                </th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                            <tr formArrayName="monthForm_list"
                                                                                *ngFor="let cd of monthForm9_.controls;let j = index">
                                                                                <td [formGroupName]="j">
                                                                                    <select class="form-control"
                                                                                        formControlName="currencyTitle"
                                                                                        disabled="flagFirst_row">
                                                                                        <option
                                                                                            *ngFor="let t of typeTransaction_month"
                                                                                            [value]="t.code">
                                                                                            {{ t.chooes }}
                                                                                        </option>
                                                                                    </select>
                                                                                    <label class="mt-3" for="finishDate"
                                                                                        *ngIf="j != 0">
                                                                                        FX
                                                                                    </label>
                                                                                    <input formControlName="currencyFx"
                                                                                        class="form-control" type="text"
                                                                                        *ngIf="j != 0"
                                                                                        readonly="true" />
                                                                                </td>

                                                                                <td [formGroupName]="j">
                                                                                    <input class="form-control"
                                                                                        type="text"
                                                                                        formControlName="overall"
                                                                                        mask="separator.2"
                                                                                        thousandSeparator=","
                                                                                        [readonly]="true" />
                                                                                </td>
                                                                                <ng-container *ngIf="i != diffYear">
                                                                                    <td [formGroupName]="j"
                                                                                        *ngFor="let column of monthList_x;let jj = index">
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value ==true"
                                                                                            class="form-control ; border-danger"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table10(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="text" pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value ==false"
                                                                                            class="form-control"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table10(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="text" pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                    </td>
                                                                                </ng-container>
                                                                                <ng-container *ngIf="i == diffYear">
                                                                                    <td [formGroupName]="j"
                                                                                        *ngFor="let column of monthList_last;let jj = index">
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value ==true"
                                                                                            class="form-control ; border-danger"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table10(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="test" pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                        <input
                                                                                            *ngIf="cd.get('flag_alert').value ==false"
                                                                                            class="form-control"
                                                                                            formControlName="m{{ jj + 1 }}"
                                                                                            [readonly]="column.readOnly"
                                                                                            (change)="ChangingValue_month_table10(ym)"
                                                                                            (keypress)="keyPress($event)"
                                                                                            type="text" pattern="[0-9]*"
                                                                                            mask="separator"
                                                                                            thousandSeparator="," />
                                                                                    </td>
                                                                                </ng-container>
                                                                            </tr>
                                                                        </tbody>
                                                                        <tfoot>
                                                                            <tr>
                                                                                <td>
                                                                                    <label for="finishDate">
                                                                                        Total Baht
                                                                                    </label>
                                                                                </td>
                                                                                <td>
                                                                                    <input class="form-control"
                                                                                        type="text" [readonly]="true"
                                                                                        mask="separator.2"
                                                                                        thousandSeparator=","
                                                                                        formControlName="monthTotal_overall" />
                                                                                </td>
                                                                                <td
                                                                                    *ngFor="let column of monthList_1;let j = index">
                                                                                    <input class="form-control"
                                                                                        type="text" [readonly]="true"
                                                                                        mask="separator.2"
                                                                                        thousandSeparator=","
                                                                                        formControlName="monthTotal{{j + 1}}" />
                                                                                </td>
                                                                            </tr>
                                                                        </tfoot>
                                                                    </table>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </ng-container>
                    </ng-container>

                    <!-- End Table -->
                </div>

                <br />
                <br />
                <br />
                <div class="row mt-5 d-none">
                    <div class="col-md-12">
                        <button *ngIf="!viewMode" class="btn btn-success">Attach files/View files</button>
                    </div>
                </div>

                <div class="row mt-5 d-none">
                    <div class="col-sm-12 col-md-6">
                        <span>Total Million Baht </span>
                        <select class="form-control mt-2">
                            <option value="Million Baht">Choose ...</option>
                            <option></option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>