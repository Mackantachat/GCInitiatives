<div class="row">
  <div class="col-md-12">
    <div class="card text card-initiative">
      <div class="card-body">
        <div class="initiative-form" *ngIf="id">
          <app-initiative-info [id]="id"></app-initiative-info>
        </div>
        <!-- <form *ngIf="Initiative_tmp" [formGroup]="capexInformationForm"> -->
        <form [formGroup]="capexInformationForm">
          <div class="row mt-5">
            <div class="col-md-12">
              <label style="color: #454545;font-size: 28px;"> {{name}} </label>
              <hr>
            </div>
            <div class="col-md-6">
              <label for="StartingDate">
                Starting Date <span class="text-danger">*</span> :
              </label>
              <div class="input-group">
                <input formControlName="startingDate" (bsValueChange)="setStartingDate($event)" type="text"
                  class="form-control" [bsConfig]="bsConfigStart" bsDatepicker #dpStart="bsDatepicker"
                  [ngClass]="{ 'is-invalid': invalidStartingDate }" [triggers]="viewMode ? '' : 'click:click'" />
                <div *ngIf="!viewMode" class="input-group-append">
                  <i class="far fa-calendar right-icon mt-2" (click)="dpStart.toggle()"
                    [attr.aria-expanded]="dpStart.isOpen"></i>
                </div>
                <div class="invalid-feedback" *ngIf="invalidStartingDate">
                  Starting Date is required !
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <label for="ProjecctComRun">
                Finish Date <span class="text-danger">*</span> :
              </label>
              <div class="input-group">
                <input formControlName="projecctComRun" (bsValueChange)="setFinishDate($event)" type="text"
                  class="form-control" [bsConfig]="bsConfigFinish" bsDatepicker #dpFinish="bsDatepicker"
                  [ngClass]="{ 'is-invalid': invalidFinishingDate }" [triggers]="viewMode ? '' : 'click:click'" />
                <div *ngIf="!viewMode" class="input-group-append">
                  <i class="far fa-calendar right-icon mt-2" (click)="dpFinish.toggle()"
                    [attr.aria-expanded]="dpFinish.isOpen"></i>
                </div>
                <div class="invalid-feedback" *ngIf="invalidFinishingDate">
                  Finish Date is required !
                </div>
              </div>
            </div>
          </div>

          <div class="row mt-3">
            <div class="col-md-6">
              <label for="RequestIniNoDate">
                Request Project No. Date (Budget Start Date)
                <span class="text-danger">*</span> :
              </label>
              <div class="input-group">
                <input formControlName="requestIniNoDate" (bsValueChange)="setRequestDate($event)" type="text"
                  class="form-control" [bsConfig]="bsConBetween" bsDatepicker #dpBudget="bsDatepicker"
                  [ngClass]="{ 'is-invalid': invalidRequestIniNoDate }" [triggers]="viewMode ? '' : 'click:click'" />
                <div *ngIf="!viewMode" class="input-group-append">
                  <i class="far fa-calendar right-icon mt-2" (click)="dpBudget.toggle()"
                    [attr.aria-expanded]="dpBudget.isOpen"></i>
                </div>
                <div class="invalid-feedback" *ngIf="invalidRequestIniNoDate">
                  Request Project No. Date (Budget Start Date) is required !
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <label for="finishDate">
                Project Execution Period <span class="text-danger">*</span> :
              </label>
              <div class="row">
                <div class="col-md-3">
                  <input type="text" class="form-control" value="projectExePeriodYear"
                    formControlName="projectExePeriodYear" readonly />
                </div>
                <div class="col-md-3 p-2">
                  <span>Year</span>
                </div>
                <div class="col-md-3">
                  <input type="text" class="form-control" value="projectExePeriodMonth"
                    formControlName="projectExePeriodMonth" readonly />
                </div>
                <div class="col-md-3 p-2">
                  <span>Month</span>
                </div>
              </div>
            </div>
          </div>
          <div class="row mt-3">
            <div class="col-md-6">
              <label for="costCenterOfVP">
                Cost Center of VP (Asset Owner)
                <span class="text-danger">*</span> :
              </label>
              <ng-select formControlName="costCenterOfVP" [items]="owners" bindValue="ownerName" bindLabel="ownerName"
                placeholder="Choose Owner" (search)="SearchOwnerName($event)" (clear)="ClearOwnerName()"
                (change)="GetOwnersVP($event)" [ngClass]="{ 'is-invalid': invalidOrganization }">
              </ng-select>
            </div>
            <div class="col-md-6">
              <label for="codeCostCenterOfVP">
                Code Of Cost Center of VP (Asset Owner)
                <span class="text-danger">*</span> :
              </label>
              <input formControlName="codeCostCenterOfVP" type="text" name="codeCostCenterOfVP" class="form-control"
                placeholder="" [ngClass]="{ 'is-invalid': invalidCodeCostCenterOfVP }" readonly />
              <div class="invalid-feedback" *ngIf="invalidCodeCostCenterOfVP">
                Code Of Cost Center of VP is not found !
              </div>
            </div>
          </div>


          <div class="row mt-3">
            <div class="col-md-6">
              <label for="projectCost">
                Project Cost (MTHB) <span class="text-danger">*</span> :
              </label>
              <input formControlName="projectCost" #projectCost_tmp
                (blur)="checkRequestIniNoDate(projectCost_tmp.value)" type="text" name="projectCost"
                class="form-control" step="0.01" placeholder="0.00" mask="separator.2" thousandSeparator=","
                [ngClass]="{ 'is-invalid': invalidCostEstCapex }" />

              <div class="invalid-feedback" *ngIf="invalidCostEstCapex">
                Project Cost (MTHB) is required !
              </div>
            </div>
          </div>

          <div class="row mt-3">
            <div class="col-md-12" *ngIf="RemarkShow == true">
              <label for="reasonOfChanging">
                Reason of changing Project Cost
                <span class="text-danger">*</span>
                :
              </label>
              <textarea class="form-control" id="reasonOfChanging" rows="2" name="reasonOfChanging"
                formControlName="reasonOfChanging"></textarea>
            </div>
          </div>

          <div class="row mt-3">
            <div class="col-md-2">
              <label for="budgetPeriod">
                Budget Period <span class="text-danger">*</span> :
              </label>
            </div>
            <div class="col-md-10">
              <div class="custom-control custom-radio custom-control-inline">
                <input id="annual" value="Annual" class="custom-control-input" type="radio" name="budgetPeriod"
                  formControlName="budgetPeriod" (change)="OnChangeRequestOPEX($event.target.value)"
                  [ngClass]="{ 'is-invalid': invalidBudget }" />
                <label class="custom-control-label" for="annual">
                  Annual {{ year_next ? '('+ year_next + ')' : null }}
                </label>
              </div>
            </div>
            <div class="col-md-2"></div>
            <div class="col-md-10 mt-1">
              <div class="custom-control custom-radio custom-control-inline">
                <input id="midYear" value="Mid Year" class="custom-control-input" type="radio" name="budgetPeriod"
                  formControlName="budgetPeriod" (change)="OnChangeRequestOPEX($event.target.value)"
                  [ngClass]="{ 'is-invalid': invalidBudget }" />
                <label class="custom-control-label" for="midYear">
                  Mid Year {{year_now ? '('+ year_now + ')' : null }}
                </label>
              </div>
            </div>
            <div class="col-md-2"></div>
            <div class="col-md-10 mt-2">
              <div class="custom-control custom-radio custom-control-inline">
                <input id="between" value="Current year" class="custom-control-input" type="radio" name="budgetPeriod"
                  formControlName="budgetPeriod" (change)="OnChangeRequestOPEX($event.target.value)"
                  [ngClass]="{ 'is-invalid': invalidBudget }" />
                <label class="custom-control-label" for="between">
                  Current year
                </label>
              </div>
            </div>
          </div>

          <div class="row mt-3 sub-Between" *ngIf="showContingency">
            <div class="col-md-12">
              <div class="custom-control custom-radio custom-control-inline">
                <input id="contingency" value="Contingency" class="custom-control-input" type="radio" name="betweenYear"
                  formControlName="betweenYear" (change)="OnChangeBetweenYear($event.target.value)"
                  [ngClass]="{ 'is-invalid': invalidBudget }" />
                <label class="custom-control-label" for="contingency">
                  Contingency ({{ year_now }})
                </label>
              </div>
            </div>
            <div class="col-md-12 mt-2">
              <div class="custom-control custom-radio custom-control-inline">
                <input id="transfer" value="Transfer" class="custom-control-input" type="radio" name="betweenYear"
                  formControlName="betweenYear" (change)="OnChangeBetweenYear($event.target.value)"
                  [ngClass]="{ 'is-invalid': invalidBudget }" />
                <label class="custom-control-label" for="transfer">
                  Transfer ({{ year_now }})
                </label>
              </div>
            </div>
          </div>

          <div class="col-md-12 sub-Transfer">
            <div *ngIf="inshow">
              <label for="transferForm">
                Transfer Form <span class="text-danger">*</span> :
              </label>
              <div class="input-group" id="Form" style="width: 50%;">
                <select formControlName="transferForm" name="transferForm" value="transferForm" class="form-control"
                  (change)="transfer($event.target.value)">
                  <option value="" selected disabled> Choose...</option>
                  <option value="OPEX">OPEX</option>
                  <option value="RMA">RMA</option>
                </select>
              </div>
            </div>
          </div>
          <div class="row mt-3">
            <div class="row sub-Between" *ngIf="showContingency">
              <div class="col-md-12 mt-2">
                <div class="custom-control custom-radio custom-control-inline">
                  <input id="pool" value="Pool Budget" class="custom-control-input" type="radio" name="betweenYear"
                    formControlName="betweenYear" (change)="OnChangeBetweenYear($event.target.value)" />
                  <label class="custom-control-label" for="pool">
                    Pool Budget ({{ year_now }})
                  </label>
                </div>
              </div>
            </div>

            <div class="col-md-12 mt-3 sub-Transfer">
              <div *ngIf="ferPool">
                <label for="poolBudgetForm">
                  Pool Budget From <span class="text-danger">*</span> :
                </label>
                <div class="input-group" id="Form" style="width: 50%;">
                  <select class="form-control" formControlName="poolBudgetForm" name="poolBudgetForm"
                    value="poolBudgetForm" (change)="pool($event.target.value)">
                    <option value="" selected readOnly> Choose...</option>
                    <option value="Digital CAPEX">Digital CAPEX</option>
                    <option value="IT CAPEX">IT CAPEX</option>
                    <option value="PIM">PIM</option>
                    <option value="MAX">MAX</option>
                    <option value="ER">ER</option>
                    <option value="MTPi">MTPi</option>
                  </select>
                </div>
              </div>
            </div>

            <div class="col-md-2"></div>
            <div class="col-md-5 mt-2 pl-6">
              <div *ngIf="ferPool">
                <div class="col-md-12">
                  <label for="poolYear"> Pool Year </label>
                  <div class="input-group">
                    <!-- <input type="text" class="form-control" readonly="true" formControlName="poolYear" [(ngModel)]="PoolYear" /> -->
                    <input type="text" class="form-control" readonly="true" formControlName="poolYear" />
                  </div>
                </div>
              </div>
            </div>
            <div class="col-md-5 mt-2 pl-6">
              <div *ngIf="ferPool">
                <label for="poolID">
                  Pool ID<span class="text-danger">*</span> :
                </label>
                <!-- <ng-select formControlName="poolID" [items]="PoolID_list" bindValue="id"
                                    bindLabel="name" placeholder="Choose PoolID" [(ngModel)]="pool_id"
                                    (change)="getPoolAva($event)">
                                </ng-select> -->
                <ng-select formControlName="poolID" [items]="PoolID_list" bindValue="id" bindLabel="name"
                  placeholder="Choose PoolID" (change)="getPoolAva($event)">
                </ng-select>
              </div>
            </div>
            <div class="col-md-2"></div>
            <div class="col-md-5 mt-3 pl-5">
              <div *ngIf="ferPool">
                <label for="availableBudget">
                  Available Budget (MTHB)<span class="text-danger">*</span> :
                </label>
                <input formControlName="availableBudget" type="text" name="" class="form-control" placeholder=""
                  readonly="true" />
              </div>
            </div>
          </div>

          <!-- Start Table -->
          <!---->
          <ng-container *ngIf="RequestIniNoDate != null  && ProjectCost != null">

            <div class="row mt-5">
              <div class="col-md-12">
                <h4>Annual Investment Plan</h4>
                <hr />
              </div>
            </div>

            <div *ngIf="AnnualForm" [formGroup]="AnnualForm">
              <div class="row">
                <div class="col-md-12">
                  <div class="card text card-initiative">
                    <div class="form-initiative">
                      <div class="w-100">
                        <div class="table-responsive">
                          <table class="table table-bordered">
                            <thead class="text-center bg-light">
                              <tr>
                                <th width="200px">Investment Plan</th>
                                <th width="100px">Overall</th>
                                <th width="100px" *ngFor="let column of YearTable_capex;let i = index">
                                  {{ column.columnname }}
                                </th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr formArrayName="annualForm_list" *ngFor="let cd of annualForm_.controls;let i = index">
                                <td class="text-center" [formGroupName]="i">
                                  <ng-container *ngIf="i == 0; else imoreZero">
                                    <input formControlName="currencyTitle" class="form-control" type="text" readonly />
                                  </ng-container>
                                  <ng-template #imoreZero>
                                    <select class="form-control" *ngIf="i != 0" formControlName="currencyTitle"
                                      (change)="changeRate($event.target.value, i)">
                                      <option *ngFor="let t of currencyList" [value]="t.currencyMillionName"
                                        (change)="duplicates($event.target.value)">
                                        {{ t.currencyMillionName }}
                                      </option>
                                    </select>
                                  </ng-template>

                                  <label class="mt-3" for="finishDate" *ngIf="i != 0">
                                    FX
                                  </label>

                                  <input formControlName="currencyFx" (change)="ChangingValue_fx(i)"
                                    class="form-control" type="text" *ngIf="i != 0" />

                                  <a *ngIf="i != 0 && !viewMode" class="btn btn-danger btn-sm mt-3"
                                    (click)="deleteSellingPoint(i)">
                                    <i class="fas fa-trash-alt"></i>
                                  </a>
                                </td>
                                <td [formGroupName]="i">
                                  <input class="form-control" type="text" formControlName="overall" mask="separator.2"
                                    step="0.01" thousandSeparator="," [readonly]="true" />
                                </td>
                                <td [formGroupName]="i" *ngFor="let column of YearTable_capex;let j = index">
                                  <input class="form-control" (change)="ChangingValue($event.target.value)"
                                    formControlName="y{{ j + 1 }}" [readonly]="column.isEdit" mask="separator.2"
                                    step="0.01" thousandSeparator="," />
                                </td>
                              </tr>
                            </tbody>
                            <tfoot>
                              <tr>
                                <td>
                                  <label for="finishDate">
                                    Total Million Baht
                                  </label>
                                </td>
                                <td>
                                  <input class="form-control" type="text" [readonly]="true" mask="separator.2"
                                    thousandSeparator="," formControlName="AnnualTotal_overall" />
                                </td>
                                <td *ngFor="let column of YearTable_capex;let j = index">
                                  <input class="form-control" type="text" [readonly]="true" mask="separator.2"
                                    thousandSeparator="," formControlName="AnnualTotal{{ j + 1 }}" />
                                </td>
                              </tr>
                            </tfoot>
                          </table>
                        </div>
                      </div>
                      <!-- </div> -->
                    </div>
                  </div>
                </div>
              </div>
              <!-- </div> -->

              <div *ngIf="status != 'Submit' && !viewMode">
                <button type="button" class="btn btn-primary mt-3" (click)="addSellingPoint()">
                  Add New
                </button>
              </div>
            </div>

            <!-- <div *ngIf="RequestIniNoDate != null"> -->
            <div *ngFor="let ym of year_m; let i = index">
              <form *ngIf="i == 0" [formGroup]="monthForm0">
                <div class="row mt-5">
                  <div class="col-md-11">
                    <h4>Monthly Investment Plan ({{ ym }})</h4>
                    <hr />
                  </div>
                  <div class="col-md-1">
                    <button class="btn btn-info" data-toggle="collapse" data-target="#M1">
                      +
                    </button>
                  </div>
                </div>

                <div class="container collapse" id="M1">
                  <div class="row">
                    <div class="col-md-12">
                      <div class="card text card-initiative">
                        <div class="form-initiative">
                          <div class="form-row align-items-center">
                            <div class="w-100">
                              <div class="table-responsive">
                                <table class="table table-bordered">
                                  <thead class="text-center bg-light">
                                    <tr>
                                      <th width="200px">Investment Plan</th>
                                      <th width="180px">Overall</th>
                                      <th width="180px" *ngFor="let m of monthList_1">
                                        {{ m.columnname }}
                                      </th>
                                    </tr>
                                  </thead>
                                  <tbody *ngFor="let cd of monthForm0_.controls;let j = index">
                                    <tr formArrayName="monthForm_list">
                                      <td [formGroupName]="j">
                                        <select class="form-control" formControlName="currencyTitle"
                                          disabled="flagFirst_row">
                                          <option *ngFor="let t of currencyMountList" [value]="t.currencyValue">
                                            {{ t.currencyName }}
                                          </option>
                                        </select>
                                        <label class="mt-3" for="finishDate" *ngIf="j != 0">
                                          FX
                                        </label>
                                        <input formControlName="fx" class="form-control" type="text" *ngIf="j != 0"
                                          readonly="true" />
                                      </td>
                                      <td [formGroupName]="j">
                                        <input class="form-control" type="text" formControlName="overall"
                                          mask="separator.2" thousandSeparator="," [readonly]="true" />
                                      </td>
                                      <td [formGroupName]="j" *ngFor="let column of monthList_1;let jj = index">
                                        <input *ngIf="cd.get('flag_alert').value == true"
                                          class="form-control ; border-danger" formControlName="m{{ jj + 1 }}"
                                          [readonly]="column.readOnly" (change)="ChangingValue_month_table1(ym)"
                                          (keypress)="keyPress($event)" type="text" pattern="[0-9]*" mask="separator"
                                          thousandSeparator="," value="" />
                                        <input *ngIf="cd.get('flag_alert').value == false" class="form-control"
                                          formControlName="m{{ jj + 1 }}" [readonly]="column.readOnly"
                                          (change)="ChangingValue_month_table1(ym)" (keypress)="keyPress($event)"
                                          type="text" pattern="[0-9]*" mask="separator" thousandSeparator="," />
                                      </td>
                                    </tr>
                                  </tbody>
                                  <tfoot>
                                    <tr>
                                      <td>
                                        <label for="finishDate">
                                          Total Baht
                                        </label>
                                      </td>
                                      <td>
                                        <input class="form-control" type="text" [readonly]="true"
                                          formControlName="monthTotal_overall" mask="separator.2"
                                          thousandSeparator="," />
                                      </td>
                                      <td *ngFor="let column of monthList_1;let j = index">
                                        <input class="form-control" type="text" [readonly]="true"
                                          formControlName="monthTotal{{j + 1}}" mask="separator.2"
                                          thousandSeparator="," />
                                      </td>
                                    </tr>
                                  </tfoot>
                                </table>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </form>

              <form *ngIf="i == 1" [formGroup]="monthForm1">
                <div class="row mt-5">
                  <div class="col-md-11">
                    <h4>Monthly Investment Plan ({{ ym }})</h4>
                    <hr />
                  </div>
                  <div class="col-md-1">
                    <button class="btn btn-info" data-toggle="collapse" data-target="#M2">
                      +
                    </button>
                  </div>
                </div>

                <div class="container collapse" id="M2">
                  <div class="row">
                    <div class="col-md-12">
                      <div class="card text card-initiative">
                        <div class="form-initiative">
                          <div class="form-row align-items-center">
                            <div class="w-100">
                              <div class="table-responsive">
                                <table class="table table-bordered">
                                  <thead class="text-center bg-light">
                                    <tr>
                                      <th width="200px">Investment Plan</th>
                                      <th width="180px">Overall</th>

                                      <ng-container *ngIf="i != diffYear">
                                        <th width="180px" *ngFor="let m of monthList_x">
                                          {{ m.columnname }}
                                        </th>
                                      </ng-container>
                                      <ng-container *ngIf="i == diffYear">
                                        <th width="180px" *ngFor="let m of monthList_last">
                                          {{ m.columnname }}
                                        </th>
                                      </ng-container>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    <tr formArrayName="monthForm_list"
                                      *ngFor="let cd of monthForm1_.controls;let j = index">
                                      <td [formGroupName]="j">
                                        <select class="form-control" formControlName="currencyTitle"
                                          disabled="flagFirst_row">
                                          <option *ngFor="let t of typeTransaction_month" [value]="t.code">
                                            {{ t.chooes }}
                                          </option>
                                        </select>
                                        <label class="mt-3" for="finishDate" *ngIf="j != 0">
                                          FX
                                        </label>
                                        <input formControlName="fx" class="form-control" type="text" *ngIf="j != 0"
                                          readonly="true" />
                                      </td>
                                      <td [formGroupName]="j">
                                        <input class="form-control" type="text" formControlName="overall"
                                          [readonly]="true" mask="separator.2" thousandSeparator="," />
                                      </td>
                                      <ng-container *ngIf="i != diffYear">
                                        <td [formGroupName]="j" *ngFor="let column of monthList_x;let jj = index ">
                                          <input *ngIf="cd.get('flag_alert').value == true"
                                            class="form-control ; border-danger" formControlName="m{{ jj + 1 }}"
                                            [readonly]="column.readOnly" (change)="ChangingValue_month_table2(ym)"
                                            (keypress)="keyPress($event)" type="text" pattern="[0-9]*" pattern="[0-9]*"
                                            mask="separator" thousandSeparator="," />
                                          <input *ngIf="cd.get('flag_alert').value == false" class="form-control"
                                            formControlName="m{{ jj + 1 }}" [readonly]="column.readOnly"
                                            (change)="ChangingValue_month_table2(ym)" (keypress)="keyPress($event)"
                                            type="text" pattern="[0-9]*" pattern="[0-9]*" mask="separator"
                                            thousandSeparator="," />
                                        </td>
                                      </ng-container>
                                      <ng-container *ngIf="i == diffYear">
                                        <td [formGroupName]="j" *ngFor="let column of monthList_last;let jj = index">
                                          <input *ngIf="cd.get('flag_alert').value == true"
                                            class="form-control ; border-danger" formControlName="m{{ jj + 1 }}"
                                            [readonly]="column.readOnly" (change)="ChangingValue_month_table2(ym)"
                                            (keypress)="keyPress($event)" type="text" pattern="[0-9]*" mask="separator"
                                            thousandSeparator="," />
                                          <input *ngIf="cd.get('flag_alert').value == false" class="form-control"
                                            formControlName="m{{ jj + 1 }}" [readonly]="column.readOnly"
                                            (change)="ChangingValue_month_table2(ym)" (keypress)="keyPress($event)"
                                            type="text" pattern="[0-9]*" mask="separator" thousandSeparator="," />
                                        </td>
                                      </ng-container>
                                    </tr>
                                  </tbody>
                                  <tfoot>
                                    <tr>
                                      <td>
                                        <label for="finishDate">
                                          Total Baht
                                        </label>
                                      </td>
                                      <td>
                                        <input class="form-control" type="text" [readonly]="true"
                                          formControlName="monthTotal_overall" mask="separator.2"
                                          thousandSeparator="," />
                                      </td>
                                      <td *ngFor="let column of monthList_1;let j = index">
                                        <input class="form-control" type="text" [readonly]="true"
                                          formControlName="monthTotal{{ j + 1}}" mask="separator.2"
                                          thousandSeparator="," />
                                      </td>
                                    </tr>
                                  </tfoot>
                                </table>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </form>

              <form *ngIf="i == 2" [formGroup]="monthForm2">
                <div class="row mt-5">
                  <div class="col-md-11">
                    <h4>Monthly Investment Plan ({{ ym }})</h4>
                    <hr />
                  </div>
                  <div class="col-md-1">
                    <button class="btn btn-info" data-toggle="collapse" data-target="#M3">
                      +
                    </button>
                  </div>
                </div>

                <div class="container collapse" id="M3">
                  <div class="row">
                    <div class="col-md-12">
                      <div class="card text card-initiative">
                        <div class="form-initiative">
                          <div class="form-row align-items-center">
                            <div class="w-100">
                              <div class="table-responsive">
                                <table class="table table-bordered">
                                  <thead class="text-center bg-light">
                                    <tr>
                                      <th width="200px">Investment Plan</th>
                                      <th width="180px">Overall</th>
                                      <th width="180px" *ngFor="let m of monthList_x">
                                        {{ m.columnname }}
                                      </th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    <tr formArrayName="monthForm_list"
                                      *ngFor="let cd of monthForm2_.controls;let j = index">
                                      <td [formGroupName]="j">
                                        <select class="form-control" formControlName="currencyTitle"
                                          disabled="flagFirst_row">
                                          <option *ngFor="let t of typeTransaction_month" [value]="t.code">
                                            {{ t.chooes }}
                                          </option>
                                        </select>
                                        <label class="mt-3" for="finishDate" *ngIf="j != 0">
                                          FX
                                        </label>
                                        <input formControlName="fx" class="form-control" type="text" *ngIf="j != 0"
                                          readonly="true" />
                                      </td>
                                      <td [formGroupName]="j">
                                        <input class="form-control" type="text" formControlName="overall"
                                          mask="separator.2" thousandSeparator="," [readonly]="true" />
                                      </td>
                                      <ng-container *ngIf="i != diffYear">
                                        <td [formGroupName]="j" *ngFor="let column of monthList_x;let jj = index">
                                          <input *ngIf="cd.get('flag_alert').value == true"
                                            class="form-control ; border-danger" formControlName="m{{ jj + 1 }}"
                                            [readonly]="column.readOnly" (change)="ChangingValue_month_table3(ym)"
                                            (keypress)="keyPress($event)" type="text" pattern="[0-9]*" mask="separator"
                                            thousandSeparator="," />
                                          <input *ngIf="cd.get('flag_alert').value == false" class="form-control"
                                            formControlName="m{{ jj + 1 }}" [readonly]="column.readOnly"
                                            (change)="ChangingValue_month_table3(ym)" (keypress)="keyPress($event)"
                                            type="text" pattern="[0-9]*" mask="separator" thousandSeparator="," />
                                        </td>
                                      </ng-container>
                                      <ng-container *ngIf="i == diffYear">
                                        <td [formGroupName]="j" *ngFor="let column of monthList_last;let jj = index">
                                          <input *ngIf="cd.get('flag_alert').value == true"
                                            class="form-control ; border-danger" formControlName="m{{ jj + 1 }}"
                                            [readonly]="column.readOnly" (change)="ChangingValue_month_table3(ym)"
                                            (keypress)="keyPress($event)" type="text" pattern="[0-9]*" mask="separator"
                                            thousandSeparator="," />
                                          <input *ngIf="cd.get('flag_alert').value == false" class="form-control"
                                            formControlName="m{{ jj + 1 }}" [readonly]="column.readOnly"
                                            (change)="ChangingValue_month_table3(ym)" (keypress)="keyPress($event)"
                                            type="text" pattern="[0-9]*" mask="separator" thousandSeparator="," />
                                        </td>
                                      </ng-container>
                                    </tr>
                                  </tbody>
                                  <tfoot>
                                    <tr>
                                      <td>
                                        <label for="finishDate">
                                          Total Baht
                                        </label>
                                      </td>
                                      <td>
                                        <input class="form-control" type="text" [readonly]="true"
                                          formControlName="monthTotal_overall" mask="separator.2"
                                          thousandSeparator="," />
                                      </td>
                                      <td *ngFor="let column of monthList_1;let j = index">
                                        <input class="form-control" type="text" [readonly]="true"
                                          formControlName="monthTotal{{j + 1}}" mask="separator.2"
                                          thousandSeparator="," />
                                      </td>
                                    </tr>
                                  </tfoot>
                                </table>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </form>

              <form *ngIf="i == 3" [formGroup]="monthForm3">
                <div class="row mt-5">
                  <div class="col-md-11">
                    <h4>Monthly Investment Plan ({{ ym }})</h4>
                    <hr />
                  </div>
                  <div class="col-md-1">
                    <button class="btn btn-info" data-toggle="collapse" data-target="#M4">
                      +
                    </button>
                  </div>
                </div>

                <div class="container collapse" id="M4">
                  <div class="row">
                    <div class="col-md-12">
                      <div class="card text card-initiative">
                        <div class="form-initiative">
                          <div class="form-row align-items-center">
                            <div class="w-100">
                              <div class="table-responsive">
                                <table class="table table-bordered">
                                  <thead class="text-center bg-light">
                                    <tr>
                                      <th width="200px">Investment Plan</th>
                                      <th width="180px">Overall</th>
                                      <th width="180px" *ngFor="let m of monthList_x">
                                        {{ m.columnname }}
                                      </th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    <tr formArrayName="monthForm_list"
                                      *ngFor="let cd of monthForm3_.controls;let j = index">
                                      <td [formGroupName]="j">
                                        <select class="form-control" formControlName="currencyTitle"
                                          disabled="flagFirst_row">
                                          <option *ngFor="let t of typeTransaction_month" [value]="t.code">
                                            {{ t.chooes }}
                                          </option>
                                        </select>
                                        <label class="mt-3" for="finishDate" *ngIf="j != 0">
                                          FX
                                        </label>
                                        <input formControlName="fx" class="form-control" type="text" *ngIf="j != 0"
                                          readonly="true" />
                                      </td>
                                      <td [formGroupName]="j">
                                        <input class="form-control" type="text" formControlName="overall"
                                          mask="separator.2" thousandSeparator="," [readonly]="true" />
                                      </td>
                                      <ng-container *ngIf="i != diffYear">
                                        <td [formGroupName]="j" *ngFor="let column of monthList_x;let jj = index">
                                          <input *ngIf="cd.get('flag_alert').value == true"
                                            class="form-control ; border-danger" formControlName="m{{ jj + 1 }}"
                                            [readonly]="column.readOnly" (change)="ChangingValue_month_table4(ym)"
                                            (keypress)="keyPress($event)" type="text" pattern="[0-9]*" mask="separator"
                                            thousandSeparator="," />
                                          <input *ngIf="cd.get('flag_alert').value == false" class="form-control"
                                            formControlName="m{{ jj + 1 }}" [readonly]="column.readOnly"
                                            (change)="ChangingValue_month_table4(ym)" (keypress)="keyPress($event)"
                                            type="text" pattern="[0-9]*" mask="separator" thousandSeparator="," />
                                        </td>
                                      </ng-container>
                                      <ng-container *ngIf="i == diffYear">
                                        <td [formGroupName]="j" *ngFor="let column of monthList_last;let jj = index">
                                          <input *ngIf="cd.get('flag_alert').value == true"
                                            class="form-control ; border-danger" formControlName="m{{ jj + 1 }}"
                                            [readonly]="column.readOnly" (change)="ChangingValue_month_table4(ym)"
                                            (keypress)="keyPress($event)" type="text" pattern="[0-9]*" mask="separator"
                                            thousandSeparator="," />
                                          <input *ngIf="cd.get('flag_alert').value == false" class="form-control"
                                            formControlName="m{{ jj + 1 }}" [readonly]="column.readOnly"
                                            (change)="ChangingValue_month_table4(ym)" (keypress)="keyPress($event)"
                                            type="text" pattern="[0-9]*" mask="separator" thousandSeparator="," />
                                        </td>
                                      </ng-container>
                                    </tr>
                                  </tbody>
                                  <tfoot>
                                    <tr>
                                      <td>
                                        <label for="finishDate">
                                          Total Baht
                                        </label>
                                      </td>
                                      <td>
                                        <input class="form-control" type="text" [readonly]="true" mask="separator.2"
                                          thousandSeparator="," formControlName="monthTotal_overall" />
                                      </td>
                                      <td *ngFor="let column of monthList_1;let j = index">
                                        <input class="form-control" type="text" [readonly]="true" mask="separator.2"
                                          thousandSeparator="," formControlName="monthTotal{{j + 1}}" />
                                      </td>
                                    </tr>
                                  </tfoot>
                                </table>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </form>

              <form *ngIf="i == 4" [formGroup]="monthForm4">
                <div class="row mt-5">
                  <div class="col-md-11">
                    <h4>Monthly Investment Plan ({{ ym }})</h4>
                    <hr />
                  </div>
                  <div class="col-md-1">
                    <button class="btn btn-info" data-toggle="collapse" data-target="#M5">
                      +
                    </button>
                  </div>
                </div>

                <div class="container collapse" id="M5">
                  <div class="row">
                    <div class="col-md-12">
                      <div class="card text card-initiative">
                        <div class="form-initiative">
                          <div class="form-row align-items-center">
                            <div class="w-100">
                              <div class="table-responsive">
                                <table class="table table-bordered">
                                  <thead class="text-center bg-light">
                                    <tr>
                                      <th width="200px">Investment Plan</th>
                                      <th width="180px">Overall</th>
                                      <th width="180px" *ngFor="let m of monthList_x">
                                        {{ m.columnname }}
                                      </th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    <tr formArrayName="monthForm_list"
                                      *ngFor="let cd of monthForm4_.controls;let j = index">
                                      <td [formGroupName]="j">
                                        <select class="form-control" formControlName="currencyTitle"
                                          disabled="flagFirst_row">
                                          <option *ngFor="let t of typeTransaction_month" [value]="t.code">
                                            {{ t.chooes }}
                                          </option>
                                        </select>
                                        <label class="mt-3" for="finishDate" *ngIf="j != 0">
                                          FX
                                        </label>
                                        <input formControlName="fx" class="form-control" type="text" *ngIf="j != 0"
                                          readonly="true" />
                                      </td>
                                      <td [formGroupName]="j">
                                        <input class="form-control" type="text" formControlName="overall"
                                          mask="separator.2" thousandSeparator="," [readonly]="true" />
                                      </td>
                                      <ng-container *ngIf="i != diffYear">
                                        <td [formGroupName]="j" *ngFor="let column of monthList_x;let jj = index">
                                          <input *ngIf="cd.get('flag_alert').value == true"
                                            class="form-control ; border-danger" formControlName="m{{ jj + 1 }}"
                                            [readonly]="column.readOnly" (change)="ChangingValue_month_table5(ym)"
                                            (keypress)="keyPress($event)" type="text" pattern="[0-9]*" mask="separator"
                                            thousandSeparator="," />
                                          <input *ngIf="cd.get('flag_alert').value == false" class="form-control"
                                            formControlName="m{{ jj + 1 }}" [readonly]="column.readOnly"
                                            (change)="ChangingValue_month_table5(ym)" (keypress)="keyPress($event)"
                                            type="text" pattern="[0-9]*" mask="separator" thousandSeparator="," />
                                        </td>
                                      </ng-container>
                                      <ng-container *ngIf="i == diffYear">
                                        <td [formGroupName]="j" *ngFor="let column of monthList_last;let jj = index">
                                          <input *ngIf="cd.get('flag_alert').value == true"
                                            class="form-control ; border-danger" formControlName="m{{ jj + 1 }}"
                                            [readonly]="column.readOnly" (change)="ChangingValue_month_table5(ym)"
                                            (keypress)="keyPress($event)" type="text" pattern="[0-9]*" mask="separator"
                                            thousandSeparator="," />
                                          <input *ngIf="cd.get('flag_alert').value == false" class="form-control"
                                            formControlName="m{{ jj + 1 }}" [readonly]="column.readOnly"
                                            (change)="ChangingValue_month_table5(ym)" (keypress)="keyPress($event)"
                                            type="text" pattern="[0-9]*" mask="separator" thousandSeparator="," />
                                        </td>
                                      </ng-container>
                                    </tr>
                                  </tbody>
                                  <tfoot>
                                    <tr>
                                      <td>
                                        <label for="finishDate">
                                          Total Baht
                                        </label>
                                      </td>
                                      <td>
                                        <input class="form-control" type="text" [readonly]="true" mask="separator.2"
                                          thousandSeparator="," formControlName="monthTotal_overall" />
                                      </td>
                                      <td *ngFor="let column of monthList_1;let j = index">
                                        <input class="form-control" type="text" [readonly]="true" mask="separator.2"
                                          thousandSeparator="," formControlName="monthTotal{{j + 1}}" />
                                      </td>
                                    </tr>
                                  </tfoot>
                                </table>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </form>

              <form *ngIf="i == 5" [formGroup]="monthForm5">
                <div class="row mt-5">
                  <div class="col-md-11">
                    <h4>Monthly Investment Plan ({{ ym }})</h4>
                    <hr />
                  </div>
                  <div class="col-md-1">
                    <button class="btn btn-info" data-toggle="collapse" data-target="#M6">
                      +
                    </button>
                  </div>
                </div>

                <div class="container collapse" id="M6">
                  <div class="row">
                    <div class="col-md-12">
                      <div class="card text card-initiative">
                        <div class="form-initiative">
                          <div class="form-row align-items-center">
                            <div class="w-100">
                              <div class="table-responsive">
                                <table class="table table-bordered">
                                  <thead class="text-center bg-light">
                                    <tr>
                                      <th width="200px">Investment Plan</th>
                                      <th width="180px">Overall</th>
                                      <th width="180px" *ngFor="let m of monthList_x">
                                        {{ m.columnname }}
                                      </th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    <tr formArrayName="monthForm_list"
                                      *ngFor="let cd of monthForm5_.controls;let j = index">
                                      <td [formGroupName]="j">
                                        <select class="form-control" formControlName="currencyTitle"
                                          disabled="flagFirst_row">
                                          <option *ngFor="let t of typeTransaction_month" [value]="t.code">
                                            {{ t.chooes }}
                                          </option>
                                        </select>
                                        <label class="mt-3" for="finishDate" *ngIf="j != 0">
                                          FX
                                        </label>
                                        <input formControlName="fx" class="form-control" type="text" *ngIf="j != 0"
                                          readonly="true" />
                                      </td>
                                      <td [formGroupName]="j">
                                        <input class="form-control" type="text" formControlName="overall"
                                          mask="separator.2" thousandSeparator="," [readonly]="true" />
                                      </td>
                                      <ng-container *ngIf="i != diffYear">
                                        <td [formGroupName]="j" *ngFor="let column of monthList_x;let jj = index">
                                          <input *ngIf="cd.get('flag_alert').value == true"
                                            class="form-control ; border-danger" formControlName="m{{ jj + 1 }}"
                                            [readonly]="column.readOnly" (change)="ChangingValue_month_table6(ym)"
                                            (keypress)="keyPress($event)" type="text" pattern="[0-9]*" mask="separator"
                                            thousandSeparator="," />
                                          <input *ngIf="cd.get('flag_alert').value == false" class="form-control"
                                            formControlName="m{{ jj + 1 }}" [readonly]="column.readOnly"
                                            (change)="ChangingValue_month_table6(ym)" (keypress)="keyPress($event)"
                                            type="text" pattern="[0-9]*" mask="separator" thousandSeparator="," />
                                        </td>
                                      </ng-container>
                                      <ng-container *ngIf="i == diffYear">
                                        <td [formGroupName]="j" *ngFor="let column of monthList_last;let jj = index">
                                          <input *ngIf="cd.get('flag_alert').value == true"
                                            class="form-control ; border-danger" formControlName="m{{ jj + 1 }}"
                                            [readonly]="column.readOnly" (change)="ChangingValue_month_table6(ym)"
                                            (keypress)="keyPress($event)" type="text" pattern="[0-9]*" mask="separator"
                                            thousandSeparator="," />
                                          <input *ngIf="cd.get('flag_alert').value == false" class="form-control"
                                            formControlName="m{{ jj + 1 }}" [readonly]="column.readOnly"
                                            (change)="ChangingValue_month_table6(ym)" (keypress)="keyPress($event)"
                                            type="text" pattern="[0-9]*" mask="separator" thousandSeparator="," />
                                        </td>
                                      </ng-container>
                                    </tr>
                                  </tbody>
                                  <tfoot>
                                    <tr>
                                      <td>
                                        <label for="finishDate">
                                          Total Baht
                                        </label>
                                      </td>
                                      <td>
                                        <input class="form-control" type="text" [readonly]="true" mask="separator.2"
                                          thousandSeparator="," formControlName="monthTotal_overall" />
                                      </td>
                                      <td *ngFor="let column of monthList_1;let j = index">
                                        <input class="form-control" type="text" [readonly]="true" mask="separator.2"
                                          thousandSeparator="," formControlName="monthTotal{{j + 1}}" />
                                      </td>
                                    </tr>
                                  </tfoot>
                                </table>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </form>

              <form *ngIf="i == 6" [formGroup]="monthForm6">
                <div class="row mt-5">
                  <div class="col-md-11">
                    <h4>Monthly Investment Plan ({{ ym }})</h4>
                    <hr />
                  </div>
                  <div class="col-md-1">
                    <button class="btn btn-info" data-toggle="collapse" data-target="#M7">
                      +
                    </button>
                  </div>
                </div>

                <div class="container collapse" id="M7">
                  <div class="row">
                    <div class="col-md-12">
                      <div class="card text card-initiative">
                        <div class="form-initiative">
                          <div class="form-row align-items-center">
                            <div class="w-100">
                              <div class="table-responsive">
                                <table class="table table-bordered">
                                  <thead class="text-center bg-light">
                                    <tr>
                                      <th width="200px">Investment Plan</th>
                                      <th width="180px">Overall</th>
                                      <th width="180px" *ngFor="let m of monthList_x">
                                        {{ m.columnname }}
                                      </th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    <tr formArrayName="monthForm_list"
                                      *ngFor="let cd of monthForm6_.controls;let j = index">
                                      <td [formGroupName]="j">
                                        <select class="form-control" formControlName="currencyTitle"
                                          disabled="flagFirst_row">
                                          <option *ngFor="let t of typeTransaction_month" [value]="t.code">
                                            {{ t.chooes }}
                                          </option>
                                        </select>
                                        <label class="mt-3" for="finishDate" *ngIf="j != 0">
                                          FX
                                        </label>
                                        <input formControlName="fx" class="form-control" type="text" *ngIf="j != 0"
                                          readonly="true" />
                                      </td>
                                      <td [formGroupName]="j">
                                        <input class="form-control" type="text" formControlName="overall"
                                          mask="separator.2" thousandSeparator="," [readonly]="true" />
                                      </td>
                                      <ng-container *ngIf="i != diffYear">
                                        <td [formGroupName]="j" *ngFor="let column of monthList_x;let jj = index">
                                          <input *ngIf="cd.get('flag_alert').value == true"
                                            class="form-control ; border-danger" formControlName="m{{ jj + 1 }}"
                                            [readonly]="column.readOnly" (change)="ChangingValue_month_table7(ym)"
                                            (keypress)="keyPress($event)" type="text" pattern="[0-9]*" mask="separator"
                                            thousandSeparator="," />
                                          <input *ngIf="cd.get('flag_alert').value == false" class="form-control"
                                            formControlName="m{{ jj + 1 }}" [readonly]="column.readOnly"
                                            (change)="ChangingValue_month_table7(ym)" (keypress)="keyPress($event)"
                                            type="text" pattern="[0-9]*" mask="separator" thousandSeparator="," />
                                        </td>
                                      </ng-container>
                                      <ng-container *ngIf="i == diffYear">
                                        <td [formGroupName]="j" *ngFor="let column of monthList_last;let jj = index">
                                          <input *ngIf="cd.get('flag_alert').value == true"
                                            class="form-control ; border-danger" formControlName="m{{ jj + 1 }}"
                                            [readonly]="column.readOnly" (change)="ChangingValue_month_table7(ym)"
                                            (keypress)="keyPress($event)" type="text" pattern="[0-9]*" mask="separator"
                                            thousandSeparator="," />
                                          <input *ngIf="cd.get('flag_alert').value == false" class="form-control"
                                            formControlName="m{{ jj + 1 }}" [readonly]="column.readOnly"
                                            (change)="ChangingValue_month_table7(ym)" (keypress)="keyPress($event)"
                                            type="text" pattern="[0-9]*" mask="separator" thousandSeparator="," />
                                        </td>
                                      </ng-container>
                                    </tr>
                                  </tbody>
                                  <tfoot>
                                    <tr>
                                      <td>
                                        <label for="finishDate">
                                          Total Baht
                                        </label>
                                      </td>
                                      <td>
                                        <input class="form-control" type="text" [readonly]="true" mask="separator.2"
                                          thousandSeparator="," formControlName="monthTotal_overall" />
                                      </td>
                                      <td *ngFor="let column of monthList_1;let j = index">
                                        <input class="form-control" type="text" [readonly]="true" mask="separator.2"
                                          thousandSeparator="," formControlName="monthTotal{{j + 1}}" />
                                      </td>
                                    </tr>
                                  </tfoot>
                                </table>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </form>

              <form *ngIf="i == 7" [formGroup]="monthForm7">
                <div class="row mt-5">
                  <div class="col-md-11">
                    <h4>Monthly Investment Plan ({{ ym }})</h4>
                    <hr />
                  </div>
                  <div class="col-md-1">
                    <button class="btn btn-info" data-toggle="collapse" data-target="#M8">
                      +
                    </button>
                  </div>
                </div>

                <div class="container collapse" id="M8">
                  <div class="row">
                    <div class="col-md-12">
                      <div class="card text card-initiative">
                        <div class="form-initiative">
                          <div class="form-row align-items-center">
                            <div class="w-100">
                              <div class="table-responsive">
                                <table class="table table-bordered">
                                  <thead class="text-center bg-light">
                                    <tr>
                                      <th width="200px">Investment Plan</th>
                                      <th width="180px">Overall</th>
                                      <th width="180px" *ngFor="let m of monthList_x">
                                        {{ m.columnname }}
                                      </th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    <tr formArrayName="monthForm_list"
                                      *ngFor="let cd of monthForm7_.controls;let j = index">
                                      <td [formGroupName]="j">
                                        <select class="form-control" formControlName="currencyTitle"
                                          disabled="flagFirst_row">
                                          <option *ngFor="let t of typeTransaction_month" [value]="t.code">
                                            {{ t.chooes }}
                                          </option>
                                        </select>
                                        <label class="mt-3" for="finishDate" *ngIf="j != 0">
                                          FX
                                        </label>
                                        <input formControlName="fx" class="form-control" type="text" *ngIf="j != 0"
                                          readonly="true" />
                                      </td>
                                      <td [formGroupName]="j">
                                        <input class="form-control" type="text" formControlName="overall"
                                          mask="separator.2" thousandSeparator="," [readonly]="true" />
                                      </td>
                                      <ng-container *ngIf="i != diffYear">
                                        <td [formGroupName]="j" *ngFor="let column of monthList_x;let jj = index">
                                          <input *ngIf="cd.get('flag_alert').value == true"
                                            class="form-control ; border-danger" formControlName="m{{ jj + 1 }}"
                                            [readonly]="column.readOnly" (change)="ChangingValue_month_table8(ym)"
                                            (keypress)="keyPress($event)" type="text" pattern="[0-9]*" mask="separator"
                                            thousandSeparator="," />
                                          <input *ngIf="cd.get('flag_alert').value == false" class="form-control"
                                            formControlName="m{{ jj + 1 }}" [readonly]="column.readOnly"
                                            (change)="ChangingValue_month_table8(ym)" (keypress)="keyPress($event)"
                                            type="text" pattern="[0-9]*" mask="separator" thousandSeparator="," />
                                        </td>
                                      </ng-container>
                                      <ng-container *ngIf="i == diffYear">
                                        <td [formGroupName]="j" *ngFor="let column of monthList_last;let jj = index">
                                          <input *ngIf="cd.get('flag_alert').value == true"
                                            class="form-control ; border-danger" formControlName="m{{ jj + 1 }}"
                                            [readonly]="column.readOnly" (change)="ChangingValue_month_table8(ym)"
                                            (keypress)="keyPress($event)" type="text" pattern="[0-9]*" mask="separator"
                                            thousandSeparator="," />
                                          <input *ngIf="cd.get('flag_alert').value ==false" class="form-control"
                                            formControlName="m{{ jj + 1 }}" [readonly]="column.readOnly"
                                            (change)="ChangingValue_month_table8(ym)" (keypress)="keyPress($event)"
                                            type="text" pattern="[0-9]*" mask="separator" thousandSeparator="," />
                                        </td>
                                      </ng-container>
                                    </tr>
                                  </tbody>
                                  <tfoot>
                                    <tr>
                                      <td>
                                        <label for="finishDate">
                                          Total Baht
                                        </label>
                                      </td>
                                      <td>
                                        <input class="form-control" type="text" [readonly]="true" mask="separator.2"
                                          thousandSeparator="," formControlName="monthTotal_overall" />
                                      </td>
                                      <td *ngFor="let column of monthList_1;let j = index">
                                        <input class="form-control" type="text" [readonly]="true" mask="separator.2"
                                          thousandSeparator="," formControlName="monthTotal{{j + 1}}" />
                                      </td>
                                    </tr>
                                  </tfoot>
                                </table>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </form>

              <form *ngIf="i == 8" [formGroup]="monthForm8">
                <div class="row mt-5">
                  <div class="col-md-11">
                    <h4>Monthly Investment Plan ({{ ym }})</h4>
                    <hr />
                  </div>
                  <div class="col-md-1">
                    <button class="btn btn-info" data-toggle="collapse" data-target="#M9">
                      +
                    </button>
                  </div>
                </div>

                <div class="container collapse" id="M9">
                  <div class="row">
                    <div class="col-md-12">
                      <div class="card text card-initiative">
                        <div class="form-initiative">
                          <div class="form-row align-items-center">
                            <div class="w-100">
                              <div class="table-responsive">
                                <table class="table table-bordered">
                                  <thead class="text-center bg-light">
                                    <tr>
                                      <th width="200px">Investment Plan</th>
                                      <th width="180px">Overall</th>
                                      <th width="180px" *ngFor="let m of monthList_x">
                                        {{ m.columnname }}
                                      </th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    <tr formArrayName="monthForm_list"
                                      *ngFor="let cd of monthForm8_.controls;let j = index">
                                      <td [formGroupName]="j">
                                        <select class="form-control" formControlName="currencyTitle"
                                          disabled="flagFirst_row">
                                          <option *ngFor="let t of typeTransaction_month" [value]="t.code">
                                            {{ t.chooes }}
                                          </option>
                                        </select>
                                        <label class="mt-3" for="finishDate" *ngIf="j != 0">
                                          FX
                                        </label>
                                        <input formControlName="fx" class="form-control" type="text" *ngIf="j != 0"
                                          readonly="true" />
                                      </td>
                                      <td [formGroupName]="j">
                                        <input class="form-control" type="text" formControlName="overall"
                                          mask="separator.2" thousandSeparator="," [readonly]="true" />
                                      </td>
                                      <ng-container *ngIf="i != diffYear">
                                        <td [formGroupName]="j" *ngFor="let column of monthList_x;let jj = index">
                                          <input *ngIf="cd.get('flag_alert').value ==true"
                                            class="form-control ; border-danger" formControlName="m{{ jj + 1 }}"
                                            [readonly]="column.readOnly" (change)="ChangingValue_month_table9(ym)"
                                            (keypress)="keyPress($event)" type="text" pattern="[0-9]*" mask="separator"
                                            thousandSeparator="," />
                                          <input *ngIf="cd.get('flag_alert').value == false" class="form-control"
                                            formControlName="m{{ jj + 1 }}" [readonly]="column.readOnly"
                                            (change)="ChangingValue_month_table9(ym)" (keypress)="keyPress($event)"
                                            type="text" pattern="[0-9]*" mask="separator" thousandSeparator="," />
                                        </td>
                                      </ng-container>
                                      <ng-container *ngIf="i == diffYear">
                                        <td [formGroupName]="j" *ngFor="let column of monthList_last;let jj = index">
                                          <input *ngIf="cd.get('flag_alert').value ==true"
                                            class="form-control ; border-danger" formControlName="m{{ jj + 1 }}"
                                            [readonly]="column.readOnly" (change)="ChangingValue_month_table9(ym)"
                                            (keypress)="keyPress($event)" type="text" pattern="[0-9]*" mask="separator"
                                            thousandSeparator="," />
                                          <input *ngIf="cd.get('flag_alert').value ==false" class="form-control"
                                            formControlName="m{{ jj + 1 }}" [readonly]="column.readOnly"
                                            (change)="ChangingValue_month_table9(ym)" (keypress)="keyPress($event)"
                                            type="text" pattern="[0-9]*" mask="separator" thousandSeparator="," />
                                        </td>
                                      </ng-container>
                                    </tr>
                                  </tbody>
                                  <tfoot>
                                    <tr>
                                      <td>
                                        <label for="finishDate">
                                          Total Baht
                                        </label>
                                      </td>
                                      <td *ngFor="let column of monthList_1;let j = index">
                                        <input class="form-control" type="text" [readonly]="true" mask="separator.2"
                                          thousandSeparator="," formControlName="monthTotal{{j + 1}}" />
                                      </td>
                                      <td>
                                        <input class="form-control" type="text" [readonly]="true" mask="separator.2"
                                          thousandSeparator="," formControlName="monthTotal_overall" />
                                      </td>
                                    </tr>
                                  </tfoot>
                                </table>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </form>

              <form *ngIf="i == 9" [formGroup]="monthForm9">
                <div class="row mt-5">
                  <div class="col-md-11">
                    <h4>Monthly Investment Plan ({{ ym }})</h4>
                    <hr />
                  </div>
                  <div class="col-md-1">
                    <button class="btn btn-info" data-toggle="collapse" data-target="#M10">
                      +
                    </button>
                  </div>
                </div>

                <div class="container collapse" id="M10">
                  <div class="row">
                    <div class="col-md-12">
                      <div class="card text card-initiative">
                        <div class="form-initiative">
                          <div class="form-row align-items-center">
                            <div class="w-100">
                              <div class="table-responsive">
                                <table class="table table-bordered">
                                  <thead class="text-center bg-light">
                                    <tr>
                                      <th width="200px">Investment Plan</th>
                                      <th width="180px">Overall</th>
                                      <th width="180px" *ngFor="let m of monthList_x">
                                        {{ m.columnname }}
                                      </th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    <tr formArrayName="monthForm_list"
                                      *ngFor="let cd of monthForm9_.controls;let j = index">
                                      <td [formGroupName]="j">
                                        <select class="form-control" formControlName="currencyTitle"
                                          disabled="flagFirst_row">
                                          <option *ngFor="let t of typeTransaction_month" [value]="t.code">
                                            {{ t.chooes }}
                                          </option>
                                        </select>
                                        <label class="mt-3" for="finishDate" *ngIf="j != 0">
                                          FX
                                        </label>
                                        <input formControlName="fx" class="form-control" type="text" *ngIf="j != 0"
                                          readonly="true" />
                                      </td>

                                      <td [formGroupName]="j">
                                        <input class="form-control" type="text" formControlName="overall"
                                          mask="separator.2" thousandSeparator="," [readonly]="true" />
                                      </td>
                                      <ng-container *ngIf="i != diffYear">
                                        <td [formGroupName]="j" *ngFor="let column of monthList_x;let jj = index">
                                          <input *ngIf="cd.get('flag_alert').value ==true"
                                            class="form-control ; border-danger" formControlName="m{{ jj + 1 }}"
                                            [readonly]="column.readOnly" (change)="ChangingValue_month_table10(ym)"
                                            (keypress)="keyPress($event)" type="text" pattern="[0-9]*" mask="separator"
                                            thousandSeparator="," />
                                          <input *ngIf="cd.get('flag_alert').value ==false" class="form-control"
                                            formControlName="m{{ jj + 1 }}" [readonly]="column.readOnly"
                                            (change)="ChangingValue_month_table10(ym)" (keypress)="keyPress($event)"
                                            type="text" pattern="[0-9]*" mask="separator" thousandSeparator="," />
                                        </td>
                                      </ng-container>
                                      <ng-container *ngIf="i == diffYear">
                                        <td [formGroupName]="j" *ngFor="let column of monthList_last;let jj = index">
                                          <input *ngIf="cd.get('flag_alert').value ==true"
                                            class="form-control ; border-danger" formControlName="m{{ jj + 1 }}"
                                            [readonly]="column.readOnly" (change)="ChangingValue_month_table10(ym)"
                                            (keypress)="keyPress($event)" type="test" pattern="[0-9]*" mask="separator"
                                            thousandSeparator="," />
                                          <input *ngIf="cd.get('flag_alert').value ==false" class="form-control"
                                            formControlName="m{{ jj + 1 }}" [readonly]="column.readOnly"
                                            (change)="ChangingValue_month_table10(ym)" (keypress)="keyPress($event)"
                                            type="text" pattern="[0-9]*" mask="separator" thousandSeparator="," />
                                        </td>
                                      </ng-container>
                                    </tr>
                                  </tbody>
                                  <tfoot>
                                    <tr>
                                      <td>
                                        <label for="finishDate">
                                          Total Baht
                                        </label>
                                      </td>
                                      <td>
                                        <input class="form-control" type="text" [readonly]="true" mask="separator.2"
                                          thousandSeparator="," formControlName="monthTotal_overall" />
                                      </td>
                                      <td *ngFor="let column of monthList_1;let j = index">
                                        <input class="form-control" type="text" [readonly]="true" mask="separator.2"
                                          thousandSeparator="," formControlName="monthTotal{{j + 1}}" />
                                      </td>
                                    </tr>
                                  </tfoot>
                                </table>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </form>
            </div>
            <!-- </div> -->
          </ng-container>

          <!-- End Table -->
        </form>

        <br />
        <br />
        <br />
        <div *ngIf="!viewMode" class="row mt-5 d-none">
          <div class="col-md-12">
            <button class="btn btn-success">Attach files/View files</button>
          </div>
        </div>

        <div class="row mt-5 d-none">
          <div class="col-sm-12 col-md-6">
            <span>Total Million Baht </span>
            <select class="form-control mt-2">
              <option value="Million Baht">Choose ...</option>
              <option></option>
            </select>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>