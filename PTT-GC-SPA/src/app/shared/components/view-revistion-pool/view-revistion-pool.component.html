<!-- <div *ngIf="PoolView">
  <app-initiative-box></app-initiative-box>
</div> -->
<!-- <div bsModal #AttachmentModal="bs-modal" class="modal fade modal-Attachment d-none" [config]="{ backdrop: 'static' }">
  <app-initiative-attachment (modelClose)="CloseAttachment()" [id]="id"></app-initiative-attachment>
</div> -->

<tabset #poolTabs class="d-none">
  <tab heading="General Information" (selectTab)="changeTab($event)" class="d-none">
    <div class="form-group row mt-5">
      <div class="col-md-12">
        <h3>{{ name }}</h3>
        <hr />
      </div>
    </div>
    <form [formGroup]="PoolForm">
      <div class="row">
        <div class="col-md-12">
          <div class="card text card-initiative">
            <div class="card-body">
              <div class="form-initiative">
                <div class="form-group row">
                  <div class="col-md-6">
                    <label for="name">
                      Initiative Name <span class="text-danger">*</span> :
                    </label>
                    <input formControlName="name" type="text" class="form-control"
                      [ngClass]="{ 'is-invalid': invalidName }" />
                    <div class="invalid-feedback" *ngIf="invalidName">
                      Initiative Name is required !
                    </div>
                  </div>
                </div>
                <div class="form-group row">
                  <div class="col-md-6">
                    <label for="OwnerName">
                      Owner Name <span class="text-danger">*</span> :
                    </label>
                    <ng-select formControlName="ownerName" [items]="owners" bindValue="ownerName" bindLabel="ownerName"
                      placeholder="Choose Owner" (search)="SearchOwnerName($event)" (clear)="ClearOwnerName()" required>
                    </ng-select>
                    <div class="text-feedback" *ngIf="invalidOwnerName">
                      OwnerName is required !
                    </div>
                  </div>
                  <div class="col-md-6">
                    <label for="RequestPool"> Request Pool : </label>
                    <select formControlName="poolType" class="form-control"
                      [ngClass]="{ 'is-invalid': invalidPoolType }">
                      <option value="" selected disabled> Choose .. </option>
                      <option value="Digital CAPEX"> Digital CAPEX </option>
                      <option value="IT CAPEX"> IT CAPEX </option>
                      <option value="PIM"> PIM </option>
                      <option value="MAX"> MAX </option>
                      <option value="ER"> ER </option>
                      <option value="MTPi"> MTPi </option>
                    </select>
                    <div class="text-feedback" *ngIf="invalidPoolType">
                      Request Pool is required !
                    </div>
                  </div>
                </div>
                <div class="form-group row">
                  <div class="col-md-6">
                    <label for="company">
                      Company <span class="text-danger">*</span> :
                    </label>
                    <ng-select formControlName="company" [items]="companyName" bindValue="companyName"
                      bindLabel="companyName" placeholder="Choose Company" required></ng-select>
                    <div class="text-feedback" *ngIf="invalidCompany">
                      Company is required !
                    </div>
                  </div>
                  <div class="col-md-6">
                    <label for="organization">
                      Organization (Asset Owner)
                      <span class="text-danger">*</span> :
                    </label>
                    <ng-select formControlName="organization" [items]="organizations" bindValue="organizationTitle"
                      bindLabel="organizationTitle" placeholder="Choose Organization" required></ng-select>
                    <div class="text-feedback" *ngIf="invalidOrganization">
                      Organization (Asset Owner) is required !
                    </div>
                  </div>
                </div>
                <div class="form-group row">
                  <div class="col-md-6">
                    <label for="plant">
                      Plant <span class="text-danger">*</span> :
                    </label>
                    <ng-select formControlName="plant" [items]="plants" bindValue="plantId" bindLabel="plantTitle"
                      placeholder="Choose Plant" required></ng-select>
                    <div class="text-feedback" *ngIf="invalidPlant">
                      Plant is required !
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </form>
  </tab>

  <tab heading="Detail Information" (selectTab)="changeTab($event)" class="d-none">
    <div class="form-group row mt-5">
      <div class="col-md-12">
        <h3>Detail Information</h3>
        <hr />
      </div>
    </div>
    <form [formGroup]="DetailForm">
      <div class="bg-light">
        <div id="Investment">
          <div class="card-header">
            <button class="btn btn-link btn-co text-dark" type="button" data-toggle="collapse"
              data-target="#collapseInvestment" aria-expanded="true">
              <div class="float-left">Investment Framework</div>
              <i class="fas fa-chevron-circle-down float-right"></i>
            </button>
          </div>
          <div id="collapseInvestment" class="collapse bg-white" aria-labelledby="headingOne" data-parent="#Investment">
            <div class="card-body">
              <div class="form-group row">
                <div class="col-md-3">
                  <label for="production">
                    Production Process of Project , List of equipment & Leadtime
                  </label>
                </div>
                <div class="col-md-9">
                  <textarea class="form-control" formControlName="productionProcess" rows="2"></textarea>
                </div>
              </div>
              <div class="form-group row">
                <div class="col-md-3">
                  <label for="production"> Milestone & Schedule </label>
                </div>
                <div class="col-md-9">
                  <textarea class="form-control" formControlName="milestoneSchedule" rows="2"></textarea>
                </div>
              </div>
              <div class="form-group row">
                <div class="col-md-3">
                  <label for="production"> Expected Target &Result </label>
                </div>
                <div class="col-md-9">
                  <textarea class="form-control" formControlName="expectedTarget" rows="2"></textarea>
                </div>
              </div>
              <div class="form-group row">
                <div class="col-md-3">
                  <label for="comparison">
                    Comparison with other alternative</label>
                </div>
                <div class="col-md-9">
                  <textarea class="form-control" formControlName="comparisonWithOther" rows="2"></textarea>
                </div>
              </div>
              <div class="form-group row">
                <div class="col-md-3">
                  <label for="production">
                    Other resources needed to support the project: (Personnel,
                    IT, Others)
                  </label>
                </div>
                <div class="col-md-9">
                  <textarea class="form-control" formControlName="otherResources" rows="2"></textarea>
                </div>
              </div>
              <div class="form-group row">
                <div class="col-md-3">
                  <label for="other"> Other </label>
                </div>
                <div class="col-md-9">
                  <textarea class="form-control" formControlName="otherInvestment" rows="2"></textarea>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div id="strategic">
          <div class="card-header">
            <button class="btn btn-link btn-co text-dark" type="button" data-toggle="collapse"
              data-target="#collapseStrategic" aria-expanded="true">
              <div class="float-left">
                Strategic Analysis
              </div>
              <i class="fas fa-chevron-circle-down float-right"></i>
            </button>
          </div>
          <div id="collapseStrategic" class="collapse bg-white" aria-labelledby="headingOne" data-parent="#strategic">
            <div class="card-body">
              <div class="form-group row">
                <div class="col-md-3">
                  <label for="consistent">
                    Consistent with company's strategy
                  </label>
                </div>
                <div class="col-md-9">
                  <textarea class="form-control" formControlName="consistent" rows="2"></textarea>
                </div>
              </div>
              <div class="form-group row">
                <div class="col-md-3">
                  <label for="keySuccess"> Key Success Factor </label>
                </div>
                <div class="col-md-9">
                  <textarea class="form-control" formControlName="keySuccessFactor" rows="2"></textarea>
                </div>
              </div>
              <div class="form-group row">
                <div class="col-md-3">
                  <label for="synergyBenefit"> Synergy Benefit</label>
                </div>
                <div class="col-md-9">
                  <textarea class="form-control" formControlName="synergyBenefit" rows="2"></textarea>
                </div>
              </div>
              <div class="form-group row">
                <div class="col-md-3">
                  <label for="other"> Other </label>
                </div>
                <div class="col-md-9">
                  <textarea class="form-control" formControlName="otherStrategic" rows="2"></textarea>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div id="business">
          <div class="card-header">
            <button class="btn btn-link btn-co text-dark" type="button" data-toggle="collapse"
              data-target="#collapseBusiness" aria-expanded="true">
              <div class="float-left">
                Business Analysis
              </div>
              <i class="fas fa-chevron-circle-down float-right"></i>
            </button>
          </div>
          <div id="collapseBusiness" class="collapse bg-white" aria-labelledby="headingOne" data-parent="#business">
            <div class="card-body">
              <div class="form-group row">
                <div class="col-md-3">
                  <label for="marketOverview"> Market overview</label>
                </div>
                <div class="col-md-9">
                  <textarea class="form-control" formControlName="marketOverview" rows="2"></textarea>
                </div>
              </div>
              <div class="form-group row">
                <div class="col-md-3">
                  <label for="potentialCustomer"> Potential Customer</label>
                </div>
                <div class="col-md-9">
                  <textarea class="form-control" formControlName="potentialCustomer" rows="2"></textarea>
                </div>
              </div>
              <div class="form-group row">
                <div class="col-md-3">
                  <label for="salesPain"> Sales Plan </label>
                </div>
                <div class="col-md-9">
                  <textarea class="form-control" formControlName="salesPlan" rows="2"></textarea>
                </div>
              </div>
              <div class="form-group row">
                <div class="col-md-3">
                  <label for="sourceOfFeedback"> Source of Feedback </label>
                </div>
                <div class="col-md-9">
                  <textarea class="form-control" formControlName="sourceOfFeedback" rows="2"></textarea>
                </div>
              </div>
              <div class="form-group row">
                <div class="col-md-3">
                  <label for="other"> Other </label>
                </div>
                <div class="col-md-9">
                  <textarea class="form-control" formControlName="otherBusiness" rows="2"></textarea>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div id="quality">
          <div class="card-header">
            <button class="btn btn-link btn-co text-dark" type="button" data-toggle="collapse"
              data-target="#collapseQuality" aria-expanded="true">
              <div class="float-left">
                Quality Index
              </div>
              <i class="fas fa-chevron-circle-down float-right"></i>
            </button>
          </div>
          <div id="collapseQuality" class="collapse bg-white" aria-labelledby="headingOne" data-parent="#quality">
            <div class="card-body">
              <div class="form-group row">
                <div class="col-md-3">
                  <label for="safetyIndex"> Safety index</label>
                </div>
                <div class="col-md-9">
                  <textarea class="form-control" formControlName="safetyIndex" rows="2"></textarea>
                </div>
              </div>
              <div class="form-group row">
                <div class="col-md-3">
                  <label for="CorporateImageIndex">
                    Corporate image index</label>
                </div>
                <div class="col-md-9">
                  <textarea class="form-control" formControlName="corporateImageIndex" rows="2"></textarea>
                </div>
              </div>
              <div class="form-group row">
                <div class="col-md-3">
                  <label for="other"> Other </label>
                </div>
                <div class="col-md-9">
                  <textarea class="form-control" formControlName="otherQuality" rows="2"></textarea>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div id="return">
          <div class="card-header">
            <button class="btn btn-link btn-co text-dark" type="button" data-toggle="collapse"
              data-target="#collapseReturn" aria-expanded="true">
              <div class="float-left">
                Return of Investment
              </div>
              <i class="fas fa-chevron-circle-down float-right"></i>
            </button>
          </div>
          <div id="collapseReturn" class="collapse bg-white" aria-labelledby="headingOne" data-parent="#return">
            <div class="card-body">
              <div class="form-group row">
                <div class="col-md-12">
                  <label for="baseCase">
                    Base Case (Please specify assumption)
                    <span class="text-danger">*</span></label>
                  <textarea class="form-control" formControlName="baseCase" rows="2"></textarea>
                </div>
              </div>
              <div class="form-group row">
                <div class="col-md-3">
                  <label for="projectIrrBaseCase">
                    Project IRR(%) <span class="text-danger">*</span></label>
                  <input class="form-control" type="number" formControlName="projectIrrBaseCase" />
                </div>
                <div class="col-md-3">
                  <label for="npvBaseCase">
                    NPV (M THB) <span class="text-danger">*</span></label>
                  <input class="form-control" type="number" formControlName="npvBaseCase" />
                </div>
                <div class="col-md-3">
                  <label for="paybackBaseCase">
                    Payback(Year) <span class="text-danger">*</span></label>
                  <input class="form-control" type="number" formControlName="paybackBaseCase" />
                </div>
                <div class="col-md-3">
                  <label for="ebitdaUpLiftBaseCase">
                    EBITDA Uplift ( M.THB)
                    <span class="text-danger">*</span></label>
                  <input class="form-control" type="number" formControlName="ebitdaBaseCase" />
                </div>
              </div>
              <br />
              <hr />
              <br />
              <div class="form-group row">
                <div class="col-md-12">
                  <label for="optimisticCase">
                    Optimistic Case (Please specify assumption)
                  </label>
                  <textarea class="form-control" formControlName="optimisticCase" rows="2"></textarea>
                </div>
              </div>
              <div class="form-group row">
                <div class="col-md-3">
                  <label for="projectIrrOptimisticCase">
                    Project IRR(%)
                  </label>
                  <input class="form-control" type="number" formControlName="projectIrrOptimisticCase" />
                </div>
                <div class="col-md-3">
                  <label for="npvOptimisticCase"> NPV (M THB) </label>
                  <input class="form-control" type="number" formControlName="npvOptimisticCase" />
                </div>
                <div class="col-md-3">
                  <label for="paybackOptimisticCase"> Payback(Year) </label>
                  <input class="form-control" type="number" formControlName="paybackOptimisticCase" />
                </div>
                <div class="col-md-3">
                  <label for="ebitdaUpLiftOptimisticCase">
                    EBITDA Uplift ( M.THB)
                  </label>
                  <input class="form-control" type="number" formControlName="ebitdaOptimisticCase" />
                </div>
              </div>
              <br />
              <hr />
              <br />
              <div class="form-group row">
                <div class="col-md-12">
                  <label for="pessimisticCase">
                    Pessimistic Case (Please specify assumption)
                  </label>
                  <textarea class="form-control" formControlName="pessimisticCase" rows="2"></textarea>
                </div>
              </div>
              <div class="form-group row">
                <div class="col-md-3">
                  <label for="projectIrrPessimisticCase">
                    Project IRR(%)
                  </label>
                  <input class="form-control" type="number" formControlName="projectIrrPessimisticCase" />
                </div>
                <div class="col-md-3">
                  <label for="npvPessimisticCase"> NPV (M THB) </label>
                  <input class="form-control" type="number" formControlName="npvPessimisticCase" />
                </div>
                <div class="col-md-3">
                  <label for="paybackPessimisticCase"> Payback(Year) </label>
                  <input class="form-control" type="number" formControlName="paybackPessimisticCase" />
                </div>
                <div class="col-md-3">
                  <label for="ebitdaUpLiftPessimisticCase">
                    EBITDA Uplift ( M.THB)
                  </label>
                  <input class="form-control" type="number" formControlName="ebitdaPessimisticCase" />
                </div>
              </div>
              <br />
              <hr />
              <br />

              <div class="form-group row">
                <div class="col-md-6">
                  <label for="usefulLife">
                    Useful life <span class="text-danger">*</span>
                  </label>
                </div>
              </div>
              <div class="form-group row">
                <div class="col-md-2">
                  <input class="form-control" type="number" formControlName="usefulYear" />
                </div>
                <div class="text-center mt-2">Year</div>
                <div class="col-md-2">
                  <input class="form-control" type="number" formControlName="usefulMonth"
                    (input)="OnchangeUsefulMonth()" />
                </div>
                <div class="text-center mt-2">Month</div>
              </div>
              <div class="form-group row">
                <div class="col-md-6">
                  <label for="depreciationCost">
                    Depreciation Cost <span class="text-danger">*</span>
                  </label>
                  <input class="form-control" type="text" formControlName="depreciationCost" />
                </div>
              </div>
              <br />
              <hr />
              <br />
              <h5>
                Additional Key Performance Indicators
                <span class="text-danger">*</span>
              </h5>
              <table class="table table-bordered mt-4">
                <thead class="text-center bg-light">
                  <th width="20%">KPIs</th>
                  <th width="55%">Target</th>
                  <th width="20%">Frequency</th>
                  <th width="5%" *ngIf="!PoolView"></th>
                </thead>
                <tbody *ngFor="
                    let control of DetailForm.controls.kpisForm.get('kpis')[
                      'controls'
                    ];
                    let i = index
                  ">
                  <tr [formGroup]="control">
                    <td>
                      <select class="form-control" type="text" formControlName="kpis" (change)="ChangeKpis(i, $event)">
                        <option value="" selected disabled>
                          Choose...
                        </option>
                        <option *ngFor="let kpis of kpises" value="{{ kpis.kpisTitle }}" [disabled]="kpis.disabled">
                          {{ kpis.kpisTitle }}
                        </option>
                      </select>
                    </td>
                    <td>
                      <input class="form-control" type="text" formControlName="target" />
                    </td>
                    <td>
                      <select class="form-control" type="text" formControlName="frequency">
                        <option value="" selected disabled>Choose...</option>
                        <option *ngFor="let frequency of frequencies" value="{{ frequency.frequencyTitle }}">
                          {{ frequency.frequencyTitle }}
                        </option>
                      </select>
                    </td>
                    <td *ngIf="!PoolView">
                      <button type="button" style="font-size: x-small;" class="btn btn-danger btn-sm mr-1"
                        (click)="RemoveKpis(i)" [disabled]="isRemoveKpis">
                        <i class="fas fa-trash-alt"></i>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
              <ng-container *ngIf="!PoolView">
                <button class="btn btn-primary mr-5" (click)="AddKpis()" [disabled]="isDisableAddKpis">
                  <i class="fas fa-plus-square mr-2"></i> Add New
                </button>
              </ng-container>
              <br />
              <hr />
              <br />
              <div class="col-md-12">
                <label for="">KPIs Remark</label>
                <textarea class="form-control" formControlName="remark" rows="5"></textarea>
              </div>
              <br />
              <br />
              <div class="col-md-12">
                <label for="">Other Remark</label>
                <textarea class="form-control" formControlName="otherKpis" rows="5"></textarea>
              </div>
              <br />
            </div>
          </div>
        </div>
      </div>
    </form>
  </tab>

  <tab heading="CAPEX Information" (selectTab)="changeTab($event)">
    <div class="col-md-12">
      <div class="card text card-initiative">
        <div class="form-group row mt-5">
          <div class="col-md-6">
            <h3>{{ name }}</h3>
          </div>
          <div class="col-md-6" *ngIf="status != 'draft'">
            <div class="w-20 float-right">
              <app-button-view-revision [id]="id"></app-button-view-revision>
            </div>
          </div>
          <div class="col-md-12">
            <hr />
          </div>
        </div>
        <div class="container mt-3 my-1">
          <div class="row">
            <div class="col-md-12">
              <!-- <app-initiative-information [id]="id" [CapexType]="CapexType"></app-initiative-information> -->

              <div class="information">
                <div class="card bg-light">
                  <div class="card-body">
                    <div class="row">
                      <div class="col-md-2 text-right">
                        <p class="font-weight-bolder">Initiative ID :</p>
                      </div>
                      <div class="col-md-4">
                        <p>
                          {{ InitiativeDetail.code }}
                        </p>
                      </div>
                      <ng-container *ngIf="InitiativeDetail.stage">
                        <div class="col-md-2 text-right">
                          <p class="font-weight-bolder">Stage :</p>
                        </div>
                        <div class="col-md-4">
                          <p>
                            {{ InitiativeDetail.stage }}
                          </p>
                        </div>
                      </ng-container>
                    </div>
                  </div>
                </div>

                <br />

                <div class="card bg-light">
                  <div class="card-body">
                    <div class="row" *ngIf="
                      GetRevision.Revistion != null ||
                      GetRevision.Revistion != undefined
                    ">
                      <div class="col-md-2 text-right">
                        <p class="font-weight-bolder">Revistion No. :</p>
                      </div>
                      <div class="col-md-4">
                        <p>
                          {{ GetRevision.Revistion }}
                        </p>
                      </div>
                    </div>

                    <div class="row">
                      <div class="col-md-2 text-right">
                        <p class="font-weight-bolder">Initiative Name :</p>
                      </div>
                      <div class="col-md-4">
                        <p>
                          {{ InitiativeDetail.name }}
                        </p>
                      </div>
                      <div class="col-md-2 text-right">
                        <p class="font-weight-bolder">Initiative Year :</p>
                      </div>
                      <div class="col-md-4">
                        <p>
                          {{ InitiativeDetail.year }}
                        </p>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-2 text-right">
                        <p class="font-weight-bolder">Owner Name :</p>
                      </div>
                      <div class="col-md-4">
                        <p>
                          {{ InitiativeDetail.owner }}
                        </p>
                      </div>

                      <div class="col-md-2 text-right">
                        <p class="font-weight-bolder">Organization :</p>
                      </div>
                      <div class="col-md-4">
                        <p>
                          {{ InitiativeDetail.organization }}
                        </p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="card text card-initiative">
                <form *ngIf="Initiative_tmp" [formGroup]="InitiativeDetailForm">
                  <div class="row mt-5">
                    <div class="col-md-12">
                      <h4>Initiative Detail</h4>
                      <hr />
                    </div>
                    <div class="col-md-6">
                      <label for="StartingDate">
                        Starting Date <span class="text-danger">*</span> :
                      </label>

                      <div class="input-group">
                        <input formControlName="StartingDate" (bsValueChange)="
                          setStartingDate(StartingDate_1.value)
                        " type="text" #StartingDate_1 class="form-control" [bsConfig]="bsConfigStart" bsDatepicker
                          name="StartingDate_1" #dpStart="bsDatepicker"
                          [ngClass]="{ 'is-invalid': invalidStartingDate }"
                          [triggers]="viewMode ? '' : 'click:click'" />

                        <div *ngIf="!viewMode" class="input-group-append">
                          <i class="far fa-calendar right-icon mt-2" (click)="dpStart.toggle()"
                            [attr.aria-expanded]="dpStart.isOpen"></i>
                        </div>
                        <div class="invalid-feedback" *ngIf="invalidStartingDate">
                          Starting Date is required !
                        </div>
                      </div>
                    </div>
                    <div class="col-md-6">
                      <label for="ProjecctComRun">
                        Finish Date <span class="text-danger">*</span> :
                      </label>
                      <div class="input-group">
                        <input formControlName="ProjecctComRun" (bsValueChange)="
                          setFinishDate(ProjecctComRun_1.value)
                        " type="text" #ProjecctComRun_1 class="form-control" [bsConfig]="bsConfigFinish" bsDatepicker
                          name="ProjecctComRun_1" #dpFinish="bsDatepicker" [triggers]="viewMode ? '' : 'click:click'"
                          [ngClass]="{ 'is-invalid': invalidFinishingDate }" />

                        <div *ngIf="!viewMode" class="input-group-append">
                          <i class="far fa-calendar right-icon mt-2" (click)="dpFinish.toggle()"
                            [attr.aria-expanded]="dpFinish.isOpen"></i>
                        </div>
                        <div class="invalid-feedback" *ngIf="invalidFinishingDate">
                          Finish Date is required !
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="row mt-3">
                    <div class="col-md-6">
                      <label for="RequestIniNoDate">
                        Request Project No. Date (Budget Start Date)
                        <span class="text-danger">*</span> :
                      </label>
                      <div class="input-group">
                        <input formControlName="RequestIniNoDate" (bsValueChange)="
                          setRequestDate(RequestIniNoDate_1.value)
                        " type="text" #RequestIniNoDate_1 class="form-control" [bsConfig]="bsConBetween" bsDatepicker
                          name="RequestIniNoDate_1" #dpBudget="bsDatepicker" [triggers]="viewMode ? '' : 'click:click'"
                          [ngClass]="{ 'is-invalid': invalidRequestIniNoDate }" />

                        <div *ngIf="!viewMode" class="input-group-append">
                          <i class="far fa-calendar right-icon mt-2" (click)="dpBudget.toggle()"
                            [attr.aria-expanded]="dpBudget.isOpen"></i>
                        </div>
                        <div class="invalid-feedback" *ngIf="invalidRequestIniNoDate">
                          Request Project No. Date (Budget Start Date) is
                          required !
                        </div>
                      </div>
                    </div>
                    <div class="col-md-6">
                      <label for="finishDate">
                        Project Execution Period
                        <span class="text-danger">*</span> :
                      </label>
                      <div class="row">
                        <div class="col-md-3">
                          <input type="text" class="form-control" value="ProjectExePeriodYear"
                            formControlName="ProjectExePeriodYear" readonly />
                        </div>
                        <div class="col-md-3 p-2">
                          <span>Year</span>
                        </div>
                        <div class="col-md-3">
                          <input type="text" class="form-control" value="ProjectExePeriodMonth"
                            formControlName="ProjectExePeriodMonth" readonly />
                        </div>
                        <div class="col-md-3 p-2">
                          <span>Month</span>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="row mt-3">
                    <div class="col-md-6">
                      <label for="CostCenterOfVP">
                        Cost Center of VP (Asset Owner)
                        <span class="text-danger">*</span> :
                      </label>

                      <ng-select formControlName="CostCenterOfVP" [items]="owners" bindValue="ownerName"
                        bindLabel="ownerName" placeholder="Choose Owner" (search)="SearchOwnerName($event)"
                        (clear)="ClearOwnerName()" [ngClass]="{ 'is-invalid': invalidOrganization }">
                      </ng-select>

                      <div class="text-feedback" *ngIf="invalidOrganization">
                        Cost Center of VP is required !
                      </div>
                    </div>
                    <div class="col-md-6">
                      <label for="finishDate">
                        Code Of Cost Center of VP (Asset Owner)
                        <span class="text-danger">*</span> :
                      </label>
                      <input formControlName="CodeCostCenterOfVP" type="text" name="CodeCostCenterOfVP"
                        class="form-control" placeholder="" [ngClass]="{ 'is-invalid': invalidCodeCostCenterOfVP }"
                        [(ngModel)]="CodeCostCenterOfVP" />

                      <div class="invalid-feedback" *ngIf="invalidCodeCostCenterOfVP">
                        Code Of Cost Center of VP is required !
                      </div>
                    </div>
                  </div>

                  <div class="row mt-3">
                    <div class="col-md-6">
                      <label for="finishDate">
                        Project Cost (MTHB) <span class="text-danger">*</span> :
                      </label>
                      <input formControlName="ProjectCost" #ProjectCost_tmp
                        (blur)="setProjectCost(ProjectCost_tmp.value)" type="text" name="ProjectCost"
                        class="form-control" placeholder="0.00" thousandSeparator="," step="0.01" mask="separator.2"
                        [ngClass]="{ 'is-invalid': invalidCostEstCapex }" />

                      <div class="invalid-feedback" *ngIf="invalidCostEstCapex">
                        Project Cost (MTHB) is required !
                      </div>
                    </div>
                  </div>

                  <div class="row mt-3 d-none">
                    <div class="col-md-12" *ngIf="RemarkShow == true">
                      <label for="finishDate">
                        Reason of changing Project Cost
                        <span class="text-danger">*</span>
                        :
                      </label>
                      <textarea class="form-control" id="ReasonOfChanging" rows="2" name="ReasonOfChanging"
                        formControlName="ReasonOfChanging">
                    </textarea>
                    </div>
                  </div>

                  <div class="row mt-3">
                    <div class="col-md-2">
                      <label for="BudgetForm">
                        Budget Period <span class="text-danger">*</span> :
                      </label>
                    </div>
                    <div class="col-md-10">
                      <div class="custom-control custom-radio custom-control-inline">
                        <input id="Annual" value="Annual" disabled class="custom-control-input" type="radio"
                          name="BudgetForm" formControlName="BudgetForm"
                          (change)="OnChangeRequestOPEX($event.target.value)"
                          [ngClass]="{ 'is-invalid': invalidBudget }" />
                        <label class="custom-control-label" for="Annual">
                          Annual ({{ year_next }})
                        </label>
                      </div>
                    </div>
                    <div class="col-md-2"></div>
                    <div class="col-md-10 mt-1">
                      <div class="custom-control custom-radio custom-control-inline">
                        <input id="MidYear" value="Mid Year" disabled class="custom-control-input" type="radio"
                          name="BudgetForm" formControlName="BudgetForm"
                          (change)="OnChangeRequestOPEX($event.target.value)"
                          [ngClass]="{ 'is-invalid': invalidBudget }" />
                        <label class="custom-control-label" for="MidYear">
                          Mid Year ({{ year_now }})
                        </label>
                      </div>
                    </div>
                    <div class="col-md-2"></div>
                    <div class="col-md-10 mt-2 d-none">
                      <div class="custom-control custom-radio custom-control-inline">
                        <input id="Between" value="Current year" class="custom-control-input" type="radio"
                          name="BudgetForm" formControlName="BudgetForm"
                          (change)="OnChangeRequestOPEX($event.target.value)"
                          [ngClass]="{ 'is-invalid': invalidBudget }" />
                        <label class="custom-control-label" for="Between">
                          Current year
                        </label>
                      </div>
                    </div>

                    <div class="row mt-3 sub-Between" *ngIf="showContingency">
                      <div class="col-md-12">
                        <div class="custom-control custom-radio custom-control-inline">
                          <input id="Contingency" value="Contingency" class="custom-control-input" type="radio"
                            name="BetweenYear" formControlName="BetweenYear"
                            (change)="OnChangeBetweenYear($event.target.value)"
                            [ngClass]="{ 'is-invalid': invalidBudget }" />
                          <label class="custom-control-label" for="Contingency">
                            Contingency ({{ year_now }})
                          </label>
                        </div>
                      </div>
                      <div class="col-md-12 mt-2">
                        <div class="custom-control custom-radio custom-control-inline">
                          <input id="Transfer" value="Transfer" class="custom-control-input" type="radio"
                            name="BetweenYear" formControlName="BetweenYear"
                            (change)="OnChangeBetweenYear($event.target.value)"
                            [ngClass]="{ 'is-invalid': invalidBudget }" />
                          <label class="custom-control-label" for="Transfer">
                            Transfer ({{ year_now }})
                          </label>
                        </div>
                      </div>
                    </div>

                    <div class="col-md-12 sub-Transfer">
                      <div *ngIf="inshow">
                        <label for="TransferForm">
                          Transfer Form <span class="text-danger">*</span> :
                        </label>
                        <div class="input-group" id="Form" style="width: 50%;">
                          <select formControlName="TransferForm" name="TransferForm" value="TransferForm"
                            class="form-control" (change)="transfer($event.target.value)">
                            <option value="" selected disabled>
                              Choose...</option>
                            <option value="OPEX">OPEX</option>
                            <option value="RMA">RMA</option>
                          </select>
                        </div>
                      </div>
                    </div>

                    <div class="row sub-Between" *ngIf="showContingency">
                      <div class="col-md-12 mt-2">
                        <div class="custom-control custom-radio custom-control-inline">
                          <input id="Pool" value="Pool Budget" class="custom-control-input" type="radio"
                            name="BetweenYear" formControlName="BetweenYear"
                            (change)="OnChangeBetweenYear($event.target.value)" />
                          <label class="custom-control-label" for="Pool">
                            Pool Budget ({{ year_now }})
                          </label>
                        </div>
                      </div>
                    </div>

                    <div class="col-md-12 mt-3 sub-Transfer">
                      <div *ngIf="ferPool">
                        <label for="TransferForm">
                          Pool Budget From <span class="text-danger">*</span> :
                        </label>
                        <div class="input-group" id="Form" style="width: 50%;">
                          <select class="form-control" formControlName="PoolBudgetForm" name="PoolBudgetForm"
                            value="PoolBudgetForm" (change)="pool($event.target.value)">
                            <option value="" selected disabled>
                              Choose...
                            </option>
                            <option value="MAX">MAX</option>
                            <option value="DIM">DIM</option>
                            <option value="PIM">PIM</option>
                            <option value="ER">ER</option>
                            <option value="MTPi">MTPi</option>
                          </select>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Start Table -->
                  <!---->

                  <div class="row mt-5">
                    <div class="col-md-12">
                      <h4>Annual Investment Plan</h4>
                      <hr />
                    </div>
                  </div>

                  <div *ngIf="disableTable == 'true'">
                    <form *ngIf="AnnualForm" [formGroup]="AnnualForm">
                      <div class="container">
                        <div class="row">
                          <div class="col-md-12">
                            <div class="card text card-initiative">
                              <div class="form-initiative">
                                <div class="form-row align-items-center">
                                  <div class="w-100">
                                    <div class="table-responsive">
                                      <table class="table table-bordered">
                                        <thead class="text-center bg-light">
                                          <tr>
                                            <th width="200px">
                                              Investment Plan
                                            </th>
                                            <th width="100px">Overall</th>
                                            <th width="100px" *ngFor="
                                              let column of YearTable_capex;
                                              let i = index
                                            ">
                                              {{ column.columnname }}
                                            </th>
                                          </tr>
                                        </thead>
                                        <tbody>
                                          <tr formArrayName="annualForm_list" *ngFor="
                                            let cd of annualForm_.controls;
                                            let i = index
                                          ">
                                            <td class="text-center" [formGroupName]="i">
                                              <!-- <select class="form-control">
                                            <option>{{i.currencyTitle}}</option>
                                          </select> -->
                                              <select class="form-control" *ngIf="i == 0"
                                                formControlName="currencyTitle" [attr.disabled]="true">
                                                <option *ngFor="
                                                  let t of typeTransaction
                                                " [value]="t.code">
                                                  {{ t.chooes }}
                                                </option>
                                              </select>

                                              <select class="form-control" *ngIf="i != 0"
                                                formControlName="currencyTitle" (change)="
                                              changeRate($event.target.value, i)
                                              ">
                                                <option *ngFor="let t of typeTransaction" [value]="t.code">
                                                  {{ t.chooes }}</option>
                                              </select>

                                              <label class="mt-3" for="finishDate" *ngIf="i != 0">
                                                FX
                                              </label>

                                              <input formControlName="fx" (change)="ChangingValue_fx(i)"
                                                mask="separator.2" step="0.01" thousandSeparator=","
                                                class="form-control" type="text" *ngIf="i != 0" />

                                              <div *ngIf="!PoolView">
                                                <button [formGroupName]="i" *ngIf="i != 0"
                                                  class="btn btn-danger btn-sm mt-3" (click)="deleteSellingPoint(i)">
                                                  <i class="fas fa-trash-alt"></i>
                                                </button>
                                              </div>

                                            </td>
                                            <td [formGroupName]="i">
                                              <input class="form-control" type="text" formControlName="overall"
                                                mask="separator.2" step="0.01" thousandSeparator=","
                                                [readonly]="true" />
                                            </td>
                                            <td [formGroupName]="i" *ngFor="
                                              let column of YearTable_capex;
                                              let j = index
                                            ">
                                              <input class="form-control" (change)="
                                                ChangingValue(
                                                  $event.target.value
                                                )
                                              " formControlName="y{{ j + 1 }}" [readonly]="column.isEdit"
                                                mask="separator.2" step="0.01" thousandSeparator="," />
                                            </td>
                                          </tr>
                                        </tbody>
                                        <tfoot>
                                          <tr>
                                            <td>
                                              <label for="finishDate">
                                                Total Million Baht
                                              </label>
                                            </td>
                                            <td>
                                              <input class="form-control" type="text" [readonly]="true"
                                                mask="separator.2" thousandSeparator=","
                                                formControlName="AnnualTotal_overall" />
                                            </td>
                                            <td *ngFor="
                                              let column of YearTable_capex;
                                              let j = index
                                            ">
                                              <input class="form-control" type="text" [readonly]="true"
                                                mask="separator.2" thousandSeparator="," formControlName="AnnualTotal{{
                                                j + 1
                                              }}" />
                                            </td>
                                          </tr>
                                        </tfoot>
                                      </table>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      <ng-container *ngIf="!PoolView">
                        <button type="button" class="btn btn-primary mt-3" (click)="addSellingPoint()">
                          Add New
                        </button>
                      </ng-container>
                    </form>
                  </div>

                  <div *ngIf="disableTable == 'true'">
                    <div *ngFor="let ym of year_m; let i = index">
                      <form *ngIf="i == 0" [formGroup]="monthForm0">
                        <div class="row mt-5">
                          <div class="col-md-11">
                            <h4>Monthly Investment Plan ({{ ym }})</h4>
                            <hr />
                          </div>
                          <div class="col-md-1">
                            <button class="btn btn-info" data-toggle="collapse" data-target="#M1">
                              +
                            </button>
                          </div>
                        </div>

                        <div class="container collapse" id="M1">
                          <div class="row">
                            <div class="col-md-12">
                              <div class="card text card-initiative">
                                <div class="form-initiative">
                                  <div class="form-row align-items-center">
                                    <div class="w-100">
                                      <div class="table-responsive">
                                        <table class="table table-bordered">
                                          <thead class="text-center bg-light">
                                            <tr>
                                              <th width="200px">
                                                Investment Plan
                                              </th>
                                              <th width="180px">Overall</th>
                                              <th width="180px" *ngFor="let m of monthList_1">
                                                {{ m.columnname }}
                                              </th>
                                            </tr>
                                          </thead>
                                          <tbody *ngFor="
                                            let cd of monthForm0_.controls;
                                            let j = index
                                          ">
                                            <tr formArrayName="monthForm_list">
                                              <td [formGroupName]="j">
                                                <select class="form-control" formControlName="currencyTitle"
                                                  disabled="flagFirst_row">
                                                  <option *ngFor="
                                                    let t of typeTransaction_month
                                                  " [value]="t.code">{{ t.chooes }}
                                                  </option>
                                                </select>
                                                <label class="mt-3" for="finishDate" *ngIf="j != 0">
                                                  FX
                                                </label>
                                                <input formControlName="fx" class="form-control" type="text"
                                                  *ngIf="j != 0" readonly="true" />
                                              </td>
                                              <td [formGroupName]="j">
                                                <input class="form-control" type="text" formControlName="overall"
                                                  mask="separator.2" thousandSeparator="," [readonly]="true" />
                                              </td>
                                              <td [formGroupName]="j" *ngFor="
                                              let column of monthList_1;
                                              let jj = index
                                            ">
                                                <input *ngIf="
                                                cd.get('flag_alert').value ==
                                                true
                                              " class="form-control ; border-danger" formControlName="m{{ jj + 1 }}"
                                                  [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table1(ym)
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                  mask="separator" thousandSeparator="," value="" />
                                                <input *ngIf="
                                                cd.get('flag_alert').value ==
                                                false
                                              " class="form-control" formControlName="m{{ jj + 1 }}"
                                                  [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table1(ym)
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                  mask="separator" thousandSeparator="," />
                                              </td>
                                            </tr>
                                          </tbody>
                                          <tfoot>
                                            <tr>
                                              <td>
                                                <label for="finishDate">
                                                  Total Baht
                                                </label>
                                              </td>
                                              <td>
                                                <input class="form-control" type="text" [readonly]="true"
                                                  formControlName="monthTotal_overall" mask="separator.2"
                                                  thousandSeparator="," />
                                              </td>
                                              <td *ngFor="
                                                let column of monthList_1;
                                                let j = index
                                              ">
                                                <input class="form-control" type="text" [readonly]="true"
                                                  formControlName="monthTotal{{
                                                  j + 1
                                                }}" mask="separator.2" thousandSeparator="," />
                                              </td>
                                            </tr>
                                          </tfoot>
                                        </table>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </form>

                      <form *ngIf="i == 1" [formGroup]="monthForm1">
                        <div class="row mt-5">
                          <div class="col-md-11">
                            <h4>Monthly Investment Plan ({{ ym }})</h4>
                            <hr />
                          </div>
                          <div class="col-md-1">
                            <button class="btn btn-info" data-toggle="collapse" data-target="#M2">
                              +
                            </button>
                          </div>
                        </div>

                        <div class="container collapse" id="M2">
                          <div class="row">
                            <div class="col-md-12">
                              <div class="card text card-initiative">
                                <div class="form-initiative">
                                  <div class="form-row align-items-center">
                                    <div class="w-100">
                                      <div class="table-responsive">
                                        <table class="table table-bordered">
                                          <thead class="text-center bg-light">
                                            <tr>
                                              <th width="200px">
                                                Investment Plan
                                              </th>
                                              <th width="180px">Overall</th>

                                              <ng-container *ngIf="i != diffYear">
                                                <th width="180px" *ngFor="let m of monthList_x">
                                                  {{ m.columnname }}
                                                </th>
                                              </ng-container>
                                              <ng-container *ngIf="i == diffYear">
                                                <th width="180px" *ngFor="
                                                  let m of monthList_last
                                                ">
                                                  {{ m.columnname }}
                                                </th>
                                              </ng-container>
                                            </tr>
                                          </thead>
                                          <tbody>
                                            <tr formArrayName="monthForm_list" *ngFor="
                                              let cd of monthForm1_.controls;
                                              let j = index
                                            ">
                                              <td [formGroupName]="j">
                                                <select class="form-control" formControlName="currencyTitle"
                                                  disabled="flagFirst_row">
                                                  <option *ngFor="
                                                    let t of typeTransaction_month
                                                  " [value]="t.code">{{ t.chooes }}
                                                  </option>
                                                </select>
                                                <label class="mt-3" for="finishDate" *ngIf="j != 0">
                                                  FX
                                                </label>
                                                <input formControlName="fx" class="form-control" type="text"
                                                  *ngIf="j != 0" readonly="true" />
                                              </td>
                                              <td [formGroupName]="j">
                                                <input class="form-control" type="text" formControlName="overall"
                                                  [readonly]="true" mask="separator.2" thousandSeparator="," />
                                              </td>
                                              <ng-container *ngIf="i != diffYear">
                                                <td [formGroupName]="j" *ngFor="
                                                let column of monthList_x;
                                                let jj = index
                                              ">
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == true
                                                " class="form-control ; border-danger" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table2(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                    pattern="[0-9]*" mask="separator" thousandSeparator="," />
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == false
                                                " class="form-control" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table2(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                    pattern="[0-9]*" mask="separator" thousandSeparator="," />
                                                </td>
                                              </ng-container>
                                              <ng-container *ngIf="i == diffYear">
                                                <td [formGroupName]="j" *ngFor="
                                                let column of monthList_last;
                                                let jj = index
                                              ">
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == true
                                                " class="form-control ; border-danger" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table2(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                    mask="separator" thousandSeparator="," />
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == false
                                                " class="form-control" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table2(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                    mask="separator" thousandSeparator="," />
                                                </td>
                                              </ng-container>
                                            </tr>
                                          </tbody>
                                          <tfoot>
                                            <tr>
                                              <td>
                                                <label for="finishDate">
                                                  Total Baht
                                                </label>
                                              </td>
                                              <td>
                                                <input class="form-control" type="text" [readonly]="true"
                                                  formControlName="monthTotal_overall" mask="separator.2"
                                                  thousandSeparator="," />
                                              </td>
                                              <td *ngFor="
                                                let column of monthList_1;
                                                let j = index
                                              ">
                                                <input class="form-control" type="text" [readonly]="true"
                                                  formControlName="monthTotal{{
                                                  j + 1
                                                }}" mask="separator.2" thousandSeparator="," />
                                              </td>
                                            </tr>
                                          </tfoot>
                                        </table>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </form>

                      <form *ngIf="i == 2" [formGroup]="monthForm2">
                        <div class="row mt-5">
                          <div class="col-md-11">
                            <h4>Monthly Investment Plan ({{ ym }})</h4>
                            <hr />
                          </div>
                          <div class="col-md-1">
                            <button class="btn btn-info" data-toggle="collapse" data-target="#M3">
                              +
                            </button>
                          </div>
                        </div>

                        <div class="container collapse" id="M3">
                          <div class="row">
                            <div class="col-md-12">
                              <div class="card text card-initiative">
                                <div class="form-initiative">
                                  <div class="form-row align-items-center">
                                    <div class="w-100">
                                      <div class="table-responsive">
                                        <table class="table table-bordered">
                                          <thead class="text-center bg-light">
                                            <tr>
                                              <th width="200px">
                                                Investment Plan
                                              </th>
                                              <th width="180px">Overall</th>
                                              <th width="180px" *ngFor="let m of monthList_x">
                                                {{ m.columnname }}
                                              </th>
                                            </tr>
                                          </thead>
                                          <tbody>
                                            <tr formArrayName="monthForm_list" *ngFor="
                                              let cd of monthForm2_.controls;
                                              let j = index
                                            ">
                                              <td [formGroupName]="j">
                                                <select class="form-control" formControlName="currencyTitle"
                                                  disabled="flagFirst_row">
                                                  <option *ngFor="
                                                    let t of typeTransaction_month
                                                  " [value]="t.code">{{ t.chooes }}
                                                  </option>
                                                </select>
                                                <label class="mt-3" for="finishDate" *ngIf="j != 0">
                                                  FX
                                                </label>
                                                <input formControlName="fx" class="form-control" type="text"
                                                  *ngIf="j != 0" readonly="true" />
                                              </td>
                                              <td [formGroupName]="j">
                                                <input class="form-control" type="text" formControlName="overall"
                                                  mask="separator.2" thousandSeparator="," [readonly]="true" />
                                              </td>
                                              <ng-container *ngIf="i != diffYear">
                                                <td [formGroupName]="j" *ngFor="
                                                let column of monthList_x;
                                                let jj = index
                                              ">
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == true
                                                " class="form-control ; border-danger" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table3(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                    mask="separator" thousandSeparator="," />
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == false
                                                " class="form-control" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table3(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                    mask="separator" thousandSeparator="," />
                                                </td>
                                              </ng-container>
                                              <ng-container *ngIf="i == diffYear">
                                                <td [formGroupName]="j" *ngFor="
                                                let column of monthList_last;
                                                let jj = index
                                              ">
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == true
                                                " class="form-control ; border-danger" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table3(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                    mask="separator" thousandSeparator="," />
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == false
                                                " class="form-control" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table3(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                    mask="separator" thousandSeparator="," />
                                                </td>
                                              </ng-container>
                                            </tr>
                                          </tbody>
                                          <tfoot>
                                            <tr>
                                              <td>
                                                <label for="finishDate">
                                                  Total Baht
                                                </label>
                                              </td>
                                              <td>
                                                <input class="form-control" type="text" [readonly]="true"
                                                  formControlName="monthTotal_overall" mask="separator.2"
                                                  thousandSeparator="," />
                                              </td>
                                              <td *ngFor="
                                                let column of monthList_1;
                                                let j = index
                                              ">
                                                <input class="form-control" type="text" [readonly]="true"
                                                  formControlName="monthTotal{{
                                                  j + 1
                                                }}" mask="separator.2" thousandSeparator="," />
                                              </td>
                                            </tr>
                                          </tfoot>
                                        </table>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </form>

                      <form *ngIf="i == 3" [formGroup]="monthForm3">
                        <div class="row mt-5">
                          <div class="col-md-11">
                            <h4>Monthly Investment Plan ({{ ym }})</h4>
                            <hr />
                          </div>
                          <div class="col-md-1">
                            <button class="btn btn-info" data-toggle="collapse" data-target="#M4">
                              +
                            </button>
                          </div>
                        </div>

                        <div class="container collapse" id="M4">
                          <div class="row">
                            <div class="col-md-12">
                              <div class="card text card-initiative">
                                <div class="form-initiative">
                                  <div class="form-row align-items-center">
                                    <div class="w-100">
                                      <div class="table-responsive">
                                        <table class="table table-bordered">
                                          <thead class="text-center bg-light">
                                            <tr>
                                              <th width="200px">
                                                Investment Plan
                                              </th>
                                              <th width="180px">Overall</th>
                                              <th width="180px" *ngFor="let m of monthList_x">
                                                {{ m.columnname }}
                                              </th>
                                            </tr>
                                          </thead>
                                          <tbody>
                                            <tr formArrayName="monthForm_list" *ngFor="
                                              let cd of monthForm3_.controls;
                                              let j = index
                                            ">
                                              <td [formGroupName]="j">
                                                <select class="form-control" formControlName="currencyTitle"
                                                  disabled="flagFirst_row">
                                                  <option *ngFor="
                                                    let t of typeTransaction_month
                                                  " [value]="t.code">{{ t.chooes }}
                                                  </option>
                                                </select>
                                                <label class="mt-3" for="finishDate" *ngIf="j != 0">
                                                  FX
                                                </label>
                                                <input formControlName="fx" class="form-control" type="text"
                                                  *ngIf="j != 0" readonly="true" />
                                              </td>
                                              <td [formGroupName]="j">
                                                <input class="form-control" type="text" formControlName="overall"
                                                  mask="separator.2" thousandSeparator="," [readonly]="true" />
                                              </td>
                                              <ng-container *ngIf="i != diffYear">
                                                <td [formGroupName]="j" *ngFor="
                                                let column of monthList_x;
                                                let jj = index
                                              ">
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == true
                                                " class="form-control ; border-danger" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table4(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                    mask="separator" thousandSeparator="," />
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == false
                                                " class="form-control" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table4(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                    mask="separator" thousandSeparator="," />
                                                </td>
                                              </ng-container>
                                              <ng-container *ngIf="i == diffYear">
                                                <td [formGroupName]="j" *ngFor="
                                                let column of monthList_last;
                                                let jj = index
                                              ">
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == true
                                                " class="form-control ; border-danger" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table4(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                    mask="separator" thousandSeparator="," />
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == false
                                                " class="form-control" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table4(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                    mask="separator" thousandSeparator="," />
                                                </td>
                                              </ng-container>
                                            </tr>
                                          </tbody>
                                          <tfoot>
                                            <tr>
                                              <td>
                                                <label for="finishDate">
                                                  Total Baht
                                                </label>
                                              </td>
                                              <td>
                                                <input class="form-control" type="text" [readonly]="true"
                                                  mask="separator.2" thousandSeparator=","
                                                  formControlName="monthTotal_overall" />
                                              </td>
                                              <td *ngFor="
                                                let column of monthList_1;
                                                let j = index
                                              ">
                                                <input class="form-control" type="text" [readonly]="true"
                                                  mask="separator.2" thousandSeparator="," formControlName="monthTotal{{
                                                  j + 1
                                                }}" />
                                              </td>
                                            </tr>
                                          </tfoot>
                                        </table>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </form>

                      <form *ngIf="i == 4" [formGroup]="monthForm4">
                        <div class="row mt-5">
                          <div class="col-md-11">
                            <h4>Monthly Investment Plan ({{ ym }})</h4>
                            <hr />
                          </div>
                          <div class="col-md-1">
                            <button class="btn btn-info" data-toggle="collapse" data-target="#M5">
                              +
                            </button>
                          </div>
                        </div>

                        <div class="container collapse" id="M5">
                          <div class="row">
                            <div class="col-md-12">
                              <div class="card text card-initiative">
                                <div class="form-initiative">
                                  <div class="form-row align-items-center">
                                    <div class="w-100">
                                      <div class="table-responsive">
                                        <table class="table table-bordered">
                                          <thead class="text-center bg-light">
                                            <tr>
                                              <th width="200px">
                                                Investment Plan
                                              </th>
                                              <th width="180px">Overall</th>
                                              <th width="180px" *ngFor="let m of monthList_x">
                                                {{ m.columnname }}
                                              </th>
                                            </tr>
                                          </thead>
                                          <tbody>
                                            <tr formArrayName="monthForm_list" *ngFor="
                                              let cd of monthForm4_.controls;
                                              let j = index
                                            ">
                                              <td [formGroupName]="j">
                                                <select class="form-control" formControlName="currencyTitle"
                                                  disabled="flagFirst_row">
                                                  <option *ngFor="
                                                    let t of typeTransaction_month
                                                  " [value]="t.code">{{ t.chooes }}
                                                  </option>
                                                </select>
                                                <label class="mt-3" for="finishDate" *ngIf="j != 0">
                                                  FX
                                                </label>
                                                <input formControlName="fx" class="form-control" type="text"
                                                  *ngIf="j != 0" readonly="true" />
                                              </td>
                                              <td [formGroupName]="j">
                                                <input class="form-control" type="text" formControlName="overall"
                                                  mask="separator.2" thousandSeparator="," [readonly]="true" />
                                              </td>
                                              <ng-container *ngIf="i != diffYear">
                                                <td [formGroupName]="j" *ngFor="
                                                let column of monthList_x;
                                                let jj = index
                                              ">
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == true
                                                " class="form-control ; border-danger" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table5(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                    mask="separator" thousandSeparator="," />
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == false
                                                " class="form-control" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table5(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                    mask="separator" thousandSeparator="," />
                                                </td>
                                              </ng-container>
                                              <ng-container *ngIf="i == diffYear">
                                                <td [formGroupName]="j" *ngFor="
                                                let column of monthList_last;
                                                let jj = index
                                              ">
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == true
                                                " class="form-control ; border-danger" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table5(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                    mask="separator" thousandSeparator="," />
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == false
                                                " class="form-control" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table5(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                    mask="separator" thousandSeparator="," />
                                                </td>
                                              </ng-container>
                                            </tr>
                                          </tbody>
                                          <tfoot>
                                            <tr>
                                              <td>
                                                <label for="finishDate">
                                                  Total Baht
                                                </label>
                                              </td>
                                              <td>
                                                <input class="form-control" type="text" [readonly]="true"
                                                  mask="separator.2" thousandSeparator=","
                                                  formControlName="monthTotal_overall" />
                                              </td>
                                              <td *ngFor="
                                                let column of monthList_1;
                                                let j = index
                                              ">
                                                <input class="form-control" type="text" [readonly]="true"
                                                  mask="separator.2" thousandSeparator="," formControlName="monthTotal{{
                                                  j + 1
                                                }}" />
                                              </td>
                                            </tr>
                                          </tfoot>
                                        </table>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </form>

                      <form *ngIf="i == 5" [formGroup]="monthForm5">
                        <div class="row mt-5">
                          <div class="col-md-11">
                            <h4>Monthly Investment Plan ({{ ym }})</h4>
                            <hr />
                          </div>
                          <div class="col-md-1">
                            <button class="btn btn-info" data-toggle="collapse" data-target="#M6">
                              +
                            </button>
                          </div>
                        </div>

                        <div class="container collapse" id="M6">
                          <div class="row">
                            <div class="col-md-12">
                              <div class="card text card-initiative">
                                <div class="form-initiative">
                                  <div class="form-row align-items-center">
                                    <div class="w-100">
                                      <div class="table-responsive">
                                        <table class="table table-bordered">
                                          <thead class="text-center bg-light">
                                            <tr>
                                              <th width="200px">
                                                Investment Plan
                                              </th>
                                              <th width="180px">Overall</th>
                                              <th width="180px" *ngFor="let m of monthList_x">
                                                {{ m.columnname }}
                                              </th>
                                            </tr>
                                          </thead>
                                          <tbody>
                                            <tr formArrayName="monthForm_list" *ngFor="
                                              let cd of monthForm5_.controls;
                                              let j = index
                                            ">
                                              <td [formGroupName]="j">
                                                <select class="form-control" formControlName="currencyTitle"
                                                  disabled="flagFirst_row">
                                                  <option *ngFor="
                                                    let t of typeTransaction_month
                                                  " [value]="t.code">{{ t.chooes }}
                                                  </option>
                                                </select>
                                                <label class="mt-3" for="finishDate" *ngIf="j != 0">
                                                  FX
                                                </label>
                                                <input formControlName="fx" class="form-control" type="text"
                                                  *ngIf="j != 0" readonly="true" />
                                              </td>
                                              <td [formGroupName]="j">
                                                <input class="form-control" type="text" formControlName="overall"
                                                  mask="separator.2" thousandSeparator="," [readonly]="true" />
                                              </td>
                                              <ng-container *ngIf="i != diffYear">
                                                <td [formGroupName]="j" *ngFor="
                                                let column of monthList_x;
                                                let jj = index
                                              ">
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == true
                                                " class="form-control ; border-danger" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table6(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                    mask="separator" thousandSeparator="," />
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == false
                                                " class="form-control" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table6(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                    mask="separator" thousandSeparator="," />
                                                </td>
                                              </ng-container>
                                              <ng-container *ngIf="i == diffYear">
                                                <td [formGroupName]="j" *ngFor="
                                                let column of monthList_last;
                                                let jj = index
                                              ">
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == true
                                                " class="form-control ; border-danger" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table6(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                    mask="separator" thousandSeparator="," />
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == false
                                                " class="form-control" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table6(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                    mask="separator" thousandSeparator="," />
                                                </td>
                                              </ng-container>
                                            </tr>
                                          </tbody>
                                          <tfoot>
                                            <tr>
                                              <td>
                                                <label for="finishDate">
                                                  Total Baht
                                                </label>
                                              </td>
                                              <td>
                                                <input class="form-control" type="text" [readonly]="true"
                                                  mask="separator.2" thousandSeparator=","
                                                  formControlName="monthTotal_overall" />
                                              </td>
                                              <td *ngFor="
                                                let column of monthList_1;
                                                let j = index
                                              ">
                                                <input class="form-control" type="text" [readonly]="true"
                                                  mask="separator.2" thousandSeparator="," formControlName="monthTotal{{
                                                  j + 1
                                                }}" />
                                              </td>
                                            </tr>
                                          </tfoot>
                                        </table>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </form>

                      <form *ngIf="i == 6" [formGroup]="monthForm6">
                        <div class="row mt-5">
                          <div class="col-md-11">
                            <h4>Monthly Investment Plan ({{ ym }})</h4>
                            <hr />
                          </div>
                          <div class="col-md-1">
                            <button class="btn btn-info" data-toggle="collapse" data-target="#M7">
                              +
                            </button>
                          </div>
                        </div>

                        <div class="container collapse" id="M7">
                          <div class="row">
                            <div class="col-md-12">
                              <div class="card text card-initiative">
                                <div class="form-initiative">
                                  <div class="form-row align-items-center">
                                    <div class="w-100">
                                      <div class="table-responsive">
                                        <table class="table table-bordered">
                                          <thead class="text-center bg-light">
                                            <tr>
                                              <th width="200px">
                                                Investment Plan
                                              </th>
                                              <th width="180px">Overall</th>
                                              <th width="180px" *ngFor="let m of monthList_x">
                                                {{ m.columnname }}
                                              </th>
                                            </tr>
                                          </thead>
                                          <tbody>
                                            <tr formArrayName="monthForm_list" *ngFor="
                                              let cd of monthForm6_.controls;
                                              let j = index
                                            ">
                                              <td [formGroupName]="j">
                                                <select class="form-control" formControlName="currencyTitle"
                                                  disabled="flagFirst_row">
                                                  <option *ngFor="
                                                    let t of typeTransaction_month
                                                  " [value]="t.code">{{ t.chooes }}
                                                  </option>
                                                </select>
                                                <label class="mt-3" for="finishDate" *ngIf="j != 0">
                                                  FX
                                                </label>
                                                <input formControlName="fx" class="form-control" type="text"
                                                  *ngIf="j != 0" readonly="true" />
                                              </td>
                                              <td [formGroupName]="j">
                                                <input class="form-control" type="text" formControlName="overall"
                                                  mask="separator.2" thousandSeparator="," [readonly]="true" />
                                              </td>
                                              <ng-container *ngIf="i != diffYear">
                                                <td [formGroupName]="j" *ngFor="
                                                let column of monthList_x;
                                                let jj = index
                                              ">
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == true
                                                " class="form-control ; border-danger" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table7(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                    mask="separator" thousandSeparator="," />
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == false
                                                " class="form-control" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table7(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                    mask="separator" thousandSeparator="," />
                                                </td>
                                              </ng-container>
                                              <ng-container *ngIf="i == diffYear">
                                                <td [formGroupName]="j" *ngFor="
                                                let column of monthList_last;
                                                let jj = index
                                              ">
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == true
                                                " class="form-control ; border-danger" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table7(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                    mask="separator" thousandSeparator="," />
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == false
                                                " class="form-control" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table7(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                    mask="separator" thousandSeparator="," />
                                                </td>
                                              </ng-container>
                                            </tr>
                                          </tbody>
                                          <tfoot>
                                            <tr>
                                              <td>
                                                <label for="finishDate">
                                                  Total Baht
                                                </label>
                                              </td>
                                              <td>
                                                <input class="form-control" type="text" [readonly]="true"
                                                  mask="separator.2" thousandSeparator=","
                                                  formControlName="monthTotal_overall" />
                                              </td>
                                              <td *ngFor="
                                                let column of monthList_1;
                                                let j = index
                                              ">
                                                <input class="form-control" type="text" [readonly]="true"
                                                  mask="separator.2" thousandSeparator="," formControlName="monthTotal{{
                                                  j + 1
                                                }}" />
                                              </td>
                                            </tr>
                                          </tfoot>
                                        </table>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </form>

                      <form *ngIf="i == 7" [formGroup]="monthForm7">
                        <div class="row mt-5">
                          <div class="col-md-11">
                            <h4>Monthly Investment Plan ({{ ym }})</h4>
                            <hr />
                          </div>
                          <div class="col-md-1">
                            <button class="btn btn-info" data-toggle="collapse" data-target="#M8">
                              +
                            </button>
                          </div>
                        </div>

                        <div class="container collapse" id="M8">
                          <div class="row">
                            <div class="col-md-12">
                              <div class="card text card-initiative">
                                <div class="form-initiative">
                                  <div class="form-row align-items-center">
                                    <div class="w-100">
                                      <div class="table-responsive">
                                        <table class="table table-bordered">
                                          <thead class="text-center bg-light">
                                            <tr>
                                              <th width="200px">
                                                Investment Plan
                                              </th>
                                              <th width="180px">Overall</th>
                                              <th width="180px" *ngFor="let m of monthList_x">
                                                {{ m.columnname }}
                                              </th>
                                            </tr>
                                          </thead>
                                          <tbody>
                                            <tr formArrayName="monthForm_list" *ngFor="
                                              let cd of monthForm7_.controls;
                                              let j = index
                                            ">
                                              <td [formGroupName]="j">
                                                <select class="form-control" formControlName="currencyTitle"
                                                  disabled="flagFirst_row">
                                                  <option *ngFor="
                                                    let t of typeTransaction_month
                                                  " [value]="t.code">{{ t.chooes }}
                                                  </option>
                                                </select>
                                                <label class="mt-3" for="finishDate" *ngIf="j != 0">
                                                  FX
                                                </label>
                                                <input formControlName="fx" class="form-control" type="text"
                                                  *ngIf="j != 0" readonly="true" />
                                              </td>
                                              <td [formGroupName]="j">
                                                <input class="form-control" type="text" formControlName="overall"
                                                  mask="separator.2" thousandSeparator="," [readonly]="true" />
                                              </td>
                                              <ng-container *ngIf="i != diffYear">
                                                <td [formGroupName]="j" *ngFor="
                                                let column of monthList_x;
                                                let jj = index
                                              ">
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == true
                                                " class="form-control ; border-danger" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table8(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                    mask="separator" thousandSeparator="," />
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == false
                                                " class="form-control" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table8(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                    mask="separator" thousandSeparator="," />
                                                </td>
                                              </ng-container>
                                              <ng-container *ngIf="i == diffYear">
                                                <td [formGroupName]="j" *ngFor="
                                                let column of monthList_last;
                                                let jj = index
                                              ">
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == true
                                                " class="form-control ; border-danger" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table8(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                    mask="separator" thousandSeparator="," />
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == false
                                                " class="form-control" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table8(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                    mask="separator" thousandSeparator="," />
                                                </td>
                                              </ng-container>
                                            </tr>
                                          </tbody>
                                          <tfoot>
                                            <tr>
                                              <td>
                                                <label for="finishDate">
                                                  Total Baht
                                                </label>
                                              </td>
                                              <td>
                                                <input class="form-control" type="text" [readonly]="true"
                                                  mask="separator.2" thousandSeparator=","
                                                  formControlName="monthTotal_overall" />
                                              </td>
                                              <td *ngFor="
                                                let column of monthList_1;
                                                let j = index
                                              ">
                                                <input class="form-control" type="text" [readonly]="true"
                                                  mask="separator.2" thousandSeparator="," formControlName="monthTotal{{
                                                  j + 1
                                                }}" />
                                              </td>
                                            </tr>
                                          </tfoot>
                                        </table>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </form>

                      <form *ngIf="i == 8" [formGroup]="monthForm8">
                        <div class="row mt-5">
                          <div class="col-md-11">
                            <h4>Monthly Investment Plan ({{ ym }})</h4>
                            <hr />
                          </div>
                          <div class="col-md-1">
                            <button class="btn btn-info" data-toggle="collapse" data-target="#M9">
                              +
                            </button>
                          </div>
                        </div>

                        <div class="container collapse" id="M9">
                          <div class="row">
                            <div class="col-md-12">
                              <div class="card text card-initiative">
                                <div class="form-initiative">
                                  <div class="form-row align-items-center">
                                    <div class="w-100">
                                      <div class="table-responsive">
                                        <table class="table table-bordered">
                                          <thead class="text-center bg-light">
                                            <tr>
                                              <th width="200px">
                                                Investment Plan
                                              </th>
                                              <th width="180px">Overall</th>
                                              <th width="180px" *ngFor="let m of monthList_x">
                                                {{ m.columnname }}
                                              </th>
                                            </tr>
                                          </thead>
                                          <tbody>
                                            <tr formArrayName="monthForm_list" *ngFor="
                                              let cd of monthForm8_.controls;
                                              let j = index
                                            ">
                                              <td [formGroupName]="j">
                                                <select class="form-control" formControlName="currencyTitle"
                                                  disabled="flagFirst_row">
                                                  <option *ngFor="
                                                    let t of typeTransaction_month
                                                  " [value]="t.code">{{ t.chooes }}
                                                  </option>
                                                </select>
                                                <label class="mt-3" for="finishDate" *ngIf="j != 0">
                                                  FX
                                                </label>
                                                <input formControlName="fx" class="form-control" type="text"
                                                  *ngIf="j != 0" readonly="true" />
                                              </td>
                                              <td [formGroupName]="j">
                                                <input class="form-control" type="text" formControlName="overall"
                                                  mask="separator.2" thousandSeparator="," [readonly]="true" />
                                              </td>
                                              <ng-container *ngIf="i != diffYear">
                                                <td [formGroupName]="j" *ngFor="
                                                let column of monthList_x;
                                                let jj = index
                                              ">
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == true
                                                " class="form-control ; border-danger" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table9(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                    mask="separator" thousandSeparator="," />
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == false
                                                " class="form-control" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table9(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                    mask="separator" thousandSeparator="," />
                                                </td>
                                              </ng-container>
                                              <ng-container *ngIf="i == diffYear">
                                                <td [formGroupName]="j" *ngFor="
                                                let column of monthList_last;
                                                let jj = index
                                              ">
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == true
                                                " class="form-control ; border-danger" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table9(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                    mask="separator" thousandSeparator="," />
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == false
                                                " class="form-control" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table9(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                    mask="separator" thousandSeparator="," />
                                                </td>
                                              </ng-container>
                                            </tr>
                                          </tbody>
                                          <tfoot>
                                            <tr>
                                              <td>
                                                <label for="finishDate">
                                                  Total Baht
                                                </label>
                                              </td>
                                              <td *ngFor="
                                                let column of monthList_1;
                                                let j = index
                                              ">
                                                <input class="form-control" type="text" [readonly]="true"
                                                  mask="separator.2" thousandSeparator="," formControlName="monthTotal{{
                                                  j + 1
                                                }}" />
                                              </td>
                                              <td>
                                                <input class="form-control" type="text" [readonly]="true"
                                                  mask="separator.2" thousandSeparator=","
                                                  formControlName="monthTotal_overall" />
                                              </td>
                                            </tr>
                                          </tfoot>
                                        </table>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </form>

                      <form *ngIf="i == 9" [formGroup]="monthForm9">
                        <div class="row mt-5">
                          <div class="col-md-11">
                            <h4>Monthly Investment Plan ({{ ym }})</h4>
                            <hr />
                          </div>
                          <div class="col-md-1">
                            <button class="btn btn-info" data-toggle="collapse" data-target="#M10">
                              +
                            </button>
                          </div>
                        </div>

                        <div class="container collapse" id="M10">
                          <div class="row">
                            <div class="col-md-12">
                              <div class="card text card-initiative">
                                <div class="form-initiative">
                                  <div class="form-row align-items-center">
                                    <div class="w-100">
                                      <div class="table-responsive">
                                        <table class="table table-bordered">
                                          <thead class="text-center bg-light">
                                            <tr>
                                              <th width="200px">
                                                Investment Plan
                                              </th>
                                              <th width="180px">Overall</th>
                                              <th width="180px" *ngFor="let m of monthList_x">
                                                {{ m.columnname }}
                                              </th>
                                            </tr>
                                          </thead>
                                          <tbody>
                                            <tr formArrayName="monthForm_list" *ngFor="
                                              let cd of monthForm9_.controls;
                                              let j = index
                                            ">
                                              <td [formGroupName]="j">
                                                <select class="form-control" formControlName="currencyTitle"
                                                  disabled="flagFirst_row">
                                                  <option *ngFor="
                                                    let t of typeTransaction_month
                                                  " [value]="t.code">{{ t.chooes }}
                                                  </option>
                                                </select>
                                                <label class="mt-3" for="finishDate" *ngIf="j != 0">
                                                  FX
                                                </label>
                                                <input formControlName="fx" class="form-control" type="text"
                                                  *ngIf="j != 0" readonly="true" />
                                              </td>

                                              <td [formGroupName]="j">
                                                <input class="form-control" type="text" formControlName="overall"
                                                  mask="separator.2" thousandSeparator="," [readonly]="true" />
                                              </td>
                                              <ng-container *ngIf="i != diffYear">
                                                <td [formGroupName]="j" *ngFor="
                                                let column of monthList_x;
                                                let jj = index
                                              ">
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == true
                                                " class="form-control ; border-danger" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table10(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                    mask="separator" thousandSeparator="," />
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == false
                                                " class="form-control" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table10(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                    mask="separator" thousandSeparator="," />
                                                </td>
                                              </ng-container>
                                              <ng-container *ngIf="i == diffYear">
                                                <td [formGroupName]="j" *ngFor="
                                                let column of monthList_last;
                                                let jj = index
                                              ">
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == true
                                                " class="form-control ; border-danger" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table10(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="test" pattern="[0-9]*"
                                                    mask="separator" thousandSeparator="," />
                                                  <input *ngIf="
                                                  cd.get('flag_alert')
                                                    .value == false
                                                " class="form-control" formControlName="m{{
                                                  jj + 1
                                                }}" [readonly]="column.readOnly" (change)="
                                                  ChangingValue_month_table10(
                                                    ym
                                                  )
                                                " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                    mask="separator" thousandSeparator="," />
                                                </td>
                                              </ng-container>
                                            </tr>
                                          </tbody>
                                          <tfoot>
                                            <tr>
                                              <td>
                                                <label for="finishDate">
                                                  Total Baht
                                                </label>
                                              </td>
                                              <td>
                                                <input class="form-control" type="text" [readonly]="true"
                                                  mask="separator.2" thousandSeparator=","
                                                  formControlName="monthTotal_overall" />
                                              </td>
                                              <td *ngFor="
                                                let column of monthList_1;
                                                let j = index
                                              ">
                                                <input class="form-control" type="text" [readonly]="true"
                                                  mask="separator.2" thousandSeparator="," formControlName="monthTotal{{
                                                  j + 1
                                                }}" />
                                              </td>
                                            </tr>
                                          </tfoot>
                                        </table>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </form>
                    </div>
                  </div>

                  <!-- End Table -->
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </tab>

  <tab heading="Status" (selectTab)="changeTab($event)" class="d-none">
    <app-status-form [id]="id"></app-status-form>
  </tab>
</tabset>

<div class="col-md-12">
  <div class="card text card-initiative">
    <div class="form-group row mt-5">
      <div class="col-md-6">
        <h3>{{ name }}</h3>
      </div>
      <div class="col-md-6" *ngIf="status != 'draft'">
        <div class="w-20 float-right">
          <app-button-view-revision [id]="id"></app-button-view-revision>
        </div>
      </div>
      <div class="col-md-12">
        <hr />
      </div>
    </div>
    <div class="container mt-3 my-1">
      <div class="row">
        <div class="col-md-12">
          <!-- <app-initiative-information [id]="id" [CapexType]="CapexType"></app-initiative-information> -->

          <div class="information">
            <div class="card bg-light">
              <div class="card-body">
                <div class="row">
                  <div class="col-md-2 text-right">
                    <p class="font-weight-bolder">Initiative ID :</p>
                  </div>
                  <div class="col-md-4">
                    <p>
                      {{ InitiativeDetail.code }}
                    </p>
                  </div>
                  <ng-container *ngIf="InitiativeDetail.stage">
                    <div class="col-md-2 text-right">
                      <p class="font-weight-bolder">Stage :</p>
                    </div>
                    <div class="col-md-4">
                      <p>
                        {{ InitiativeDetail.stage }}
                      </p>
                    </div>
                  </ng-container>
                </div>
              </div>
            </div>

            <br />

            <div class="card bg-light">
              <div class="card-body">
                <div class="row" *ngIf="
                    GetRevision.Revistion != null ||
                    GetRevision.Revistion != undefined
                  ">
                  <div class="col-md-2 text-right">
                    <p class="font-weight-bolder">Revistion No. :</p>
                  </div>
                  <div class="col-md-4">
                    <p>
                      {{ GetRevision.Revistion }}
                    </p>
                  </div>
                </div>

                <div class="row">
                  <div class="col-md-2 text-right">
                    <p class="font-weight-bolder">Initiative Name :</p>
                  </div>
                  <div class="col-md-4">
                    <p>
                      {{ InitiativeDetail.name }}
                    </p>
                  </div>
                  <div class="col-md-2 text-right">
                    <p class="font-weight-bolder">Initiative Year :</p>
                  </div>
                  <div class="col-md-4">
                    <p>
                      {{ InitiativeDetail.year }}
                    </p>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-2 text-right">
                    <p class="font-weight-bolder">Owner Name :</p>
                  </div>
                  <div class="col-md-4">
                    <p>
                      {{ InitiativeDetail.owner }}
                    </p>
                  </div>

                  <div class="col-md-2 text-right">
                    <p class="font-weight-bolder">Organization :</p>
                  </div>
                  <div class="col-md-4">
                    <p>
                      {{ InitiativeDetail.organization }}
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="card text card-initiative">
            <form *ngIf="Initiative_tmp" [formGroup]="InitiativeDetailForm">
              <div class="row mt-5">
                <div class="col-md-12">
                  <h4>Initiative Detail</h4>
                  <hr />
                </div>
                <div class="col-md-6">
                  <label for="StartingDate">
                    Starting Date <span class="text-danger">*</span> :
                  </label>

                  <div class="input-group">
                    <input formControlName="StartingDate" (bsValueChange)="
                        setStartingDate(StartingDate_1.value)
                      " type="text" #StartingDate_1 class="form-control" [bsConfig]="bsConfigStart" bsDatepicker
                      name="StartingDate_1" #dpStart="bsDatepicker" [triggers]="viewMode ? '' : 'click:click'"
                      [ngClass]="{ 'is-invalid': invalidStartingDate }" />

                    <div *ngIf="!viewMode" class="input-group-append">
                      <i class="far fa-calendar right-icon mt-2" (click)="dpStart.toggle()"
                        [attr.aria-expanded]="dpStart.isOpen"></i>
                    </div>
                    <div class="invalid-feedback" *ngIf="invalidStartingDate">
                      Starting Date is required !
                    </div>
                  </div>
                </div>
                <div class="col-md-6">
                  <label for="ProjecctComRun">
                    Finish Date <span class="text-danger">*</span> :
                  </label>
                  <div class="input-group">
                    <input formControlName="ProjecctComRun" (bsValueChange)="
                        setFinishDate(ProjecctComRun_1.value)
                      " type="text" #ProjecctComRun_1 class="form-control" [bsConfig]="bsConfigFinish" bsDatepicker
                      name="ProjecctComRun_1" #dpFinish="bsDatepicker" [triggers]="viewMode ? '' : 'click:click'"
                      [ngClass]="{ 'is-invalid': invalidFinishingDate }" />

                    <div *ngIf="!viewMode" class="input-group-append">
                      <i class="far fa-calendar right-icon mt-2" (click)="dpFinish.toggle()"
                        [attr.aria-expanded]="dpFinish.isOpen"></i>
                    </div>
                    <div class="invalid-feedback" *ngIf="invalidFinishingDate">
                      Finish Date is required !
                    </div>
                  </div>
                </div>
              </div>

              <div class="row mt-3">
                <div class="col-md-6">
                  <label for="RequestIniNoDate">
                    Request Project No. Date (Budget Start Date)
                    <span class="text-danger">*</span> :
                  </label>
                  <div class="input-group">
                    <input formControlName="RequestIniNoDate" (bsValueChange)="
                        setRequestDate(RequestIniNoDate_1.value)
                      " type="text" #RequestIniNoDate_1 class="form-control" [bsConfig]="bsConBetween" bsDatepicker
                      name="RequestIniNoDate_1" #dpBudget="bsDatepicker" [triggers]="viewMode ? '' : 'click:click'"
                      [ngClass]="{ 'is-invalid': invalidRequestIniNoDate }" />

                    <div *ngIf="!viewMode" class="input-group-append">
                      <i class="far fa-calendar right-icon mt-2" (click)="dpBudget.toggle()"
                        [attr.aria-expanded]="dpBudget.isOpen"></i>
                    </div>
                    <div class="invalid-feedback" *ngIf="invalidRequestIniNoDate">
                      Request Project No. Date (Budget Start Date) is
                      required !
                    </div>
                  </div>
                </div>
                <div class="col-md-6">
                  <label for="finishDate">
                    Project Execution Period
                    <span class="text-danger">*</span> :
                  </label>
                  <div class="row">
                    <div class="col-md-3">
                      <input type="text" class="form-control" value="ProjectExePeriodYear"
                        formControlName="ProjectExePeriodYear" readonly />
                    </div>
                    <div class="col-md-3 p-2">
                      <span>Year</span>
                    </div>
                    <div class="col-md-3">
                      <input type="text" class="form-control" value="ProjectExePeriodMonth"
                        formControlName="ProjectExePeriodMonth" readonly />
                    </div>
                    <div class="col-md-3 p-2">
                      <span>Month</span>
                    </div>
                  </div>
                </div>
              </div>

              <div class="row mt-3">
                <div class="col-md-6">
                  <label for="CostCenterOfVP">
                    Cost Center of VP (Asset Owner)
                    <span class="text-danger">*</span> :
                  </label>

                  <ng-select formControlName="CostCenterOfVP" [items]="owners" bindValue="ownerName"
                    bindLabel="ownerName" placeholder="Choose Owner" (search)="SearchOwnerName($event)"
                    (clear)="ClearOwnerName()" [ngClass]="{ 'is-invalid': invalidOrganization }">
                  </ng-select>

                  <div class="text-feedback" *ngIf="invalidOrganization">
                    Cost Center of VP is required !
                  </div>
                </div>
                <div class="col-md-6">
                  <label for="finishDate">
                    Code Of Cost Center of VP (Asset Owner)
                    <span class="text-danger">*</span> :
                  </label>
                  <input formControlName="CodeCostCenterOfVP" type="text" name="CodeCostCenterOfVP" class="form-control"
                    placeholder="" [ngClass]="{ 'is-invalid': invalidCodeCostCenterOfVP }"
                    [(ngModel)]="CodeCostCenterOfVP" />

                  <div class="invalid-feedback" *ngIf="invalidCodeCostCenterOfVP">
                    Code Of Cost Center of VP is required !
                  </div>
                </div>
              </div>

              <div class="row mt-3">
                <div class="col-md-6">
                  <label for="finishDate">
                    Project Cost (MTHB) <span class="text-danger">*</span> :
                  </label>
                  <input formControlName="ProjectCost" #ProjectCost_tmp (blur)="setProjectCost(ProjectCost_tmp.value)"
                    type="text" name="ProjectCost" class="form-control" placeholder="0.00" thousandSeparator=","
                    step="0.01" mask="separator.2" [ngClass]="{ 'is-invalid': invalidCostEstCapex }" />

                  <div class="invalid-feedback" *ngIf="invalidCostEstCapex">
                    Project Cost (MTHB) is required !
                  </div>
                </div>
              </div>

              <div class="row mt-3 d-none">
                <div class="col-md-12" *ngIf="RemarkShow == true">
                  <label for="finishDate">
                    Reason of changing Project Cost
                    <span class="text-danger">*</span>
                    :
                  </label>
                  <textarea class="form-control" id="ReasonOfChanging" rows="2" name="ReasonOfChanging"
                    formControlName="ReasonOfChanging">
                  </textarea>
                </div>
              </div>

              <div class="row mt-3">
                <div class="col-md-2">
                  <label for="BudgetForm">
                    Budget Period <span class="text-danger">*</span> :
                  </label>
                </div>
                <div class="col-md-10">
                  <div class="custom-control custom-radio custom-control-inline">
                    <input id="Annual" value="Annual" disabled class="custom-control-input" type="radio"
                      name="BudgetForm" formControlName="BudgetForm" (change)="OnChangeRequestOPEX($event.target.value)"
                      [ngClass]="{ 'is-invalid': invalidBudget }" />
                    <label class="custom-control-label" for="Annual">
                      Annual ({{ year_next }})
                    </label>
                  </div>
                </div>
                <div class="col-md-2"></div>
                <div class="col-md-10 mt-1">
                  <div class="custom-control custom-radio custom-control-inline">
                    <input id="MidYear" value="Mid Year" disabled class="custom-control-input" type="radio"
                      name="BudgetForm" formControlName="BudgetForm" (change)="OnChangeRequestOPEX($event.target.value)"
                      [ngClass]="{ 'is-invalid': invalidBudget }" />
                    <label class="custom-control-label" for="MidYear">
                      Mid Year ({{ year_now }})
                    </label>
                  </div>
                </div>
                <div class="col-md-2"></div>
                <div class="col-md-10 mt-2 d-none">
                  <div class="custom-control custom-radio custom-control-inline">
                    <input id="Between" value="Current year" class="custom-control-input" type="radio" name="BudgetForm"
                      formControlName="BudgetForm" (change)="OnChangeRequestOPEX($event.target.value)"
                      [ngClass]="{ 'is-invalid': invalidBudget }" />
                    <label class="custom-control-label" for="Between">
                      Current year
                    </label>
                  </div>
                </div>

                <div class="row mt-3 sub-Between" *ngIf="showContingency">
                  <div class="col-md-12">
                    <div class="custom-control custom-radio custom-control-inline">
                      <input id="Contingency" value="Contingency" class="custom-control-input" type="radio"
                        name="BetweenYear" formControlName="BetweenYear"
                        (change)="OnChangeBetweenYear($event.target.value)"
                        [ngClass]="{ 'is-invalid': invalidBudget }" />
                      <label class="custom-control-label" for="Contingency">
                        Contingency ({{ year_now }})
                      </label>
                    </div>
                  </div>
                  <div class="col-md-12 mt-2">
                    <div class="custom-control custom-radio custom-control-inline">
                      <input id="Transfer" value="Transfer" class="custom-control-input" type="radio" name="BetweenYear"
                        formControlName="BetweenYear" (change)="OnChangeBetweenYear($event.target.value)"
                        [ngClass]="{ 'is-invalid': invalidBudget }" />
                      <label class="custom-control-label" for="Transfer">
                        Transfer ({{ year_now }})
                      </label>
                    </div>
                  </div>
                </div>

                <div class="col-md-12 sub-Transfer">
                  <div *ngIf="inshow">
                    <label for="TransferForm">
                      Transfer Form <span class="text-danger">*</span> :
                    </label>
                    <div class="input-group" id="Form" style="width: 50%;">
                      <select formControlName="TransferForm" name="TransferForm" value="TransferForm"
                        class="form-control" (change)="transfer($event.target.value)">
                        <option value="" selected disabled>
                          Choose...</option>
                        <option value="OPEX">OPEX</option>
                        <option value="RMA">RMA</option>
                      </select>
                    </div>
                  </div>
                </div>

                <div class="row sub-Between" *ngIf="showContingency">
                  <div class="col-md-12 mt-2">
                    <div class="custom-control custom-radio custom-control-inline">
                      <input id="Pool" value="Pool Budget" class="custom-control-input" type="radio" name="BetweenYear"
                        formControlName="BetweenYear" (change)="OnChangeBetweenYear($event.target.value)" />
                      <label class="custom-control-label" for="Pool">
                        Pool Budget ({{ year_now }})
                      </label>
                    </div>
                  </div>
                </div>

                <div class="col-md-12 mt-3 sub-Transfer">
                  <div *ngIf="ferPool">
                    <label for="TransferForm">
                      Pool Budget From <span class="text-danger">*</span> :
                    </label>
                    <div class="input-group" id="Form" style="width: 50%;">
                      <select class="form-control" formControlName="PoolBudgetForm" name="PoolBudgetForm"
                        value="PoolBudgetForm" (change)="pool($event.target.value)">
                        <option value="" selected disabled>
                          Choose...
                        </option>
                        <option value="MAX">MAX</option>
                        <option value="DIM">DIM</option>
                        <option value="PIM">PIM</option>
                        <option value="ER">ER</option>
                        <option value="MTPi">MTPi</option>
                      </select>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Start Table -->
              <!---->

              <div class="row mt-5">
                <div class="col-md-12">
                  <h4>Annual Investment Plan</h4>
                  <hr />
                </div>
              </div>

              <div *ngIf="disableTable == 'true'">
                <form *ngIf="AnnualForm" [formGroup]="AnnualForm">
                  <div class="container">
                    <div class="row">
                      <div class="col-md-12">
                        <div class="card text card-initiative">
                          <div class="form-initiative">
                            <div class="form-row align-items-center">
                              <div class="w-100">
                                <div class="table-responsive">
                                  <table class="table table-bordered">
                                    <thead class="text-center bg-light">
                                      <tr>
                                        <th width="200px">
                                          Investment Plan
                                        </th>
                                        <th width="100px">Overall</th>
                                        <th width="100px" *ngFor="
                                            let column of YearTable_capex;
                                            let i = index
                                          ">
                                          {{ column.columnname }}
                                        </th>
                                      </tr>
                                    </thead>
                                    <tbody>
                                      <tr formArrayName="annualForm_list" *ngFor="
                                          let cd of annualForm_.controls;
                                          let i = index
                                        ">
                                        <td class="text-center" [formGroupName]="i">
                                          <!-- <select class="form-control">
                                          <option>{{i.currencyTitle}}</option>
                                        </select> -->
                                          <select class="form-control" *ngIf="i == 0" formControlName="currencyTitle"
                                            [attr.disabled]="true">
                                            <option *ngFor="
                                                let t of typeTransaction
                                              " [value]="t.code">
                                              {{ t.chooes }}
                                            </option>
                                          </select>

                                          <select class="form-control" *ngIf="i != 0" formControlName="currencyTitle"
                                            (change)="
                                            changeRate($event.target.value, i)
                                            ">
                                            <option *ngFor="let t of typeTransaction" [value]="t.code">
                                              {{ t.chooes }}</option>
                                          </select>

                                          <label class="mt-3" for="finishDate" *ngIf="i != 0">
                                            FX
                                          </label>

                                          <input formControlName="fx" (change)="ChangingValue_fx(i)" mask="separator.2"
                                            step="0.01" thousandSeparator="," class="form-control" type="text"
                                            *ngIf="i != 0" />

                                          <div *ngIf="!PoolView">
                                            <button [formGroupName]="i" *ngIf="i != 0"
                                              class="btn btn-danger btn-sm mt-3" (click)="deleteSellingPoint(i)">
                                              <i class="fas fa-trash-alt"></i>
                                            </button>
                                          </div>

                                        </td>
                                        <td [formGroupName]="i">
                                          <input class="form-control" type="text" formControlName="overall"
                                            mask="separator.2" step="0.01" thousandSeparator="," [readonly]="true" />
                                        </td>
                                        <td [formGroupName]="i" *ngFor="
                                            let column of YearTable_capex;
                                            let j = index
                                          ">
                                          <input class="form-control" (change)="
                                              ChangingValue(
                                                $event.target.value
                                              )
                                            " formControlName="y{{ j + 1 }}" [readonly]="column.isEdit"
                                            mask="separator.2" step="0.01" thousandSeparator="," />
                                        </td>
                                      </tr>
                                    </tbody>
                                    <tfoot>
                                      <tr>
                                        <td>
                                          <label for="finishDate">
                                            Total Million Baht
                                          </label>
                                        </td>
                                        <td>
                                          <input class="form-control" type="text" [readonly]="true" mask="separator.2"
                                            thousandSeparator="," formControlName="AnnualTotal_overall" />
                                        </td>
                                        <td *ngFor="
                                            let column of YearTable_capex;
                                            let j = index
                                          ">
                                          <input class="form-control" type="text" [readonly]="true" mask="separator.2"
                                            thousandSeparator="," formControlName="AnnualTotal{{
                                              j + 1
                                            }}" />
                                        </td>
                                      </tr>
                                    </tfoot>
                                  </table>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <ng-container *ngIf="!PoolView">
                    <button type="button" class="btn btn-primary mt-3" (click)="addSellingPoint()">
                      Add New
                    </button>
                  </ng-container>
                </form>
              </div>

              <div *ngIf="disableTable == 'true'">
                <div *ngFor="let ym of year_m; let i = index">
                  <form *ngIf="i == 0" [formGroup]="monthForm0">
                    <div class="row mt-5">
                      <div class="col-md-11">
                        <h4>Monthly Investment Plan ({{ ym }})</h4>
                        <hr />
                      </div>
                      <div class="col-md-1">
                        <button class="btn btn-info" data-toggle="collapse" data-target="#M1">
                          +
                        </button>
                      </div>
                    </div>

                    <div class="container collapse" id="M1">
                      <div class="row">
                        <div class="col-md-12">
                          <div class="card text card-initiative">
                            <div class="form-initiative">
                              <div class="form-row align-items-center">
                                <div class="w-100">
                                  <div class="table-responsive">
                                    <table class="table table-bordered">
                                      <thead class="text-center bg-light">
                                        <tr>
                                          <th width="200px">
                                            Investment Plan
                                          </th>
                                          <th width="180px">Overall</th>
                                          <th width="180px" *ngFor="let m of monthList_1">
                                            {{ m.columnname }}
                                          </th>
                                        </tr>
                                      </thead>
                                      <tbody *ngFor="
                                          let cd of monthForm0_.controls;
                                          let j = index
                                        ">
                                        <tr formArrayName="monthForm_list">
                                          <td [formGroupName]="j">
                                            <select class="form-control" formControlName="currencyTitle"
                                              disabled="flagFirst_row">
                                              <option *ngFor="
                                                  let t of typeTransaction_month
                                                " [value]="t.code">{{ t.chooes }}
                                              </option>
                                            </select>
                                            <label class="mt-3" for="finishDate" *ngIf="j != 0">
                                              FX
                                            </label>
                                            <input formControlName="fx" class="form-control" type="text" *ngIf="j != 0"
                                              readonly="true" />
                                          </td>
                                          <td [formGroupName]="j">
                                            <input class="form-control" type="text" formControlName="overall"
                                              mask="separator.2" thousandSeparator="," [readonly]="true" />
                                          </td>
                                          <td [formGroupName]="j" *ngFor="
                                            let column of monthList_1;
                                            let jj = index
                                          ">
                                            <input *ngIf="
                                              cd.get('flag_alert').value ==
                                              true
                                            " class="form-control ; border-danger" formControlName="m{{ jj + 1 }}"
                                              [readonly]="column.readOnly" (change)="
                                              ChangingValue_month_table1(ym)
                                            " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                              mask="separator.0" thousandSeparator="," value="" />
                                            <input *ngIf="
                                              cd.get('flag_alert').value ==
                                              false
                                            " class="form-control" formControlName="m{{ jj + 1 }}"
                                              [readonly]="column.readOnly" (change)="
                                              ChangingValue_month_table1(ym)
                                            " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                              mask="separator.0" thousandSeparator="," />
                                          </td>
                                        </tr>
                                      </tbody>
                                      <tfoot>
                                        <tr>
                                          <td>
                                            <label for="finishDate">
                                              Total Baht
                                            </label>
                                          </td>
                                          <td>
                                            <input class="form-control" type="text" [readonly]="true"
                                              formControlName="monthTotal_overall" mask="separator.2"
                                              thousandSeparator="," />
                                          </td>
                                          <td *ngFor="
                                              let column of monthList_1;
                                              let j = index
                                            ">
                                            <input class="form-control" type="text" [readonly]="true" formControlName="monthTotal{{
                                                j + 1
                                              }}" mask="separator.2" thousandSeparator="," />
                                          </td>
                                        </tr>
                                      </tfoot>
                                    </table>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </form>

                  <form *ngIf="i == 1" [formGroup]="monthForm1">
                    <div class="row mt-5">
                      <div class="col-md-11">
                        <h4>Monthly Investment Plan ({{ ym }})</h4>
                        <hr />
                      </div>
                      <div class="col-md-1">
                        <button class="btn btn-info" data-toggle="collapse" data-target="#M2">
                          +
                        </button>
                      </div>
                    </div>

                    <div class="container collapse" id="M2">
                      <div class="row">
                        <div class="col-md-12">
                          <div class="card text card-initiative">
                            <div class="form-initiative">
                              <div class="form-row align-items-center">
                                <div class="w-100">
                                  <div class="table-responsive">
                                    <table class="table table-bordered">
                                      <thead class="text-center bg-light">
                                        <tr>
                                          <th width="200px">
                                            Investment Plan
                                          </th>
                                          <th width="180px">Overall</th>

                                          <ng-container *ngIf="i != diffYear">
                                            <th width="180px" *ngFor="let m of monthList_x">
                                              {{ m.columnname }}
                                            </th>
                                          </ng-container>
                                          <ng-container *ngIf="i == diffYear">
                                            <th width="180px" *ngFor="
                                                let m of monthList_last
                                              ">
                                              {{ m.columnname }}
                                            </th>
                                          </ng-container>
                                        </tr>
                                      </thead>
                                      <tbody>
                                        <tr formArrayName="monthForm_list" *ngFor="
                                            let cd of monthForm1_.controls;
                                            let j = index
                                          ">
                                          <td [formGroupName]="j">
                                            <select class="form-control" formControlName="currencyTitle"
                                              disabled="flagFirst_row">
                                              <option *ngFor="
                                                  let t of typeTransaction_month
                                                " [value]="t.code">{{ t.chooes }}
                                              </option>
                                            </select>
                                            <label class="mt-3" for="finishDate" *ngIf="j != 0">
                                              FX
                                            </label>
                                            <input formControlName="fx" class="form-control" type="text" *ngIf="j != 0"
                                              readonly="true" />
                                          </td>
                                          <td [formGroupName]="j">
                                            <input class="form-control" type="text" formControlName="overall"
                                              [readonly]="true" mask="separator.2" thousandSeparator="," />
                                          </td>
                                          <ng-container *ngIf="i != diffYear">
                                            <td [formGroupName]="j" *ngFor="
                                              let column of monthList_x;
                                              let jj = index
                                            ">
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == true
                                              " class="form-control ; border-danger" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table2(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                pattern="[0-9]*" mask="separator.0" thousandSeparator="," />
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == false
                                              " class="form-control" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table2(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                pattern="[0-9]*" mask="separator.0" thousandSeparator="," />
                                            </td>
                                          </ng-container>
                                          <ng-container *ngIf="i == diffYear">
                                            <td [formGroupName]="j" *ngFor="
                                              let column of monthList_last;
                                              let jj = index
                                            ">
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == true
                                              " class="form-control ; border-danger" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table2(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                mask="separator.0" thousandSeparator="," />
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == false
                                              " class="form-control" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table2(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                mask="separator.0" thousandSeparator="," />
                                            </td>
                                          </ng-container>
                                        </tr>
                                      </tbody>
                                      <tfoot>
                                        <tr>
                                          <td>
                                            <label for="finishDate">
                                              Total Baht
                                            </label>
                                          </td>
                                          <td>
                                            <input class="form-control" type="text" [readonly]="true"
                                              formControlName="monthTotal_overall" mask="separator.2"
                                              thousandSeparator="," />
                                          </td>
                                          <td *ngFor="
                                              let column of monthList_1;
                                              let j = index
                                            ">
                                            <input class="form-control" type="text" [readonly]="true" formControlName="monthTotal{{
                                                j + 1
                                              }}" mask="separator.2" thousandSeparator="," />
                                          </td>
                                        </tr>
                                      </tfoot>
                                    </table>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </form>

                  <form *ngIf="i == 2" [formGroup]="monthForm2">
                    <div class="row mt-5">
                      <div class="col-md-11">
                        <h4>Monthly Investment Plan ({{ ym }})</h4>
                        <hr />
                      </div>
                      <div class="col-md-1">
                        <button class="btn btn-info" data-toggle="collapse" data-target="#M3">
                          +
                        </button>
                      </div>
                    </div>

                    <div class="container collapse" id="M3">
                      <div class="row">
                        <div class="col-md-12">
                          <div class="card text card-initiative">
                            <div class="form-initiative">
                              <div class="form-row align-items-center">
                                <div class="w-100">
                                  <div class="table-responsive">
                                    <table class="table table-bordered">
                                      <thead class="text-center bg-light">
                                        <tr>
                                          <th width="200px">
                                            Investment Plan
                                          </th>
                                          <th width="180px">Overall</th>
                                          <th width="180px" *ngFor="let m of monthList_x">
                                            {{ m.columnname }}
                                          </th>
                                        </tr>
                                      </thead>
                                      <tbody>
                                        <tr formArrayName="monthForm_list" *ngFor="
                                            let cd of monthForm2_.controls;
                                            let j = index
                                          ">
                                          <td [formGroupName]="j">
                                            <select class="form-control" formControlName="currencyTitle"
                                              disabled="flagFirst_row">
                                              <option *ngFor="
                                                  let t of typeTransaction_month
                                                " [value]="t.code">{{ t.chooes }}
                                              </option>
                                            </select>
                                            <label class="mt-3" for="finishDate" *ngIf="j != 0">
                                              FX
                                            </label>
                                            <input formControlName="fx" class="form-control" type="text" *ngIf="j != 0"
                                              readonly="true" />
                                          </td>
                                          <td [formGroupName]="j">
                                            <input class="form-control" type="text" formControlName="overall"
                                              mask="separator.2" thousandSeparator="," [readonly]="true" />
                                          </td>
                                          <ng-container *ngIf="i != diffYear">
                                            <td [formGroupName]="j" *ngFor="
                                              let column of monthList_x;
                                              let jj = index
                                            ">
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == true
                                              " class="form-control ; border-danger" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table3(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                mask="separator.0" thousandSeparator="," />
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == false
                                              " class="form-control" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table3(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                mask="separator.0" thousandSeparator="," />
                                            </td>
                                          </ng-container>
                                          <ng-container *ngIf="i == diffYear">
                                            <td [formGroupName]="j" *ngFor="
                                              let column of monthList_last;
                                              let jj = index
                                            ">
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == true
                                              " class="form-control ; border-danger" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table3(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                mask="separator.0" thousandSeparator="," />
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == false
                                              " class="form-control" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table3(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                mask="separator.0" thousandSeparator="," />
                                            </td>
                                          </ng-container>
                                        </tr>
                                      </tbody>
                                      <tfoot>
                                        <tr>
                                          <td>
                                            <label for="finishDate">
                                              Total Baht
                                            </label>
                                          </td>
                                          <td>
                                            <input class="form-control" type="text" [readonly]="true"
                                              formControlName="monthTotal_overall" mask="separator.2"
                                              thousandSeparator="," />
                                          </td>
                                          <td *ngFor="
                                              let column of monthList_1;
                                              let j = index
                                            ">
                                            <input class="form-control" type="text" [readonly]="true" formControlName="monthTotal{{
                                                j + 1
                                              }}" mask="separator.2" thousandSeparator="," />
                                          </td>
                                        </tr>
                                      </tfoot>
                                    </table>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </form>

                  <form *ngIf="i == 3" [formGroup]="monthForm3">
                    <div class="row mt-5">
                      <div class="col-md-11">
                        <h4>Monthly Investment Plan ({{ ym }})</h4>
                        <hr />
                      </div>
                      <div class="col-md-1">
                        <button class="btn btn-info" data-toggle="collapse" data-target="#M4">
                          +
                        </button>
                      </div>
                    </div>

                    <div class="container collapse" id="M4">
                      <div class="row">
                        <div class="col-md-12">
                          <div class="card text card-initiative">
                            <div class="form-initiative">
                              <div class="form-row align-items-center">
                                <div class="w-100">
                                  <div class="table-responsive">
                                    <table class="table table-bordered">
                                      <thead class="text-center bg-light">
                                        <tr>
                                          <th width="200px">
                                            Investment Plan
                                          </th>
                                          <th width="180px">Overall</th>
                                          <th width="180px" *ngFor="let m of monthList_x">
                                            {{ m.columnname }}
                                          </th>
                                        </tr>
                                      </thead>
                                      <tbody>
                                        <tr formArrayName="monthForm_list" *ngFor="
                                            let cd of monthForm3_.controls;
                                            let j = index
                                          ">
                                          <td [formGroupName]="j">
                                            <select class="form-control" formControlName="currencyTitle"
                                              disabled="flagFirst_row">
                                              <option *ngFor="
                                                  let t of typeTransaction_month
                                                " [value]="t.code">{{ t.chooes }}
                                              </option>
                                            </select>
                                            <label class="mt-3" for="finishDate" *ngIf="j != 0">
                                              FX
                                            </label>
                                            <input formControlName="fx" class="form-control" type="text" *ngIf="j != 0"
                                              readonly="true" />
                                          </td>
                                          <td [formGroupName]="j">
                                            <input class="form-control" type="text" formControlName="overall"
                                              mask="separator.2" thousandSeparator="," [readonly]="true" />
                                          </td>
                                          <ng-container *ngIf="i != diffYear">
                                            <td [formGroupName]="j" *ngFor="
                                              let column of monthList_x;
                                              let jj = index
                                            ">
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == true
                                              " class="form-control ; border-danger" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table4(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                mask="separator.0" thousandSeparator="," />
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == false
                                              " class="form-control" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table4(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                mask="separator.0" thousandSeparator="," />
                                            </td>
                                          </ng-container>
                                          <ng-container *ngIf="i == diffYear">
                                            <td [formGroupName]="j" *ngFor="
                                              let column of monthList_last;
                                              let jj = index
                                            ">
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == true
                                              " class="form-control ; border-danger" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table4(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                mask="separator.0" thousandSeparator="," />
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == false
                                              " class="form-control" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table4(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                mask="separator.0" thousandSeparator="," />
                                            </td>
                                          </ng-container>
                                        </tr>
                                      </tbody>
                                      <tfoot>
                                        <tr>
                                          <td>
                                            <label for="finishDate">
                                              Total Baht
                                            </label>
                                          </td>
                                          <td>
                                            <input class="form-control" type="text" [readonly]="true" mask="separator.2"
                                              thousandSeparator="," formControlName="monthTotal_overall" />
                                          </td>
                                          <td *ngFor="
                                              let column of monthList_1;
                                              let j = index
                                            ">
                                            <input class="form-control" type="text" [readonly]="true" mask="separator.2"
                                              thousandSeparator="," formControlName="monthTotal{{
                                                j + 1
                                              }}" />
                                          </td>
                                        </tr>
                                      </tfoot>
                                    </table>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </form>

                  <form *ngIf="i == 4" [formGroup]="monthForm4">
                    <div class="row mt-5">
                      <div class="col-md-11">
                        <h4>Monthly Investment Plan ({{ ym }})</h4>
                        <hr />
                      </div>
                      <div class="col-md-1">
                        <button class="btn btn-info" data-toggle="collapse" data-target="#M5">
                          +
                        </button>
                      </div>
                    </div>

                    <div class="container collapse" id="M5">
                      <div class="row">
                        <div class="col-md-12">
                          <div class="card text card-initiative">
                            <div class="form-initiative">
                              <div class="form-row align-items-center">
                                <div class="w-100">
                                  <div class="table-responsive">
                                    <table class="table table-bordered">
                                      <thead class="text-center bg-light">
                                        <tr>
                                          <th width="200px">
                                            Investment Plan
                                          </th>
                                          <th width="180px">Overall</th>
                                          <th width="180px" *ngFor="let m of monthList_x">
                                            {{ m.columnname }}
                                          </th>
                                        </tr>
                                      </thead>
                                      <tbody>
                                        <tr formArrayName="monthForm_list" *ngFor="
                                            let cd of monthForm4_.controls;
                                            let j = index
                                          ">
                                          <td [formGroupName]="j">
                                            <select class="form-control" formControlName="currencyTitle"
                                              disabled="flagFirst_row">
                                              <option *ngFor="
                                                  let t of typeTransaction_month
                                                " [value]="t.code">{{ t.chooes }}
                                              </option>
                                            </select>
                                            <label class="mt-3" for="finishDate" *ngIf="j != 0">
                                              FX
                                            </label>
                                            <input formControlName="fx" class="form-control" type="text" *ngIf="j != 0"
                                              readonly="true" />
                                          </td>
                                          <td [formGroupName]="j">
                                            <input class="form-control" type="text" formControlName="overall"
                                              mask="separator.2" thousandSeparator="," [readonly]="true" />
                                          </td>
                                          <ng-container *ngIf="i != diffYear">
                                            <td [formGroupName]="j" *ngFor="
                                              let column of monthList_x;
                                              let jj = index
                                            ">
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == true
                                              " class="form-control ; border-danger" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table5(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                mask="separator.0" thousandSeparator="," />
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == false
                                              " class="form-control" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table5(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                mask="separator.0" thousandSeparator="," />
                                            </td>
                                          </ng-container>
                                          <ng-container *ngIf="i == diffYear">
                                            <td [formGroupName]="j" *ngFor="
                                              let column of monthList_last;
                                              let jj = index
                                            ">
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == true
                                              " class="form-control ; border-danger" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table5(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                mask="separator.0" thousandSeparator="," />
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == false
                                              " class="form-control" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table5(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                mask="separator.0" thousandSeparator="," />
                                            </td>
                                          </ng-container>
                                        </tr>
                                      </tbody>
                                      <tfoot>
                                        <tr>
                                          <td>
                                            <label for="finishDate">
                                              Total Baht
                                            </label>
                                          </td>
                                          <td>
                                            <input class="form-control" type="text" [readonly]="true" mask="separator.2"
                                              thousandSeparator="," formControlName="monthTotal_overall" />
                                          </td>
                                          <td *ngFor="
                                              let column of monthList_1;
                                              let j = index
                                            ">
                                            <input class="form-control" type="text" [readonly]="true" mask="separator.2"
                                              thousandSeparator="," formControlName="monthTotal{{
                                                j + 1
                                              }}" />
                                          </td>
                                        </tr>
                                      </tfoot>
                                    </table>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </form>

                  <form *ngIf="i == 5" [formGroup]="monthForm5">
                    <div class="row mt-5">
                      <div class="col-md-11">
                        <h4>Monthly Investment Plan ({{ ym }})</h4>
                        <hr />
                      </div>
                      <div class="col-md-1">
                        <button class="btn btn-info" data-toggle="collapse" data-target="#M6">
                          +
                        </button>
                      </div>
                    </div>

                    <div class="container collapse" id="M6">
                      <div class="row">
                        <div class="col-md-12">
                          <div class="card text card-initiative">
                            <div class="form-initiative">
                              <div class="form-row align-items-center">
                                <div class="w-100">
                                  <div class="table-responsive">
                                    <table class="table table-bordered">
                                      <thead class="text-center bg-light">
                                        <tr>
                                          <th width="200px">
                                            Investment Plan
                                          </th>
                                          <th width="180px">Overall</th>
                                          <th width="180px" *ngFor="let m of monthList_x">
                                            {{ m.columnname }}
                                          </th>
                                        </tr>
                                      </thead>
                                      <tbody>
                                        <tr formArrayName="monthForm_list" *ngFor="
                                            let cd of monthForm5_.controls;
                                            let j = index
                                          ">
                                          <td [formGroupName]="j">
                                            <select class="form-control" formControlName="currencyTitle"
                                              disabled="flagFirst_row">
                                              <option *ngFor="
                                                  let t of typeTransaction_month
                                                " [value]="t.code">{{ t.chooes }}
                                              </option>
                                            </select>
                                            <label class="mt-3" for="finishDate" *ngIf="j != 0">
                                              FX
                                            </label>
                                            <input formControlName="fx" class="form-control" type="text" *ngIf="j != 0"
                                              readonly="true" />
                                          </td>
                                          <td [formGroupName]="j">
                                            <input class="form-control" type="text" formControlName="overall"
                                              mask="separator.2" thousandSeparator="," [readonly]="true" />
                                          </td>
                                          <ng-container *ngIf="i != diffYear">
                                            <td [formGroupName]="j" *ngFor="
                                              let column of monthList_x;
                                              let jj = index
                                            ">
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == true
                                              " class="form-control ; border-danger" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table6(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                mask="separator.0" thousandSeparator="," />
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == false
                                              " class="form-control" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table6(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                mask="separator.0" thousandSeparator="," />
                                            </td>
                                          </ng-container>
                                          <ng-container *ngIf="i == diffYear">
                                            <td [formGroupName]="j" *ngFor="
                                              let column of monthList_last;
                                              let jj = index
                                            ">
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == true
                                              " class="form-control ; border-danger" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table6(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                mask="separator.0" thousandSeparator="," />
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == false
                                              " class="form-control" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table6(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                mask="separator.0" thousandSeparator="," />
                                            </td>
                                          </ng-container>
                                        </tr>
                                      </tbody>
                                      <tfoot>
                                        <tr>
                                          <td>
                                            <label for="finishDate">
                                              Total Baht
                                            </label>
                                          </td>
                                          <td>
                                            <input class="form-control" type="text" [readonly]="true" mask="separator.2"
                                              thousandSeparator="," formControlName="monthTotal_overall" />
                                          </td>
                                          <td *ngFor="
                                              let column of monthList_1;
                                              let j = index
                                            ">
                                            <input class="form-control" type="text" [readonly]="true" mask="separator.2"
                                              thousandSeparator="," formControlName="monthTotal{{
                                                j + 1
                                              }}" />
                                          </td>
                                        </tr>
                                      </tfoot>
                                    </table>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </form>

                  <form *ngIf="i == 6" [formGroup]="monthForm6">
                    <div class="row mt-5">
                      <div class="col-md-11">
                        <h4>Monthly Investment Plan ({{ ym }})</h4>
                        <hr />
                      </div>
                      <div class="col-md-1">
                        <button class="btn btn-info" data-toggle="collapse" data-target="#M7">
                          +
                        </button>
                      </div>
                    </div>

                    <div class="container collapse" id="M7">
                      <div class="row">
                        <div class="col-md-12">
                          <div class="card text card-initiative">
                            <div class="form-initiative">
                              <div class="form-row align-items-center">
                                <div class="w-100">
                                  <div class="table-responsive">
                                    <table class="table table-bordered">
                                      <thead class="text-center bg-light">
                                        <tr>
                                          <th width="200px">
                                            Investment Plan
                                          </th>
                                          <th width="180px">Overall</th>
                                          <th width="180px" *ngFor="let m of monthList_x">
                                            {{ m.columnname }}
                                          </th>
                                        </tr>
                                      </thead>
                                      <tbody>
                                        <tr formArrayName="monthForm_list" *ngFor="
                                            let cd of monthForm6_.controls;
                                            let j = index
                                          ">
                                          <td [formGroupName]="j">
                                            <select class="form-control" formControlName="currencyTitle"
                                              disabled="flagFirst_row">
                                              <option *ngFor="
                                                  let t of typeTransaction_month
                                                " [value]="t.code">{{ t.chooes }}
                                              </option>
                                            </select>
                                            <label class="mt-3" for="finishDate" *ngIf="j != 0">
                                              FX
                                            </label>
                                            <input formControlName="fx" class="form-control" type="text" *ngIf="j != 0"
                                              readonly="true" />
                                          </td>
                                          <td [formGroupName]="j">
                                            <input class="form-control" type="text" formControlName="overall"
                                              mask="separator.2" thousandSeparator="," [readonly]="true" />
                                          </td>
                                          <ng-container *ngIf="i != diffYear">
                                            <td [formGroupName]="j" *ngFor="
                                              let column of monthList_x;
                                              let jj = index
                                            ">
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == true
                                              " class="form-control ; border-danger" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table7(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                mask="separator.0" thousandSeparator="," />
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == false
                                              " class="form-control" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table7(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                mask="separator.0" thousandSeparator="," />
                                            </td>
                                          </ng-container>
                                          <ng-container *ngIf="i == diffYear">
                                            <td [formGroupName]="j" *ngFor="
                                              let column of monthList_last;
                                              let jj = index
                                            ">
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == true
                                              " class="form-control ; border-danger" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table7(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                mask="separator.0" thousandSeparator="," />
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == false
                                              " class="form-control" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table7(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                mask="separator.0" thousandSeparator="," />
                                            </td>
                                          </ng-container>
                                        </tr>
                                      </tbody>
                                      <tfoot>
                                        <tr>
                                          <td>
                                            <label for="finishDate">
                                              Total Baht
                                            </label>
                                          </td>
                                          <td>
                                            <input class="form-control" type="text" [readonly]="true" mask="separator.2"
                                              thousandSeparator="," formControlName="monthTotal_overall" />
                                          </td>
                                          <td *ngFor="
                                              let column of monthList_1;
                                              let j = index
                                            ">
                                            <input class="form-control" type="text" [readonly]="true" mask="separator.2"
                                              thousandSeparator="," formControlName="monthTotal{{
                                                j + 1
                                              }}" />
                                          </td>
                                        </tr>
                                      </tfoot>
                                    </table>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </form>

                  <form *ngIf="i == 7" [formGroup]="monthForm7">
                    <div class="row mt-5">
                      <div class="col-md-11">
                        <h4>Monthly Investment Plan ({{ ym }})</h4>
                        <hr />
                      </div>
                      <div class="col-md-1">
                        <button class="btn btn-info" data-toggle="collapse" data-target="#M8">
                          +
                        </button>
                      </div>
                    </div>

                    <div class="container collapse" id="M8">
                      <div class="row">
                        <div class="col-md-12">
                          <div class="card text card-initiative">
                            <div class="form-initiative">
                              <div class="form-row align-items-center">
                                <div class="w-100">
                                  <div class="table-responsive">
                                    <table class="table table-bordered">
                                      <thead class="text-center bg-light">
                                        <tr>
                                          <th width="200px">
                                            Investment Plan
                                          </th>
                                          <th width="180px">Overall</th>
                                          <th width="180px" *ngFor="let m of monthList_x">
                                            {{ m.columnname }}
                                          </th>
                                        </tr>
                                      </thead>
                                      <tbody>
                                        <tr formArrayName="monthForm_list" *ngFor="
                                            let cd of monthForm7_.controls;
                                            let j = index
                                          ">
                                          <td [formGroupName]="j">
                                            <select class="form-control" formControlName="currencyTitle"
                                              disabled="flagFirst_row">
                                              <option *ngFor="
                                                  let t of typeTransaction_month
                                                " [value]="t.code">{{ t.chooes }}
                                              </option>
                                            </select>
                                            <label class="mt-3" for="finishDate" *ngIf="j != 0">
                                              FX
                                            </label>
                                            <input formControlName="fx" class="form-control" type="text" *ngIf="j != 0"
                                              readonly="true" />
                                          </td>
                                          <td [formGroupName]="j">
                                            <input class="form-control" type="text" formControlName="overall"
                                              mask="separator.2" thousandSeparator="," [readonly]="true" />
                                          </td>
                                          <ng-container *ngIf="i != diffYear">
                                            <td [formGroupName]="j" *ngFor="
                                              let column of monthList_x;
                                              let jj = index
                                            ">
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == true
                                              " class="form-control ; border-danger" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table8(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                mask="separator.0" thousandSeparator="," />
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == false
                                              " class="form-control" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table8(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                mask="separator.0" thousandSeparator="," />
                                            </td>
                                          </ng-container>
                                          <ng-container *ngIf="i == diffYear">
                                            <td [formGroupName]="j" *ngFor="
                                              let column of monthList_last;
                                              let jj = index
                                            ">
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == true
                                              " class="form-control ; border-danger" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table8(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                mask="separator.0" thousandSeparator="," />
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == false
                                              " class="form-control" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table8(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                mask="separator.0" thousandSeparator="," />
                                            </td>
                                          </ng-container>
                                        </tr>
                                      </tbody>
                                      <tfoot>
                                        <tr>
                                          <td>
                                            <label for="finishDate">
                                              Total Baht
                                            </label>
                                          </td>
                                          <td>
                                            <input class="form-control" type="text" [readonly]="true" mask="separator.2"
                                              thousandSeparator="," formControlName="monthTotal_overall" />
                                          </td>
                                          <td *ngFor="
                                              let column of monthList_1;
                                              let j = index
                                            ">
                                            <input class="form-control" type="text" [readonly]="true" mask="separator.2"
                                              thousandSeparator="," formControlName="monthTotal{{
                                                j + 1
                                              }}" />
                                          </td>
                                        </tr>
                                      </tfoot>
                                    </table>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </form>

                  <form *ngIf="i == 8" [formGroup]="monthForm8">
                    <div class="row mt-5">
                      <div class="col-md-11">
                        <h4>Monthly Investment Plan ({{ ym }})</h4>
                        <hr />
                      </div>
                      <div class="col-md-1">
                        <button class="btn btn-info" data-toggle="collapse" data-target="#M9">
                          +
                        </button>
                      </div>
                    </div>

                    <div class="container collapse" id="M9">
                      <div class="row">
                        <div class="col-md-12">
                          <div class="card text card-initiative">
                            <div class="form-initiative">
                              <div class="form-row align-items-center">
                                <div class="w-100">
                                  <div class="table-responsive">
                                    <table class="table table-bordered">
                                      <thead class="text-center bg-light">
                                        <tr>
                                          <th width="200px">
                                            Investment Plan
                                          </th>
                                          <th width="180px">Overall</th>
                                          <th width="180px" *ngFor="let m of monthList_x">
                                            {{ m.columnname }}
                                          </th>
                                        </tr>
                                      </thead>
                                      <tbody>
                                        <tr formArrayName="monthForm_list" *ngFor="
                                            let cd of monthForm8_.controls;
                                            let j = index
                                          ">
                                          <td [formGroupName]="j">
                                            <select class="form-control" formControlName="currencyTitle"
                                              disabled="flagFirst_row">
                                              <option *ngFor="
                                                  let t of typeTransaction_month
                                                " [value]="t.code">{{ t.chooes }}
                                              </option>
                                            </select>
                                            <label class="mt-3" for="finishDate" *ngIf="j != 0">
                                              FX
                                            </label>
                                            <input formControlName="fx" class="form-control" type="text" *ngIf="j != 0"
                                              readonly="true" />
                                          </td>
                                          <td [formGroupName]="j">
                                            <input class="form-control" type="text" formControlName="overall"
                                              mask="separator.2" thousandSeparator="," [readonly]="true" />
                                          </td>
                                          <ng-container *ngIf="i != diffYear">
                                            <td [formGroupName]="j" *ngFor="
                                              let column of monthList_x;
                                              let jj = index
                                            ">
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == true
                                              " class="form-control ; border-danger" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table9(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                mask="separator.0" thousandSeparator="," />
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == false
                                              " class="form-control" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table9(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                mask="separator.0" thousandSeparator="," />
                                            </td>
                                          </ng-container>
                                          <ng-container *ngIf="i == diffYear">
                                            <td [formGroupName]="j" *ngFor="
                                              let column of monthList_last;
                                              let jj = index
                                            ">
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == true
                                              " class="form-control ; border-danger" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table9(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                mask="separator.0" thousandSeparator="," />
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == false
                                              " class="form-control" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table9(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                mask="separator.0" thousandSeparator="," />
                                            </td>
                                          </ng-container>
                                        </tr>
                                      </tbody>
                                      <tfoot>
                                        <tr>
                                          <td>
                                            <label for="finishDate">
                                              Total Baht
                                            </label>
                                          </td>
                                          <td *ngFor="
                                              let column of monthList_1;
                                              let j = index
                                            ">
                                            <input class="form-control" type="text" [readonly]="true" mask="separator.2"
                                              thousandSeparator="," formControlName="monthTotal{{
                                                j + 1
                                              }}" />
                                          </td>
                                          <td>
                                            <input class="form-control" type="text" [readonly]="true" mask="separator.2"
                                              thousandSeparator="," formControlName="monthTotal_overall" />
                                          </td>
                                        </tr>
                                      </tfoot>
                                    </table>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </form>

                  <form *ngIf="i == 9" [formGroup]="monthForm9">
                    <div class="row mt-5">
                      <div class="col-md-11">
                        <h4>Monthly Investment Plan ({{ ym }})</h4>
                        <hr />
                      </div>
                      <div class="col-md-1">
                        <button class="btn btn-info" data-toggle="collapse" data-target="#M10">
                          +
                        </button>
                      </div>
                    </div>

                    <div class="container collapse" id="M10">
                      <div class="row">
                        <div class="col-md-12">
                          <div class="card text card-initiative">
                            <div class="form-initiative">
                              <div class="form-row align-items-center">
                                <div class="w-100">
                                  <div class="table-responsive">
                                    <table class="table table-bordered">
                                      <thead class="text-center bg-light">
                                        <tr>
                                          <th width="200px">
                                            Investment Plan
                                          </th>
                                          <th width="180px">Overall</th>
                                          <th width="180px" *ngFor="let m of monthList_x">
                                            {{ m.columnname }}
                                          </th>
                                        </tr>
                                      </thead>
                                      <tbody>
                                        <tr formArrayName="monthForm_list" *ngFor="
                                            let cd of monthForm9_.controls;
                                            let j = index
                                          ">
                                          <td [formGroupName]="j">
                                            <select class="form-control" formControlName="currencyTitle"
                                              disabled="flagFirst_row">
                                              <option *ngFor="
                                                  let t of typeTransaction_month
                                                " [value]="t.code">{{ t.chooes }}
                                              </option>
                                            </select>
                                            <label class="mt-3" for="finishDate" *ngIf="j != 0">
                                              FX
                                            </label>
                                            <input formControlName="fx" class="form-control" type="text" *ngIf="j != 0"
                                              readonly="true" />
                                          </td>

                                          <td [formGroupName]="j">
                                            <input class="form-control" type="text" formControlName="overall"
                                              mask="separator.2" thousandSeparator="," [readonly]="true" />
                                          </td>
                                          <ng-container *ngIf="i != diffYear">
                                            <td [formGroupName]="j" *ngFor="
                                              let column of monthList_x;
                                              let jj = index
                                            ">
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == true
                                              " class="form-control ; border-danger" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table10(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                mask="separator.0" thousandSeparator="," />
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == false
                                              " class="form-control" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table10(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                mask="separator.0" thousandSeparator="," />
                                            </td>
                                          </ng-container>
                                          <ng-container *ngIf="i == diffYear">
                                            <td [formGroupName]="j" *ngFor="
                                              let column of monthList_last;
                                              let jj = index
                                            ">
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == true
                                              " class="form-control ; border-danger" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table10(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="test" pattern="[0-9]*"
                                                mask="separator.0" thousandSeparator="," />
                                              <input *ngIf="
                                                cd.get('flag_alert')
                                                  .value == false
                                              " class="form-control" formControlName="m{{
                                                jj + 1
                                              }}" [readonly]="column.readOnly" (change)="
                                                ChangingValue_month_table10(
                                                  ym
                                                )
                                              " (keypress)="keyPress($event)" type="text" pattern="[0-9]*"
                                                mask="separator.0" thousandSeparator="," />
                                            </td>
                                          </ng-container>
                                        </tr>
                                      </tbody>
                                      <tfoot>
                                        <tr>
                                          <td>
                                            <label for="finishDate">
                                              Total Baht
                                            </label>
                                          </td>
                                          <td>
                                            <input class="form-control" type="text" [readonly]="true" mask="separator.2"
                                              thousandSeparator="," formControlName="monthTotal_overall" />
                                          </td>
                                          <td *ngFor="
                                              let column of monthList_1;
                                              let j = index
                                            ">
                                            <input class="form-control" type="text" [readonly]="true" mask="separator.2"
                                              thousandSeparator="," formControlName="monthTotal{{
                                                j + 1
                                              }}" />
                                          </td>
                                        </tr>
                                      </tfoot>
                                    </table>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </form>
                </div>
              </div>

              <!-- End Table -->
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<ng-template [ngIf]="PoolView" [ngIfElse]="ButtonSubmit">
  <br />
  <hr />
  <app-initiative-file [id]="id"></app-initiative-file>
</ng-template>

<ng-template #ButtonSubmit>
  <br />
  <hr />
  <div class="row">
    <div class="col-md-12 mt-3">
      <button type="button" class="btn btn-success btn-width" (click)="Submit()">
        <i class="far fa-check-circle mr-2"></i> Submit
      </button>
      <button type="button" class="btn btn-warning btn-width ml-2" (click)="Draft()">
        <i class="far fa-save mr-2"></i> Save Draft
      </button>
      <button type="button" class="btn btn-danger btn-width ml-2" [routerLink]="['/initiative/my-own']">
        <i class="fas fa-ban mr-2"></i> Cancel
      </button>
      <button type="button" class="btn btn-info btn-width ml-2">
        <i class="far fa-copy mr-2"></i> Duplicate
      </button>
      <button type="button" class="btn btn-secondary btn-width ml-2">
        <i class="fas fa-print mr-2"></i> Print
      </button>
      <button type="button" class="btn btn-primary btn-width ml-2" (click)="ShowAttachment()">
        <i class="fas fa-upload mr-2"></i> Attachment
      </button>
    </div>
  </div>
</ng-template>